[
  {
    "objectID": "autocor_exo.html",
    "href": "autocor_exo.html",
    "title": "Autocorrelation spatiale",
    "section": "",
    "text": "Mise en place : Télécharger le dossier exo_autocor.zip et décompressez le sur votre ordinateur. Puis créez un projet R avant d’executer le programme\nVous allez choisir une des listes électorales puis reprendre l’ensemble des analyses vues en cours à l’aide des programmes ci-dessous. Les choix possibles sont :\n“Aubry” “Bardella” “Bellamy” “Deffontaines” “Glucksman” “Hayer” “Lassale” “Marechal” “Toussaint” “Autres”\nvarY &lt;- \"Bardella\"\nnameY&lt;-paste(\"% vote\", varY)"
  },
  {
    "objectID": "autocor_exo.html#préparation-des-données",
    "href": "autocor_exo.html#préparation-des-données",
    "title": "Autocorrelation spatiale",
    "section": "Préparation des données",
    "text": "Préparation des données\n\n### Fonds de carte\nmap&lt;-st_read(\"data/elect2024/map_reg.shp\", quiet=T) %&gt;%\n      select(code=code_reg,  geometry) %&gt;%\n      st_transform(2154)\n\n### Données\ndon&lt;-readRDS(\"data/elect2024/don_reg.RDS\") %&gt;%\n          select(code=code_reg, nom=nom_reg, 3:12)\ndon$nom&lt;-as.factor(don$nom) \nlevels(don$nom)&lt;-c(\"ACAL\", \"AQUI\",\"AURA\",\"BOFC\",\"BRET\",\"CVDL\",\"IDF\",\"OCCI\",\"NOPI\",\"NORM\",\"PDL\",\"PACA\")\n\n### Jointure\nmapdon&lt;-left_join(map[,1],don)\n\n# Table de voisinage\nmap_nb&lt;-spdep::poly2nb(mapdon,row.names = mapdon$code)\n\n# Table de poids\nmap_nb_w&lt;-nb2listw(map_nb)\nsummary(map_nb_w)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 12 \nNumber of nonzero links: 46 \nPercentage nonzero weights: 31.94444 \nAverage number of links: 3.833333 \nLink number distribution:\n\n2 3 4 5 6 \n2 3 3 3 1 \n2 least connected regions:\n53 93 with 2 links\n1 most connected region:\n24 with 6 links\n\nWeights style: W \nWeights constants summary:\n   n  nn S0       S1       S2\nW 12 144 12 6.643889 49.32222\n\n# Carte de voisinage\ncoo&lt;-st_coordinates(st_centroid(mapdon))\nmf_map(mapdon, type=\"base\",col=\"lightyellow\")\nmf_layout(\"Carte des liens de voisinage\", frame=T)\nplot.nb(map_nb,coords = coo,add = T,col = \"red\",points = F)\nmf_label(mapdon, var=\"code\", col=\"blue\",cex=0.6,halo = T, bg=\"white\",r = 0.1)"
  },
  {
    "objectID": "autocor_exo.html#choix-dune-variable-y",
    "href": "autocor_exo.html#choix-dune-variable-y",
    "title": "Autocorrelation spatiale",
    "section": "Choix d’une variable Y",
    "text": "Choix d’une variable Y\n\nsel&lt;-mapdon %&gt;% select(code,nom, Y=varY) %&gt;%\n                mutate(Y_std = as.numeric(scale(Y)) ) \n\n\npar(mfrow=c(1,2))\n# Carte de Y\nmf_map(sel, var=\"Y\", type=\"choro\",\n       nbreaks = 6,\n       leg_title = \"Quantiles\",\n       leg_val_rnd = 1)\nmf_layout(\"Y\",\n          frame=T,\n          credits=\"\",\n          arrow=F)\n\n# Carte de Ystd\nmypal&lt;- brewer.pal(6, \"RdYlBu\")\nmybreaks&lt;-c(-10,-2,-1,0,1,2,10)\nmf_map(sel, var=\"Y_std\", type=\"choro\",\n       breaks=mybreaks, \n       pal = mypal,\n       leg_title = \"moy. & ec.type\",\n       leg_val_rnd = 1\n       )\nmf_layout(\"Y_std\",\n          frame=T,\n          credits=\"\",\n          arrow=F)"
  },
  {
    "objectID": "autocor_exo.html#valeurs-de-voisinage",
    "href": "autocor_exo.html#valeurs-de-voisinage",
    "title": "Autocorrelation spatiale",
    "section": "Valeurs de voisinage",
    "text": "Valeurs de voisinage\n\nsel$Y_lag&lt;-as.numeric(lag.listw(map_nb_w,sel$Y))\nsel$Y_std_lag&lt;-as.numeric(lag.listw(map_nb_w,sel$Y_std))\n#mapsel$Y_std_lag&lt;-lag.listw(map_nb_w,mapsel$Y_std)\nst_drop_geometry(sel)\n\n   code  nom        Y      Y_std    Y_lag   Y_std_lag\n1    11  IDF 18.78888 -2.1535547 37.61953  0.72909500\n2    24 CVDL 34.93906  0.3187601 30.11507 -0.41970883\n3    27 BOFC 37.08970  0.6479876 30.74364 -0.32348574\n4    28 NORM 35.32945  0.3785223 29.86869 -0.45742619\n5    32 NOPI 42.40672  1.4619321 30.81702 -0.31225318\n6    44 ACAL 38.33273  0.8382729 32.76177 -0.01454500\n7    52  PDL 27.62945 -0.8002157 31.69672 -0.17758538\n8    53 BRET 25.57934 -1.1140528 31.47945 -0.21084671\n9    75 AQUI 30.93906 -0.2935711 31.79258 -0.16291148\n10   76 OCCI 33.68791  0.1272309 33.49939  0.09837241\n11   84 AURA 30.91391 -0.2974213 35.06019  0.33730344\n12   93 PACA 38.64522  0.8861097 32.30091 -0.08509518"
  },
  {
    "objectID": "autocor_exo.html#indice-et-diagramme-de-moran",
    "href": "autocor_exo.html#indice-et-diagramme-de-moran",
    "title": "Autocorrelation spatiale",
    "section": "Indice et diagramme de Moran",
    "text": "Indice et diagramme de Moran\n\nspdep::moran.test(sel$Y,map_nb_w, alternative = \"two.sided\")\n\n\n    Moran I test under randomisation\n\ndata:  sel$Y  \nweights: map_nb_w    \n\nMoran I statistic standard deviate = -0.69097, p-value = 0.4896\nalternative hypothesis: two.sided\nsample estimates:\nMoran I statistic       Expectation          Variance \n      -0.20852369       -0.09090909        0.02897351 \n\n\n\npar(mfrow=c(1,1))\nmoran.plot(x=sel$Y_std,\n           listw=map_nb_w, \n           pch=20,\n           main =\"Diagramme de Moran\",\n           xlab = \"Variable observée (Y)\", \n           ylab=  \"Variable de voisinage (Ylag)\",labels = F)\ntext(sel$Y_std, \n     sel$Y_std_lag, \n     sel$nom, \n     cex=0.5, \n     col=\"red\",\n     pos=1)"
  },
  {
    "objectID": "autocor_exo.html#calcul-des-lisa",
    "href": "autocor_exo.html#calcul-des-lisa",
    "title": "Autocorrelation spatiale",
    "section": "Calcul des LISA",
    "text": "Calcul des LISA\n\nlocm&lt;-localmoran(sel$Y,map_nb_w,alternative = \"two.sided\")\nsel2&lt;-as.data.frame(locm)\ntabres&lt;-cbind(sel,sel2)\nst_drop_geometry(tabres)\n\n   code  nom        Y      Y_std    Y_lag   Y_std_lag          Ii         E.Ii\n1    11  IDF 18.78888 -2.1535547 37.61953  0.72909500 -1.71288650 -0.459946894\n2    24 CVDL 34.93906  0.3187601 30.11507 -0.41970883 -0.14594885 -0.010076829\n3    27 BOFC 37.08970  0.6479876 30.74364 -0.32348574 -0.22867063 -0.041641779\n4    28 NORM 35.32945  0.3785223 29.86869 -0.45742619 -0.18888653 -0.014209497\n5    32 NOPI 42.40672  1.4619321 30.81702 -0.31225318 -0.49799230 -0.211958224\n6    44 ACAL 38.33273  0.8382729 32.76177 -0.01454500 -0.01330111 -0.069689401\n7    52  PDL 27.62945 -0.8002157 31.69672 -0.17758538  0.15502539 -0.063505302\n8    53 BRET 25.57934 -1.1140528 31.47945 -0.21084671  0.25624840 -0.123085644\n9    75 AQUI 30.93906 -0.2935711 31.79258 -0.16291148  0.05217394 -0.008547175\n10   76 OCCI 33.68791  0.1272309 33.49939  0.09837241  0.01365383 -0.001605393\n11   84 AURA 30.91391 -0.2974213 35.06019  0.33730344 -0.10944134 -0.008772835\n12   93 PACA 38.64522  0.8861097 32.30091 -0.08509518 -0.08225854 -0.077870117\n        Var.Ii        Z.Ii Pr.z....E.Ii..\n1  0.357689878 -2.09496520     0.03617409\n2  0.009975286 -1.36040224     0.17370267\n3  0.083806257 -0.64605635     0.51824287\n4  0.020170926 -1.22990878     0.21873126\n5  0.534502193 -0.39123980     0.69561999\n6  0.207464924  0.12379885     0.90147454\n7  0.124891996  0.61836534     0.53633454\n8  0.582852069  0.49686985     0.61928083\n9  0.017795654  0.45517954     0.64898008\n10 0.005129009  0.21306678     0.83127487\n11 0.012522057 -0.89961308     0.36832619\n12 0.387754354 -0.00704742     0.99437702"
  },
  {
    "objectID": "autocor_exo.html#carte-des-lisa",
    "href": "autocor_exo.html#carte-des-lisa",
    "title": "Autocorrelation spatiale",
    "section": "Carte des LISA",
    "text": "Carte des LISA\n\npar(mfrow=c(1,2))\n\n# Carte de Ystd\nmypal&lt;- brewer.pal(6, \"RdYlBu\")\nmybreaks&lt;-c(-10,-2,-1,0,1,2,10)\nmf_map(sel, var=\"Y_std\", type=\"choro\",\n       breaks=mybreaks, \n       pal = mypal,\n       leg_title = \"moy. & ec.type\",\n       leg_val_rnd = 1\n       )\nmf_layout(\"Variable standardisée\",\n          frame=T,\n          credits=\"\",\n          arrow=F)\n\n\nmypal&lt;-brewer.pal(5,\"BrBG\")\nmybreaks&lt;-c(-10,-2,-1,1,2,10)\nmf_map(tabres, var=\"Z.Ii\", type=\"choro\",\n       breaks=mybreaks, \n       pal = mypal,\n       leg_title = \"Z-score\",\n       leg_val_rnd = 1\n       )\nmf_layout(\"LISA\",\n          frame=T,\n          credits=\"\",\n          arrow=F)"
  },
  {
    "objectID": "autocor_exo.html#typologie-de-moran",
    "href": "autocor_exo.html#typologie-de-moran",
    "title": "Autocorrelation spatiale",
    "section": "Typologie de Moran",
    "text": "Typologie de Moran\n\n# create a new variable identifying the moran plot quadrant for each observation, dismissing the non-significant ones\ntabres$typ &lt;- NA\n\n# high-high quadrant\ntabres[(tabres$Y_std &gt;= 0 & \n                 tabres$Y_std_lag &gt;= 0) & \n                tabres$Pr.z....E.Ii..&lt;0.05, \"typ\"] &lt;- \"high-high\"\n# low-low quadrant\ntabres[(tabres$Y_std &lt;= 0 & \n                 tabres$Y_std_lag &lt;= 0) & \n                tabres$Pr.z....E.Ii..&lt;0.05, \"typ\"] &lt;- \"low-low\"\n# high-low quadrant\ntabres[(tabres$Y_std &gt;= 0 & \n                 tabres$Y_std_lag &lt;= 0) & \n                tabres$Pr.z....E.Ii..&lt;0.05, \"typ\"] &lt;- \"high-low\"\n# low-high quadrant\ntabres[(tabres$Y_std &lt;= 0 & \n                 tabres$Y_std_lag &gt;= 0) & \n                tabres$Pr.z....E.Ii..&lt;0.05, \"typ\"] &lt;- \"low-high\"\n# non-significant observations\ntabres[tabres$Pr.z....E.Ii.. &gt; 0.05, \"typ\"] &lt;- \"not signif.\"  \n\ntabres$typ &lt;- as.factor(tabres$typ)\ntabres$typcol&lt;-NA\ntabres$typcol &lt;- case_when(tabres$typ==\"high-high\" ~ \"red\",\n                        tabres$typ==\"low-low\" ~ \"blue\",\n                        tabres$typ==\"high-low\" ~ \"pink\",\n                        tabres$typ==\"low-high\" ~ \"lightblue\",\n                        tabres$typ==\"not signif.\" ~ \"gray90\"                      \n                        )\n\nmf_map(tabres, type=\"base\",  col=tabres$typcol)\nmf_layout(\"Typologie de Moran\", \n          frame=T,\n          credits =\"\")\nmf_legend(type=\"typo\",val = c(\"haut-haut\",\"bas-bas\",\"haut-bas\",\"bas-haut\",\"non sign.\"),pal = c(\"red\",\"blue\",\"pink\",\"lightblue\",\"gray90\"),title = \"Types\")"
  },
  {
    "objectID": "autocor_exo.html#préparation-des-données-1",
    "href": "autocor_exo.html#préparation-des-données-1",
    "title": "Autocorrelation spatiale",
    "section": "Préparation des données",
    "text": "Préparation des données\n\n### Fonds de carte\nmap&lt;-st_read(\"data/elect2024/map_dept.shp\", quiet=T) %&gt;%\n      select(code=code_dpt,  geometry) %&gt;%\n      st_transform(2154)\n\n### Données\ndon&lt;-readRDS(\"data/elect2024/don_dept.RDS\") %&gt;%\n          select(code=code_dpt, nom=nom_dpt, 5:14)\n\n\n### Jointure\nmapdon&lt;-left_join(map[,1],don)\n\n# Table de voisinage\nmap_nb&lt;-spdep::poly2nb(mapdon,row.names = mapdon$code)\n\n# Table de poids\nmap_nb_w&lt;-nb2listw(map_nb)\nsummary(map_nb_w)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 94 \nNumber of nonzero links: 474 \nPercentage nonzero weights: 5.364418 \nAverage number of links: 5.042553 \nLink number distribution:\n\n 2  3  4  5  6  7  8 10 \n 6 12 14 19 30 11  1  1 \n6 least connected regions:\n06 29 57 62 66 74 with 2 links\n1 most connected region:\n77 with 10 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 94 8836 94 40.29206 383.9874\n\n# Carte de voisinage\ncoo&lt;-st_coordinates(st_centroid(mapdon))\nmf_map(mapdon, type=\"base\",col=\"lightyellow\")\nmf_layout(\"Carte des liens de voisinage\", frame=T)\nplot.nb(map_nb,coords = coo,add = T,col = \"red\",points = F)\nmf_label(mapdon, var=\"code\", col=\"blue\",cex=0.6,halo = T, bg=\"white\",r = 0.1)"
  },
  {
    "objectID": "autocor_exo.html#choix-dune-variable-y-1",
    "href": "autocor_exo.html#choix-dune-variable-y-1",
    "title": "Autocorrelation spatiale",
    "section": "Choix d’une variable Y",
    "text": "Choix d’une variable Y\n\nsel&lt;-mapdon %&gt;% select(code,nom, Y=varY) %&gt;%\n                mutate(Y_std = as.numeric(scale(Y)) ) \n\n\npar(mfrow=c(1,2))\n# Carte de Y\nmf_map(sel, var=\"Y\", type=\"choro\",\n       nbreaks = 6,\n       leg_title = \"Quantiles\",\n       leg_val_rnd = 1)\nmf_layout(\"Y\",\n          frame=T,\n          credits=\"\",\n          arrow=F)\n\n# Carte de Ystd\nmypal&lt;- brewer.pal(6, \"RdYlBu\")\nmybreaks&lt;-c(-10,-2,-1,0,1,2,10)\nmf_map(sel, var=\"Y_std\", type=\"choro\",\n       breaks=mybreaks, \n       pal = mypal,\n       leg_title = \"moy. & ec.type\",\n       leg_val_rnd = 1\n       )\nmf_layout(\"Y_std\",\n          frame=T,\n          credits=\"\",\n          arrow=F)"
  },
  {
    "objectID": "autocor_exo.html#valeurs-de-voisinage-1",
    "href": "autocor_exo.html#valeurs-de-voisinage-1",
    "title": "Autocorrelation spatiale",
    "section": "Valeurs de voisinage",
    "text": "Valeurs de voisinage\n\nsel$Y_lag&lt;-as.numeric(lag.listw(map_nb_w,sel$Y))\nsel$Y_std_lag&lt;-as.numeric(lag.listw(map_nb_w,sel$Y_std))\n#mapsel$Y_std_lag&lt;-lag.listw(map_nb_w,mapsel$Y_std)\nhead(st_drop_geometry(sel))\n\n  code                     nom        Y      Y_std    Y_lag  Y_std_lag\n1   01                     AIN 36.53036  0.3548758 31.39537 -0.3338932\n2   02                   AISNE 50.63966  2.2473937 40.51463  0.8892969\n3   03                  ALLIER 36.69576  0.3770614 35.98661  0.2819411\n4   04 ALPES-DE-HAUTE-PROVENCE 36.30369  0.3244723 37.09966  0.4312381\n5   05            HAUTES-ALPES 31.05594 -0.3794221 33.09124 -0.1064220\n6   06         ALPES-MARITIMES 37.73249  0.5161209 39.76664  0.7889666"
  },
  {
    "objectID": "autocor_exo.html#indice-et-diagramme-de-moran-1",
    "href": "autocor_exo.html#indice-et-diagramme-de-moran-1",
    "title": "Autocorrelation spatiale",
    "section": "Indice et diagramme de Moran",
    "text": "Indice et diagramme de Moran\n\nspdep::moran.test(sel$Y,map_nb_w, alternative = \"two.sided\")\n\n\n    Moran I test under randomisation\n\ndata:  sel$Y  \nweights: map_nb_w    \n\nMoran I statistic standard deviate = 8.8275, p-value &lt; 2.2e-16\nalternative hypothesis: two.sided\nsample estimates:\nMoran I statistic       Expectation          Variance \n       0.56608333       -0.01075269        0.00427000 \n\n\n\npar(mfrow=c(1,1))\nmoran.plot(x=sel$Y_std,\n           listw=map_nb_w, \n           pch=20,\n           main =\"Diagramme de Moran\",\n           xlab = \"Variable observée (Y)\", \n           ylab=  \"Variable de voisinage (Ylag)\",labels = F)\ntext(sel$Y_std, \n     sel$Y_std_lag, \n     sel$nom, \n     cex=0.5, \n     col=\"red\",\n     pos=1)"
  },
  {
    "objectID": "autocor_exo.html#calcul-des-lisa-1",
    "href": "autocor_exo.html#calcul-des-lisa-1",
    "title": "Autocorrelation spatiale",
    "section": "Calcul des LISA",
    "text": "Calcul des LISA\n\nlocm&lt;-localmoran(sel$Y,map_nb_w,alternative = \"two.sided\")\nsel2&lt;-as.data.frame(locm)\ntabres&lt;-cbind(sel,sel2)\nhead(st_drop_geometry(tabres)) \n\n  code                     nom        Y      Y_std    Y_lag  Y_std_lag\n1   01                     AIN 36.53036  0.3548758 31.39537 -0.3338932\n2   02                   AISNE 50.63966  2.2473937 40.51463  0.8892969\n3   03                  ALLIER 36.69576  0.3770614 35.98661  0.2819411\n4   04 ALPES-DE-HAUTE-PROVENCE 36.30369  0.3244723 37.09966  0.4312381\n5   05            HAUTES-ALPES 31.05594 -0.3794221 33.09124 -0.1064220\n6   06         ALPES-MARITIMES 37.73249  0.5161209 39.76664  0.7889666\n           Ii         E.Ii     Var.Ii       Z.Ii Pr.z....E.Ii..\n1 -0.11976472 -0.001368720 0.02025013 -0.8319995     0.40540921\n2  2.02009056 -0.054893417 0.76861540  2.3667926     0.01794298\n3  0.10745221 -0.001545205 0.02285718  0.7209496     0.47094050\n4  0.14142937 -0.001144240 0.02055288  0.9944955     0.31998170\n5  0.04081302 -0.001564614 0.03551380  0.2248734     0.82207774\n6  0.41158068 -0.002895109 0.13420143  1.1314115     0.25788193"
  },
  {
    "objectID": "autocor_exo.html#carte-des-lisa-1",
    "href": "autocor_exo.html#carte-des-lisa-1",
    "title": "Autocorrelation spatiale",
    "section": "Carte des LISA",
    "text": "Carte des LISA\n\npar(mfrow=c(1,2))\n\n# Carte de Ystd\nmypal&lt;- brewer.pal(6, \"RdYlBu\")\nmybreaks&lt;-c(-10,-2,-1,0,1,2,10)\nmf_map(sel, var=\"Y_std\", type=\"choro\",\n       breaks=mybreaks, \n       pal = mypal,\n       leg_title = \"moy. & ec.type\",\n       leg_val_rnd = 1\n       )\nmf_layout(\"Variable standardisée\",\n          frame=T,\n          credits=\"\",\n          arrow=F)\n\n\nmypal&lt;-brewer.pal(5,\"BrBG\")\nmybreaks&lt;-c(-10,-2,-1,1,2,10)\nmf_map(tabres, var=\"Z.Ii\", type=\"choro\",\n       breaks=mybreaks, \n       pal = mypal,\n       leg_title = \"Z-score\",\n       leg_val_rnd = 1\n       )\nmf_layout(\"LISA\",\n          frame=T,\n          credits=\"\",\n          arrow=F)"
  },
  {
    "objectID": "autocor_exo.html#typologie-de-moran-1",
    "href": "autocor_exo.html#typologie-de-moran-1",
    "title": "Autocorrelation spatiale",
    "section": "Typologie de Moran",
    "text": "Typologie de Moran\n\n# create a new variable identifying the moran plot quadrant for each observation, dismissing the non-significant ones\ntabres$typ &lt;- NA\n\n# high-high quadrant\ntabres[(tabres$Y_std &gt;= 0 & \n                 tabres$Y_std_lag &gt;= 0) & \n                tabres$Pr.z....E.Ii..&lt;0.05, \"typ\"] &lt;- \"high-high\"\n# low-low quadrant\ntabres[(tabres$Y_std &lt;= 0 & \n                 tabres$Y_std_lag &lt;= 0) & \n                tabres$Pr.z....E.Ii..&lt;0.05, \"typ\"] &lt;- \"low-low\"\n# high-low quadrant\ntabres[(tabres$Y_std &gt;= 0 & \n                 tabres$Y_std_lag &lt;= 0) & \n                tabres$Pr.z....E.Ii..&lt;0.05, \"typ\"] &lt;- \"high-low\"\n# low-high quadrant\ntabres[(tabres$Y_std &lt;= 0 & \n                 tabres$Y_std_lag &gt;= 0) & \n                tabres$Pr.z....E.Ii..&lt;0.05, \"typ\"] &lt;- \"low-high\"\n# non-significant observations\ntabres[tabres$Pr.z....E.Ii.. &gt; 0.05, \"typ\"] &lt;- \"not signif.\"  \n\ntabres$typ &lt;- as.factor(tabres$typ)\ntabres$typcol&lt;-NA\ntabres$typcol &lt;- case_when(tabres$typ==\"high-high\" ~ \"red\",\n                        tabres$typ==\"low-low\" ~ \"blue\",\n                        tabres$typ==\"high-low\" ~ \"pink\",\n                        tabres$typ==\"low-high\" ~ \"lightblue\",\n                        tabres$typ==\"not signif.\" ~ \"gray90\"                      \n                        )\n\nmf_map(tabres, type=\"base\",  col=tabres$typcol)\nmf_layout(\"Typologie de Moran\", \n          frame=T,\n          credits =\"\")\nmf_legend(type=\"typo\",val = c(\"haut-haut\",\"bas-bas\",\"haut-bas\",\"bas-haut\",\"non sign.\"),pal = c(\"red\",\"blue\",\"pink\",\"lightblue\",\"gray90\"),title = \"Types\")"
  },
  {
    "objectID": "autocor_exo.html#préparation-des-données-2",
    "href": "autocor_exo.html#préparation-des-données-2",
    "title": "Autocorrelation spatiale",
    "section": "Préparation des données",
    "text": "Préparation des données\n\n### Fonds de carte\nmap&lt;-st_read(\"data/elect2024/map_circ.shp\", quiet=T) %&gt;%\n    filter(code_dpt!=75) %&gt;%\n      select(code=ID,  geometry) %&gt;%\n      st_transform(2154)\n\n### Données\ndon&lt;-readRDS(\"data/elect2024/don_circ.RDS\") %&gt;%\n          filter(code_dpt!=75) %&gt;%\n          select(code=ID, nom=ID, 10:20)\n\n\n### Jointure\nmapdon&lt;-left_join(map[,1],don)\n\n# Table de voisinage\nmap_nb&lt;-spdep::poly2nb(mapdon,row.names = mapdon$code)\n\n# Table de poids\nmap_nb_w&lt;-nb2listw(map_nb)\nsummary(map_nb_w)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 517 \nNumber of nonzero links: 2776 \nPercentage nonzero weights: 1.038576 \nAverage number of links: 5.369439 \nLink number distribution:\n\n  1   2   3   4   5   6   7   8   9  10  11 \n  3  18  64  79 116 100  73  46  11   6   1 \n3 least connected regions:\n17001 56005 59013 with 1 link\n1 most connected region:\n42004 with 11 links\n\nWeights style: W \nWeights constants summary:\n    n     nn  S0       S1       S2\nW 517 267289 517 208.7879 2132.706\n\n# Carte de voisinage\npar(mfrow=c(1,1))\ncoo&lt;-st_coordinates(st_centroid(mapdon))\nmf_map(mapdon, type=\"base\",col=\"lightyellow\")\nmf_layout(\"Carte des liens de voisinage\", frame=T)\nplot.nb(map_nb,coords = coo,add = T,col = \"red\",points = F)\n\n\n\n#mf_label(mapdon, var=\"code\", col=\"blue\",cex=0.6,halo = T, bg=\"white\",r = 0.1)"
  },
  {
    "objectID": "autocor_exo.html#choix-dune-variable-y-2",
    "href": "autocor_exo.html#choix-dune-variable-y-2",
    "title": "Autocorrelation spatiale",
    "section": "Choix d’une variable Y",
    "text": "Choix d’une variable Y\n\nsel&lt;-mapdon %&gt;% select(code,nom, Y=varY) %&gt;%\n                mutate(Y_std = as.numeric(scale(Y)) ) \n\n\npar(mfrow=c(1,2))\n# Carte de Y\nmf_map(sel, var=\"Y\", type=\"choro\",\n       nbreaks = 6,\n       lwd=0.1,\n       leg_title = \"Quantiles\",\n       leg_val_rnd = 1)\nmf_layout(\"Y\",\n          frame=T,\n          credits=\"\",\n          arrow=F)\n\n# Carte de Ystd\nmypal&lt;- brewer.pal(6, \"RdYlBu\")\nmybreaks&lt;-c(-10,-2,-1,0,1,2,10)\nmf_map(sel, var=\"Y_std\", type=\"choro\",\n       breaks=mybreaks, \n       pal = mypal,\n       lwd=0.1,\n       leg_title = \"moy. & ec.type\",\n       leg_val_rnd = 1\n       )\nmf_layout(\"Y_std\",\n          frame=T,\n          credits=\"\",\n          arrow=F)"
  },
  {
    "objectID": "autocor_exo.html#valeurs-de-voisinage-2",
    "href": "autocor_exo.html#valeurs-de-voisinage-2",
    "title": "Autocorrelation spatiale",
    "section": "Valeurs de voisinage",
    "text": "Valeurs de voisinage\n\nsel$Y_lag&lt;-as.numeric(lag.listw(map_nb_w,sel$Y))\nsel$Y_std_lag&lt;-as.numeric(lag.listw(map_nb_w,sel$Y_std))\n#mapsel$Y_std_lag&lt;-lag.listw(map_nb_w,mapsel$Y_std)\nhead(st_drop_geometry(sel)) \n\n   code   nom        Y      Y_std    Y_lag  Y_std_lag\n1 33004 33004 30.57356 -0.1781933 28.62401 -0.3751887\n2 38001 38001 15.17156 -1.7345108 24.45730 -0.7962199\n3 59010 59010 34.87720  0.2566749 25.39481 -0.7014880\n4 33007 33007 19.95650 -1.2510096 23.81798 -0.8608204\n5 01001 01001 37.79588  0.5515966 37.05787  0.4770237\n6 01002 01002 36.73677  0.4445777 33.63850  0.1315078"
  },
  {
    "objectID": "autocor_exo.html#indice-et-diagramme-de-moran-2",
    "href": "autocor_exo.html#indice-et-diagramme-de-moran-2",
    "title": "Autocorrelation spatiale",
    "section": "Indice et diagramme de Moran",
    "text": "Indice et diagramme de Moran\n\nspdep::moran.test(sel$Y,map_nb_w, alternative = \"two.sided\")\n\n\n    Moran I test under randomisation\n\ndata:  sel$Y  \nweights: map_nb_w    \n\nMoran I statistic standard deviate = 26.255, p-value &lt; 2.2e-16\nalternative hypothesis: two.sided\nsample estimates:\nMoran I statistic       Expectation          Variance \n     0.7284488328     -0.0019379845      0.0007739103 \n\n\n\npar(mfrow=c(1,1))\nmoran.plot(x=sel$Y_std,\n           listw=map_nb_w, \n           pch=20,\n           main =\"Diagramme de Moran\",\n           xlab = \"Variable observée (Y)\", \n           ylab=  \"Variable de voisinage (Ylag)\",labels = F)\ntext(sel$Y_std, \n     sel$Y_std_lag, \n     sel$nom, \n     cex=0.5, \n     col=\"red\",\n     pos=1)\ntext(-1,-0.3,\"Low-Low\",col=\"grey30\")\ntext(-1,0.3,\"Low-High\",col=\"grey30\")\ntext(1,-0.3,\"High-Low\",col=\"grey30\")\ntext(1,0.3,\"High-High\",col=\"grey30\")"
  },
  {
    "objectID": "autocor_exo.html#calcul-des-lisa-2",
    "href": "autocor_exo.html#calcul-des-lisa-2",
    "title": "Autocorrelation spatiale",
    "section": "Calcul des LISA",
    "text": "Calcul des LISA\n\nlocm&lt;-localmoran(sel$Y,map_nb_w,alternative = \"two.sided\")\nsel2&lt;-as.data.frame(locm)\ntabres&lt;-cbind(sel,sel2)\nhead(st_drop_geometry(tabres))\n\n   code   nom        Y      Y_std    Y_lag  Y_std_lag          Ii          E.Ii\n1 33004 33004 30.57356 -0.1781933 28.62401 -0.3751887  0.06698569 -0.0000616558\n2 38001 38001 15.17156 -1.7345108 24.45730 -0.7962199  1.38372844 -0.0058417792\n3 59010 59010 34.87720  0.2566749 25.39481 -0.7014880 -0.18040333 -0.0001279258\n4 33007 33007 19.95650 -1.2510096 23.81798 -0.8608204  1.07898156 -0.0030388720\n5 01001 01001 37.79588  0.5515966 37.05787  0.4770237  0.26363456 -0.0005907915\n6 01002 01002 36.73677  0.4445777 33.63850  0.1315078  0.05857873 -0.0003837836\n       Var.Ii       Z.Ii Pr.z....E.Ii..\n1 0.004500391  0.9994395     0.31758186\n2 0.996965365  1.3916835     0.16401828\n3 0.021957452 -1.2165935     0.22375891\n4 0.310831367  1.9407654     0.05228674\n5 0.060577565  1.0735409     0.28302851\n6 0.028004175  0.3523422     0.72458168"
  },
  {
    "objectID": "autocor_exo.html#carte-des-lisa-2",
    "href": "autocor_exo.html#carte-des-lisa-2",
    "title": "Autocorrelation spatiale",
    "section": "Carte des LISA",
    "text": "Carte des LISA\n\npar(mfrow=c(1,2))\n\n# Carte de Ystd\nmypal&lt;- brewer.pal(6, \"RdYlBu\")\nmybreaks&lt;-c(-10,-2,-1,0,1,2,10)\nmf_map(sel, var=\"Y_std\", type=\"choro\",\n       breaks=mybreaks, \n       pal = mypal,\n       lwd=0.1,\n       leg_title = \"moy. & ec.type\",\n       leg_val_rnd = 1\n       )\nmf_layout(\"Variable standardisée\",\n          frame=T,\n          credits=\"\",\n          arrow=F)\n\n\nmypal&lt;-brewer.pal(5,\"BrBG\")\nmybreaks&lt;-c(-10,-2,-1,1,2,10)\nmf_map(tabres, var=\"Z.Ii\", type=\"choro\",\n       breaks=mybreaks, \n       pal = mypal,\n       lwd=0.1,\n       leg_title = \"Z-score\",\n       leg_val_rnd = 1\n       )\nmf_layout(\"LISA\",\n          frame=T,\n          credits=\"\",\n          arrow=F)"
  },
  {
    "objectID": "autocor_exo.html#typologie-de-moran-2",
    "href": "autocor_exo.html#typologie-de-moran-2",
    "title": "Autocorrelation spatiale",
    "section": "Typologie de Moran",
    "text": "Typologie de Moran\n\n# create a new variable identifying the moran plot quadrant for each observation, dismissing the non-significant ones\ntabres$typ &lt;- NA\n\n# high-high quadrant\ntabres[(tabres$Y_std &gt;= 0 & \n                 tabres$Y_std_lag &gt;= 0) & \n                tabres$Pr.z....E.Ii..&lt;0.05, \"typ\"] &lt;- \"high-high\"\n# low-low quadrant\ntabres[(tabres$Y_std &lt;= 0 & \n                 tabres$Y_std_lag &lt;= 0) & \n                tabres$Pr.z....E.Ii..&lt;0.05, \"typ\"] &lt;- \"low-low\"\n# high-low quadrant\ntabres[(tabres$Y_std &gt;= 0 & \n                 tabres$Y_std_lag &lt;= 0) & \n                tabres$Pr.z....E.Ii..&lt;0.05, \"typ\"] &lt;- \"high-low\"\n# low-high quadrant\ntabres[(tabres$Y_std &lt;= 0 & \n                 tabres$Y_std_lag &gt;= 0) & \n                tabres$Pr.z....E.Ii..&lt;0.05, \"typ\"] &lt;- \"low-high\"\n# non-significant observations\ntabres[tabres$Pr.z....E.Ii.. &gt; 0.05, \"typ\"] &lt;- \"not signif.\"  \n\ntabres$typ &lt;- as.factor(tabres$typ)\ntabres$typcol&lt;-NA\ntabres$typcol &lt;- case_when(tabres$typ==\"high-high\" ~ \"red\",\n                        tabres$typ==\"low-low\" ~ \"blue\",\n                        tabres$typ==\"high-low\" ~ \"pink\",\n                        tabres$typ==\"low-high\" ~ \"lightblue\",\n                        tabres$typ==\"not signif.\" ~ \"gray90\"                      \n                        )\n\nmf_map(tabres, type=\"base\",  col=tabres$typcol)\nmf_layout(\"Typologie de Moran\", \n          frame=T,\n          credits =\"\")\nmf_legend(type=\"typo\",val = c(\"haut-haut\",\"bas-bas\",\"haut-bas\",\"bas-haut\",\"non sign.\"),pal = c(\"red\",\"blue\",\"pink\",\"lightblue\",\"gray90\"),title = \"Types\")"
  },
  {
    "objectID": "autocor.html#fonds-de-carte",
    "href": "autocor.html#fonds-de-carte",
    "title": "Autocorrélation spatiale",
    "section": "Fonds de carte",
    "text": "Fonds de carte"
  },
  {
    "objectID": "autocor.html#données",
    "href": "autocor.html#données",
    "title": "Autocorrélation spatiale",
    "section": "Données",
    "text": "Données\n\n\n\n\n\n\n  \n    \n      Tableau de données\n    \n    \n    \n      code\n      nom\n      Aubry\n      Bardella\n      Bellamy\n      Deffontaines\n      Glucksman\n      Hayer\n      Lassale\n      Marechal\n      Toussaint\n      Autres\n    \n  \n  \n    44\nACAL\n7.6\n38.3\n7.6\n1.6\n10.8\n14.4\n1.9\n5.5\n4.1\n8.2\n    75\nAQUI\n6.8\n30.9\n6.5\n2.9\n16.0\n14.8\n4.7\n5.0\n5.3\n7.2\n    84\nAURA\n9.5\n30.9\n8.0\n2.3\n13.8\n14.2\n2.1\n5.6\n6.2\n7.4\n    27\nBOFC\n7.0\n37.1\n7.5\n2.3\n12.2\n13.8\n2.9\n5.3\n4.4\n7.6\n    53\nBRET\n7.1\n25.6\n7.5\n2.6\n18.4\n17.4\n2.3\n4.2\n7.3\n7.6\n    24\nCVDL\n7.4\n34.9\n7.5\n2.6\n12.5\n15.1\n2.6\n5.4\n4.4\n7.5\n    11\nIDF\n18.6\n18.8\n8.8\n2.0\n15.8\n15.5\n0.8\n5.7\n7.0\n7.1\n    76\nOCCI\n9.0\n33.7\n5.5\n2.7\n15.5\n12.2\n3.8\n5.5\n5.1\n7.0\n    32\nNOPI\n8.4\n42.4\n6.1\n3.1\n9.0\n12.9\n2.5\n4.6\n3.6\n7.4\n    28\nNORM\n6.9\n35.3\n6.9\n2.8\n13.3\n15.7\n2.7\n4.6\n4.4\n7.3\n    52\nPDL\n7.1\n27.6\n7.9\n2.1\n16.1\n17.9\n2.1\n4.7\n7.1\n7.3\n    93\nPACA\n9.7\n38.6\n6.4\n2.1\n10.5\n12.3\n1.5\n7.7\n4.2\n6.9"
  },
  {
    "objectID": "autocor.html#identification-des-voisins",
    "href": "autocor.html#identification-des-voisins",
    "title": "Autocorrélation spatiale",
    "section": "Identification des voisins",
    "text": "Identification des voisins\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 12 \nNumber of nonzero links: 46 \nPercentage nonzero weights: 31.94444 \nAverage number of links: 3.833333 \nLink number distribution:\n\n2 3 4 5 6 \n2 3 3 3 1 \n2 least connected regions:\nBRET PACA with 2 links\n1 most connected region:\nCVDL with 6 links\n\nWeights style: W \nWeights constants summary:\n   n  nn S0       S1       S2\nW 12 144 12 6.643889 49.32222"
  },
  {
    "objectID": "autocor.html#carte-des-voisinages",
    "href": "autocor.html#carte-des-voisinages",
    "title": "Autocorrélation spatiale",
    "section": "Carte des voisinages",
    "text": "Carte des voisinages"
  },
  {
    "objectID": "autocor.html#choix-dune-variable-y",
    "href": "autocor.html#choix-dune-variable-y",
    "title": "Autocorrélation spatiale",
    "section": "Choix d’une variable Y",
    "text": "Choix d’une variable Y\nOn choisit une variable \\(Y\\) et on crée un fichier tab ne contenant que le code des régions cette variable. On crée une variable standardisée \\(Y_{std}\\)\n\n\n\n\n\n\n  \n    \n      Tableau de données\n    \n    \n    \n      code\n      nom\n      Y\n      Y_std\n    \n  \n  \n    11\nIDF\n18.8\n−2.2\n    24\nCVDL\n34.9\n0.3\n    27\nBOFC\n37.1\n0.6\n    28\nNORM\n35.3\n0.4\n    32\nNOPI\n42.4\n1.5\n    44\nACAL\n38.3\n0.8\n    52\nPDL\n27.6\n−0.8\n    53\nBRET\n25.6\n−1.1\n    75\nAQUI\n30.9\n−0.3\n    76\nOCCI\n33.7\n0.1\n    84\nAURA\n30.9\n−0.3\n    93\nPACA\n38.6\n0.9"
  },
  {
    "objectID": "autocor.html#cartographie-des-valeurs-brutes-et-standardisées",
    "href": "autocor.html#cartographie-des-valeurs-brutes-et-standardisées",
    "title": "Autocorrélation spatiale",
    "section": "Cartographie des valeurs brutes et standardisées",
    "text": "Cartographie des valeurs brutes et standardisées\nOn cartographie la carte correspondante"
  },
  {
    "objectID": "autocor.html#valeurs-de-voisinage",
    "href": "autocor.html#valeurs-de-voisinage",
    "title": "Autocorrélation spatiale",
    "section": "Valeurs de voisinage",
    "text": "Valeurs de voisinage\nPour une régon décrite par une variable \\(Y\\), la variable de voisinage \\(Y_lag\\) (Lagged variable) est la moyenne pondérée de Y dans les provinces voisines de i. Le calcul se fait donc très simplement en combinant les valeurs de Y et la matrice de voisinage pondéré que nous avons définie dans la section précédente.\n\n\n\n\n\n\n  \n    \n      Valeurs standardisées et moyenne des voisins\n    \n    \n    \n      code\n      nom\n      Y\n      Y_std\n      Y_lag\n      Y_std_lag\n    \n  \n  \n    11\nIDF\n18.8\n−2.2\n37.6\n0.7\n    24\nCVDL\n34.9\n0.3\n30.1\n−0.4\n    27\nBOFC\n37.1\n0.6\n30.7\n−0.3\n    28\nNORM\n35.3\n0.4\n29.9\n−0.5\n    32\nNOPI\n42.4\n1.5\n30.8\n−0.3\n    44\nACAL\n38.3\n0.8\n32.8\n0.0\n    52\nPDL\n27.6\n−0.8\n31.7\n−0.2\n    53\nBRET\n25.6\n−1.1\n31.5\n−0.2\n    75\nAQUI\n30.9\n−0.3\n31.8\n−0.2\n    76\nOCCI\n33.7\n0.1\n33.5\n0.1\n    84\nAURA\n30.9\n−0.3\n35.1\n0.3\n    93\nPACA\n38.6\n0.9\n32.3\n−0.1"
  },
  {
    "objectID": "autocor.html#valeurs-de-voisinage-1",
    "href": "autocor.html#valeurs-de-voisinage-1",
    "title": "Autocorrélation spatiale",
    "section": "Valeurs de voisinage",
    "text": "Valeurs de voisinage\nOn peut vérifier que le calcul est juste en prenant l’exemple de la région BRET dont nous avons vu qu’elle n’a que deux voisins, PDL et NORM. Sa valeur moyenne de voisinage est donc :\n\\(Y_{lag}(BRET) = \\frac{Y(PDL) + Y(NORM)}{2} = \\frac{27.6 + 35.3}{2} = 31.5\\)\nComme la valeur de \\(Y\\) pour la Bretagne est de 25.6 on peut dire que cette région vote moins pour Bardella que ses régions voisines."
  },
  {
    "objectID": "autocor.html#calcul-et-test-de-lindice-de-moran",
    "href": "autocor.html#calcul-et-test-de-lindice-de-moran",
    "title": "Autocorrélation spatiale",
    "section": "Calcul et test de l’indice de Moran",
    "text": "Calcul et test de l’indice de Moran\nL’indice de Moran, dans sa formulation la plus simple, n’est rien d’autre qu’une mesure de corrélation entre une variable \\(Y\\) et la variable de voisinage de voisinage \\(Y_{lag}\\) qui lui a été associée. On peut de mesurer ce coefficient à l’aide du coefficient de corrélation \\(r(Y,Y_{lag}\\) :\n\n\n\n    Pearson's product-moment correlation\n\ndata:  sel$Y and sel$Y_lag\nt = -2.4589, df = 10, p-value = 0.03374\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.87832366 -0.06166422\nsample estimates:\n       cor \n-0.6138424 \n\n\nLe coefficient d’autocorrélation spatiale de Moran serait donc ici égal à +0.61 et le test de significativité semble significatif (p &lt; 0.05)"
  },
  {
    "objectID": "autocor.html#calcul-et-test-de-lindice-de-moran-1",
    "href": "autocor.html#calcul-et-test-de-lindice-de-moran-1",
    "title": "Autocorrélation spatiale",
    "section": "Calcul et test de l’indice de Moran",
    "text": "Calcul et test de l’indice de Moran\nMais en pratique la plupart des auteurs prfèrent que le coefficient de Moran soit mesuré non pas par le coefficient de corrélation mais par le coefficient \\(a\\) de la pente de la droite de régression \\(Y_{lag} = a.Y + b\\) :\n\n\n\nCall:\nlm(formula = sel$Y_lag ~ sel$Y)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.35099 -1.72057 -0.09556  1.41752  2.37313 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  39.1643     2.8364  13.808 7.73e-08 ***\nsel$Y        -0.2085     0.0848  -2.459   0.0337 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.837 on 10 degrees of freedom\nMultiple R-squared:  0.3768,    Adjusted R-squared:  0.3145 \nF-statistic: 6.046 on 1 and 10 DF,  p-value: 0.03374\n\n\nLe coefficient d’autocorrélation spatiale de Moran est donc ici égal à -0.208 ce qui est la réponse donnée par la fonction moran.test()du package spdep ou la fonction moran_test() du package rgeoda. Cela est de toutes façons équivalent et on peut vérifier que la mesure de significativité de la régression est la même que celle du coefficient de corrélation (p &lt; 0.05)"
  },
  {
    "objectID": "autocor.html#calcul-et-test-de-lindice-de-moran-2",
    "href": "autocor.html#calcul-et-test-de-lindice-de-moran-2",
    "title": "Autocorrélation spatiale",
    "section": "Calcul et test de l’indice de Moran",
    "text": "Calcul et test de l’indice de Moran\nLes travaux de nombreux auteurs, et notamment Luc Anselin, ont proposé des améliorations au calcul de l’indice de Moran, notamment en présence de distributions Y de formes non gaussienne. L’usage du coefficient de corrélation linéaire suppose en effet que Y et Y_lag respectent des contraintes de normalité qui sont rarement vérifiées. Il vaut donc mieux dans ce cas recourir à des méthodes de simulation de type Monte Carlo pour obtenir un test réellement robuste. Ces méthodes sont toutefois gourmandes en temps de calcul et on ne les employera pas forcément sur les très grands tableaux. Les différentes variantes de calcul de l’indice de Moran sont facilement accessibles dans spdep grâce à la fonction moran.test().\n\n\n\n    Moran I test under randomisation\n\ndata:  sel$Y  \nweights: map_nb_w    \n\nMoran I statistic standard deviate = -0.69097, p-value = 0.4896\nalternative hypothesis: two.sided\nsample estimates:\nMoran I statistic       Expectation          Variance \n      -0.20852369       -0.09090909        0.02897351 \n\n\nOn retrouve bien notre coefficient de -0.208 mais le test ici n’est pas concluant et on ne peut donc pas affirmer que la configuration observée ne soit pas l’effet du hasard."
  },
  {
    "objectID": "autocor.html#construction-et-interprétation-dun-diagramme-de-moran",
    "href": "autocor.html#construction-et-interprétation-dun-diagramme-de-moran",
    "title": "Autocorrélation spatiale",
    "section": "Construction et interprétation d’un diagramme de Moran",
    "text": "Construction et interprétation d’un diagramme de Moran\nOn peut visualiser la relation statistique à l’aide d’un diagramme de Moran qui croise la variable standardisée \\(Y_{std}\\) et la moyenne dans le voisinage de cette variable standardisée \\(Y_{std}^{lag}\\)"
  },
  {
    "objectID": "autocor.html#indices-locaux-lisa",
    "href": "autocor.html#indices-locaux-lisa",
    "title": "Autocorrélation spatiale",
    "section": "Indices locaux (LISA)",
    "text": "Indices locaux (LISA)\nOn peut finalement analyser pour chaque unité spatiale les cas exceptionnels à l’aide des indices locaux d’autocorrelation spatiale appelés en anglais LISA (Local Index of Spatial Autocorrelation)\n\n\n\n\n\n\n  \n    \n      Indices locaux d’autocorrélation spatiale\n    \n    \n    \n      code\n      nom\n      Y\n      Y_std\n      Y_lag\n      Y_std_lag\n      Ii\n      E.Ii\n      Var.Ii\n      Z.Ii\n      Pr.z....E.Ii..\n    \n  \n  \n    11\nIDF\n18.79\n−2.15\n37.62\n0.73\n−1.71\n−0.46\n0.36\n−2.09\n0.04\n    24\nCVDL\n34.94\n0.32\n30.12\n−0.42\n−0.15\n−0.01\n0.01\n−1.36\n0.17\n    27\nBOFC\n37.09\n0.65\n30.74\n−0.32\n−0.23\n−0.04\n0.08\n−0.65\n0.52\n    28\nNORM\n35.33\n0.38\n29.87\n−0.46\n−0.19\n−0.01\n0.02\n−1.23\n0.22\n    32\nNOPI\n42.41\n1.46\n30.82\n−0.31\n−0.50\n−0.21\n0.53\n−0.39\n0.70\n    44\nACAL\n38.33\n0.84\n32.76\n−0.01\n−0.01\n−0.07\n0.21\n0.12\n0.90\n    52\nPDL\n27.63\n−0.80\n31.70\n−0.18\n0.16\n−0.06\n0.12\n0.62\n0.54\n    53\nBRET\n25.58\n−1.11\n31.48\n−0.21\n0.26\n−0.12\n0.58\n0.50\n0.62\n    75\nAQUI\n30.94\n−0.29\n31.79\n−0.16\n0.05\n−0.01\n0.02\n0.46\n0.65\n    76\nOCCI\n33.69\n0.13\n33.50\n0.10\n0.01\n0.00\n0.01\n0.21\n0.83\n    84\nAURA\n30.91\n−0.30\n35.06\n0.34\n−0.11\n−0.01\n0.01\n−0.90\n0.37\n    93\nPACA\n38.65\n0.89\n32.30\n−0.09\n−0.08\n−0.08\n0.39\n−0.01\n0.99"
  },
  {
    "objectID": "autocor.html#indices-locaux-lisa-1",
    "href": "autocor.html#indices-locaux-lisa-1",
    "title": "Autocorrélation spatiale",
    "section": "Indices locaux (LISA)",
    "text": "Indices locaux (LISA)\n\nLa variable Ii est l’indice d’autocorrélation spatiale local de la région. Il peut être localement plus fort ou plus faible que l’indice global qui a été mesuré sur l’ensemble des provinces italiennes. Il est directement lié à la position dans les quadrants du diagramme de Moran : l’indice sera positif pour les provinces de type Low-Low ou High-High mais négatif pour les provinces de type Low-High ou High-Low.\nla variable E.Ii est l’espérance de l’indice local d’autocorrélation spatiale, c’est-à-dire la valeur attendue en l’absence d’autocorrélation spatiale positive ou négative.\nla variance var.Ii est une mesure de la stabilité des différences observées entre une province et ses voisines. Si par exemple une province a une valeur deux fois plus forte que toutes ses voisines, la variance sera faible. Si en revanche elle est deux fois plus forte que la majorité de ses voisines mais deux fois pus faible qu’une partie d’entre elles, alors la variance sera forte.\nla variables Z.Ii est une mesure standardisée du coefficient d’autocorrélation qui permet de savoir rapidement si l’autocorrélation locale est significativement différente de zéro. D’une manière générale, l’autocorrélation est significative au seuil de 0.05 si cette valeur z est supérieure à +1.96 ou inférieure à -1.96.\nla variable Pr(z&gt;0) exprime la même chose en fournissant la p-value du test d’autocorrélation spatiale locale. On ne dispose plus du signe mais pn peut repérér directement toutes les provinces qui ont une autocorrélation spatiale significative (que celle-ci soit positive ou négative), à condition d’avoir bien pris la précaution de procéder à untest d’autocorrélation spatiale bilatéral à l’aide du paramètre alternative = “two.sided”. Si on oublie ce paramètre, la probabilité sera celle d’avoir une autocorrélation spatiale positive uniquement."
  },
  {
    "objectID": "autocor.html#typologie-de-moran",
    "href": "autocor.html#typologie-de-moran",
    "title": "Autocorrélation spatiale",
    "section": "Typologie de Moran",
    "text": "Typologie de Moran\nL’ultime étape va consister à cartogaphier les provinces ayant un indice d’autocorrélation spatiale locale significativement différent de zéro en se fixant un seuil de significativité qui sera classiquement égal à 0.05 mais que l’on peut si on le souhaite rendre plus exigeant (0.01) ou moins exigeant (0.10). Dans notre exemple une seule région possède un indice local de Moran significatif, la région Ile de France qui est significativement dans le type Bas-Haut :"
  },
  {
    "objectID": "autocor.html#préparation-des-données",
    "href": "autocor.html#préparation-des-données",
    "title": "Autocorrélation spatiale",
    "section": "Préparation des données",
    "text": "Préparation des données\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 94 \nNumber of nonzero links: 474 \nPercentage nonzero weights: 5.364418 \nAverage number of links: 5.042553 \nLink number distribution:\n\n 2  3  4  5  6  7  8 10 \n 6 12 14 19 30 11  1  1 \n6 least connected regions:\n06 29 57 62 66 74 with 2 links\n1 most connected region:\n77 with 10 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 94 8836 94 40.29206 383.9874"
  },
  {
    "objectID": "autocor.html#choix-dune-variable-y-1",
    "href": "autocor.html#choix-dune-variable-y-1",
    "title": "Autocorrélation spatiale",
    "section": "Choix d’une variable Y",
    "text": "Choix d’une variable Y"
  },
  {
    "objectID": "autocor.html#valeurs-de-voisinage-2",
    "href": "autocor.html#valeurs-de-voisinage-2",
    "title": "Autocorrélation spatiale",
    "section": "Valeurs de voisinage",
    "text": "Valeurs de voisinage\n\n\n\n\n\n\n  \n    \n      Valeurs standardisées et moyenne des voisins\n    \n    \n    \n      code\n      nom\n      Y\n      Y_std\n      Y_lag\n      Y_std_lag\n    \n  \n  \n    01\nAIN\n36.5\n0.4\n31.4\n−0.3\n    02\nAISNE\n50.6\n2.2\n40.5\n0.9\n    03\nALLIER\n36.7\n0.4\n36.0\n0.3\n    04\nALPES-DE-HAUTE-PROVENCE\n36.3\n0.3\n37.1\n0.4\n    05\nHAUTES-ALPES\n31.1\n−0.4\n33.1\n−0.1\n    06\nALPES-MARITIMES\n37.7\n0.5\n39.8\n0.8\n    07\nARDECHE\n34.7\n0.1\n35.8\n0.3\n    08\nARDENNES\n45.9\n1.6\n45.7\n1.6\n    09\nARIEGE\n32.5\n−0.2\n36.5\n0.3\n    10\nAUBE\n44.1\n1.4\n39.2\n0.7\n    11\nAUDE\n40.6\n0.9\n34.0\n0.0\n    12\nAVEYRON\n28.2\n−0.8\n34.3\n0.1\n    13\nBOUCHES-DU-RHONE\n36.8\n0.4\n41.3\n1.0\n    14\nCALVADOS\n30.3\n−0.5\n36.7\n0.4\n    15\nCANTAL\n33.7\n0.0\n31.2\n−0.4\n    16\nCHARENTE\n35.2\n0.2\n31.9\n−0.3\n    17\nCHARENTE-MARITIME\n32.9\n−0.1\n32.2\n−0.2\n    18\nCHER\n38.0\n0.5\n37.2\n0.4\n    19\nCORREZE\n32.6\n−0.2\n32.0\n−0.3\n    21\nCOTE-D'OR\n33.4\n−0.1\n41.4\n1.0\n    22\nCOTES-D'ARMOR\n28.2\n−0.8\n25.2\n−1.2\n    23\nCREUSE\n35.4\n0.2\n34.8\n0.1\n    24\nDORDOGNE\n34.7\n0.1\n32.4\n−0.2\n    25\nDOUBS\n33.7\n0.0\n39.1\n0.7\n    26\nDROME\n33.2\n−0.1\n34.7\n0.1\n    27\nEURE\n42.6\n1.2\n32.9\n−0.1\n    28\nEURE-ET-LOIR\n38.0\n0.6\n33.3\n−0.1\n    29\nFINISTERE\n24.9\n−1.2\n28.4\n−0.7\n    30\nGARD\n40.4\n0.9\n34.5\n0.1\n    31\nHAUTE-GARONNE\n25.5\n−1.1\n34.9\n0.1\n    32\nGERS\n31.6\n−0.3\n31.8\n−0.3\n    33\nGIRONDE\n28.9\n−0.7\n34.2\n0.0\n    34\nHERAULT\n35.0\n0.1\n35.8\n0.3\n    35\nILLE-ET-VILAINE\n22.2\n−1.6\n27.8\n−0.8\n    36\nINDRE\n40.1\n0.8\n33.5\n−0.1\n    37\nINDRE-ET-LOIRE\n28.5\n−0.7\n34.1\n0.0\n    38\nISERE\n31.3\n−0.4\n32.4\n−0.2\n    39\nJURA\n34.8\n0.1\n37.4\n0.5\n    40\nLANDES\n30.6\n−0.4\n31.1\n−0.4\n    41\nLOIR-ET-CHER\n37.2\n0.4\n35.9\n0.3\n    42\nLOIRE\n36.0\n0.3\n33.1\n−0.1\n    43\nHAUTE-LOIRE\n37.8\n0.5\n33.2\n−0.1\n    44\nLOIRE-ATLANTIQUE\n22.6\n−1.5\n27.4\n−0.9\n    45\nLOIRET\n34.8\n0.1\n36.2\n0.3\n    46\nLOT\n26.7\n−1.0\n34.4\n0.1\n    47\nLOT-ET-GARONNE\n38.6\n0.6\n31.9\n−0.3\n    48\nLOZERE\n31.9\n−0.3\n35.0\n0.1\n    49\nMAINE-ET-LOIRE\n26.8\n−1.0\n28.9\n−0.7\n    50\nMANCHE\n31.2\n−0.4\n29.6\n−0.6\n    51\nMARNE\n40.3\n0.9\n44.6\n1.4\n    52\nHAUTE-MARNE\n47.1\n1.8\n41.9\n1.1\n    53\nMAYENNE\n29.6\n−0.6\n30.5\n−0.5\n    54\nMEURTHE-ET-MOSELLE\n35.8\n0.3\n40.0\n0.8\n    55\nMEUSE\n46.0\n1.6\n42.2\n1.1\n    56\nMORBIHAN\n28.6\n−0.7\n24.5\n−1.3\n    57\nMOSELLE\n40.5\n0.9\n33.7\n0.0\n    58\nNIEVRE\n38.9\n0.7\n37.0\n0.4\n    59\nNORD\n37.3\n0.5\n46.9\n1.7\n    60\nOISE\n43.3\n1.3\n38.6\n0.6\n    61\nORNE\n36.2\n0.3\n34.6\n0.1\n    62\nPAS-DE-CALAIS\n47.5\n1.8\n39.9\n0.8\n    63\nPUY-DE-DOME\n30.0\n−0.5\n35.3\n0.2\n    64\nPYRENEES-ATLANTIQUES\n25.2\n−1.2\n31.4\n−0.3\n    65\nHAUTES-PYRENEES\n32.0\n−0.3\n27.4\n−0.9\n    66\nPYRENEES-ORIENTALES\n43.4\n1.3\n36.5\n0.4\n    67\nBAS-RHIN\n31.6\n−0.3\n38.6\n0.6\n    68\nHAUT-RHIN\n36.0\n0.3\n36.8\n0.4\n    69\nRHONE\n23.7\n−1.4\n35.4\n0.2\n    70\nHAUTE-SAONE\n45.8\n1.6\n38.0\n0.5\n    71\nSAONE-ET-LOIRE\n37.8\n0.5\n34.3\n0.1\n    72\nSARTHE\n35.9\n0.3\n32.7\n−0.2\n    73\nSAVOIE\n31.6\n−0.3\n32.0\n−0.2\n    74\nHAUTE-SAVOIE\n29.3\n−0.6\n34.0\n0.0\n    75\nPARIS\n8.5\n−3.4\n15.9\n−2.4\n    76\nSEINE-MARITIME\n36.4\n0.3\n42.8\n1.2\n    77\nSEINE-ET-MARNE\n33.7\n0.0\n34.0\n0.0\n    78\nYVELINES\n20.5\n−1.8\n29.0\n−0.6\n    79\nDEUX-SEVRES\n29.7\n−0.6\n31.5\n−0.3\n    80\nSOMME\n42.6\n1.2\n43.0\n1.2\n    81\nTARN\n33.9\n0.0\n33.6\n0.0\n    82\nTARN-ET-GARONNE\n38.8\n0.7\n30.7\n−0.4\n    83\nVAR\n43.2\n1.3\n37.8\n0.5\n    84\nVAUCLUSE\n40.2\n0.9\n37.5\n0.5\n    85\nVENDEE\n32.2\n−0.2\n28.0\n−0.8\n    86\nVIENNE\n30.4\n−0.5\n32.0\n−0.3\n    87\nHAUTE-VIENNE\n31.6\n−0.3\n34.7\n0.1\n    88\nVOSGES\n42.0\n1.1\n39.9\n0.8\n    89\nYONNE\n41.4\n1.0\n37.0\n0.4\n    90\nTERRITOIRE DE BELFORT\n36.8\n0.4\n39.3\n0.7\n    91\nESSONNE\n25.9\n−1.1\n26.3\n−1.0\n    92\nHAUTS-DE-SEINE\n13.2\n−2.8\n19.2\n−2.0\n    93\nSEINE-SAINT-DENIS\n16.9\n−2.3\n19.7\n−1.9\n    94\nVAL-DE-MARNE\n17.6\n−2.2\n19.6\n−1.9\n    95\nVAL-D'OISE\n25.5\n−1.1\n28.4\n−0.7"
  },
  {
    "objectID": "autocor.html#indice-et-diagramme-de-moran",
    "href": "autocor.html#indice-et-diagramme-de-moran",
    "title": "Autocorrélation spatiale",
    "section": "Indice et diagramme de Moran",
    "text": "Indice et diagramme de Moran\n\n\n\n    Moran I test under randomisation\n\ndata:  sel$Y  \nweights: map_nb_w    \n\nMoran I statistic standard deviate = 8.8275, p-value &lt; 2.2e-16\nalternative hypothesis: two.sided\nsample estimates:\nMoran I statistic       Expectation          Variance \n       0.56608333       -0.01075269        0.00427000"
  },
  {
    "objectID": "autocor.html#calcul-des-lisa",
    "href": "autocor.html#calcul-des-lisa",
    "title": "Autocorrélation spatiale",
    "section": "Calcul des LISA",
    "text": "Calcul des LISA\n\n\n\n\n\n\n  \n    \n      Indices locaux d’autocorrélation spatiale\n    \n    \n    \n      code\n      nom\n      Y\n      Y_std\n      Y_lag\n      Y_std_lag\n      Ii\n      E.Ii\n      Var.Ii\n      Z.Ii\n      Pr.z....E.Ii..\n    \n  \n  \n    01\nAIN\n36.53\n0.35\n31.40\n−0.33\n−0.12\n0.00\n0.02\n−0.83\n0.41\n    02\nAISNE\n50.64\n2.25\n40.51\n0.89\n2.02\n−0.05\n0.77\n2.37\n0.02\n    03\nALLIER\n36.70\n0.38\n35.99\n0.28\n0.11\n0.00\n0.02\n0.72\n0.47\n    04\nALPES-DE-HAUTE-PROVENCE\n36.30\n0.32\n37.10\n0.43\n0.14\n0.00\n0.02\n0.99\n0.32\n    05\nHAUTES-ALPES\n31.06\n−0.38\n33.09\n−0.11\n0.04\n0.00\n0.04\n0.22\n0.82\n    06\nALPES-MARITIMES\n37.73\n0.52\n39.77\n0.79\n0.41\n0.00\n0.13\n1.13\n0.26\n    07\nARDECHE\n34.71\n0.11\n35.83\n0.26\n0.03\n0.00\n0.00\n0.72\n0.47\n    08\nARDENNES\n45.92\n1.61\n45.65\n1.58\n2.58\n−0.03\n0.84\n2.84\n0.00\n    09\nARIEGE\n32.52\n−0.18\n36.48\n0.35\n−0.06\n0.00\n0.01\n−0.61\n0.54\n    10\nAUBE\n44.12\n1.37\n39.19\n0.71\n0.99\n−0.02\n0.36\n1.68\n0.09\n    11\nAUDE\n40.57\n0.90\n34.05\n0.02\n0.02\n−0.01\n0.16\n0.07\n0.94\n    12\nAVEYRON\n28.18\n−0.77\n34.34\n0.06\n−0.05\n−0.01\n0.08\n−0.14\n0.89\n    13\nBOUCHES-DU-RHONE\n36.85\n0.40\n41.30\n0.99\n0.40\n0.00\n0.05\n1.75\n0.08\n    14\nCALVADOS\n30.30\n−0.48\n36.70\n0.38\n−0.18\n0.00\n0.08\n−0.65\n0.51\n    15\nCANTAL\n33.67\n−0.03\n31.18\n−0.36\n0.01\n0.00\n0.00\n0.91\n0.36\n    16\nCHARENTE\n35.22\n0.18\n31.87\n−0.27\n−0.05\n0.00\n0.01\n−0.61\n0.54\n    17\nCHARENTE-MARITIME\n32.94\n−0.13\n32.16\n−0.23\n0.03\n0.00\n0.00\n0.53\n0.59\n    18\nCHER\n37.95\n0.55\n37.18\n0.44\n0.24\n0.00\n0.05\n1.13\n0.26\n    19\nCORREZE\n32.58\n−0.18\n32.00\n−0.25\n0.04\n0.00\n0.00\n0.64\n0.52\n    21\nCOTE-D'OR\n33.40\n−0.07\n41.42\n1.01\n−0.07\n0.00\n0.00\n−2.76\n0.01\n    22\nCOTES-D'ARMOR\n28.21\n−0.76\n25.24\n−1.16\n0.89\n−0.01\n0.19\n2.05\n0.04\n    23\nCREUSE\n35.40\n0.20\n34.81\n0.12\n0.03\n0.00\n0.01\n0.32\n0.75\n    24\nDORDOGNE\n34.74\n0.11\n32.36\n−0.20\n−0.02\n0.00\n0.00\n−0.56\n0.58\n    25\nDOUBS\n33.66\n−0.03\n39.15\n0.71\n−0.02\n0.00\n0.00\n−1.24\n0.22\n    26\nDROME\n33.24\n−0.09\n34.72\n0.11\n−0.01\n0.00\n0.00\n−0.25\n0.80\n    27\nEURE\n42.64\n1.17\n32.89\n−0.13\n−0.16\n−0.01\n0.19\n−0.33\n0.74\n    28\nEURE-ET-LOIR\n37.99\n0.55\n33.31\n−0.08\n−0.04\n0.00\n0.04\n−0.19\n0.85\n    29\nFINISTERE\n24.89\n−1.21\n28.39\n−0.74\n0.90\n−0.02\n0.72\n1.07\n0.28\n    30\nGARD\n40.42\n0.88\n34.48\n0.08\n0.07\n−0.01\n0.12\n0.23\n0.82\n    31\nHAUTE-GARONNE\n25.48\n−1.13\n34.90\n0.14\n−0.16\n−0.01\n0.20\n−0.32\n0.75\n    32\nGERS\n31.63\n−0.30\n31.77\n−0.28\n0.09\n0.00\n0.01\n0.72\n0.47\n    33\nGIRONDE\n28.88\n−0.67\n34.21\n0.04\n−0.03\n0.00\n0.11\n−0.07\n0.94\n    34\nHERAULT\n34.98\n0.15\n35.76\n0.25\n0.04\n0.00\n0.01\n0.52\n0.61\n    35\nILLE-ET-VILAINE\n22.25\n−1.56\n27.82\n−0.81\n1.28\n−0.03\n0.38\n2.12\n0.03\n    36\nINDRE\n40.08\n0.83\n33.50\n−0.05\n−0.04\n−0.01\n0.11\n−0.11\n0.91\n    37\nINDRE-ET-LOIRE\n28.45\n−0.73\n34.05\n0.02\n−0.02\n−0.01\n0.10\n−0.03\n0.97\n    38\nISERE\n31.26\n−0.35\n32.39\n−0.20\n0.07\n0.00\n0.02\n0.56\n0.58\n    39\nJURA\n34.80\n0.12\n37.43\n0.48\n0.06\n0.00\n0.00\n1.09\n0.28\n    40\nLANDES\n30.56\n−0.45\n31.08\n−0.38\n0.17\n0.00\n0.05\n0.78\n0.44\n    41\nLOIR-ET-CHER\n37.21\n0.45\n35.86\n0.26\n0.12\n0.00\n0.03\n0.68\n0.50\n    42\nLOIRE\n35.95\n0.28\n33.12\n−0.10\n−0.03\n0.00\n0.01\n−0.27\n0.78\n    43\nHAUTE-LOIRE\n37.77\n0.52\n33.24\n−0.09\n−0.05\n0.00\n0.05\n−0.18\n0.85\n    44\nLOIRE-ATLANTIQUE\n22.59\n−1.52\n27.44\n−0.86\n1.32\n−0.02\n0.55\n1.81\n0.07\n    45\nLOIRET\n34.80\n0.12\n36.16\n0.31\n0.04\n0.00\n0.00\n0.84\n0.40\n    46\nLOT\n26.66\n−0.97\n34.43\n0.07\n−0.07\n−0.01\n0.15\n−0.16\n0.87\n    47\nLOT-ET-GARONNE\n38.62\n0.63\n31.88\n−0.27\n−0.17\n0.00\n0.06\n−0.66\n0.51\n    48\nLOZERE\n31.93\n−0.26\n34.95\n0.14\n−0.04\n0.00\n0.01\n−0.32\n0.75\n    49\nMAINE-ET-LOIRE\n26.76\n−0.96\n28.88\n−0.67\n0.65\n−0.01\n0.11\n2.01\n0.04\n    50\nMANCHE\n31.21\n−0.36\n29.60\n−0.57\n0.21\n0.00\n0.03\n1.18\n0.24\n    51\nMARNE\n40.29\n0.86\n44.59\n1.44\n1.25\n−0.01\n0.12\n3.66\n0.00\n    52\nHAUTE-MARNE\n47.13\n1.78\n41.93\n1.08\n1.94\n−0.03\n0.49\n2.82\n0.00\n    53\nMAYENNE\n29.61\n−0.57\n30.47\n−0.46\n0.27\n0.00\n0.06\n1.06\n0.29\n    54\nMEURTHE-ET-MOSELLE\n35.79\n0.26\n40.01\n0.82\n0.21\n0.00\n0.02\n1.68\n0.09\n    55\nMEUSE\n46.03\n1.63\n42.22\n1.12\n1.84\n−0.03\n0.50\n2.63\n0.01\n    56\nMORBIHAN\n28.57\n−0.71\n24.48\n−1.26\n0.91\n−0.01\n0.12\n2.59\n0.01\n    57\nMOSELLE\n40.51\n0.89\n33.67\n−0.03\n−0.03\n−0.01\n0.40\n−0.03\n0.98\n    58\nNIEVRE\n38.89\n0.67\n37.01\n0.42\n0.28\n0.00\n0.07\n1.08\n0.28\n    59\nNORD\n37.34\n0.46\n46.89\n1.74\n0.82\n0.00\n0.07\n3.07\n0.00\n    60\nOISE\n43.27\n1.26\n38.57\n0.63\n0.80\n−0.02\n0.25\n1.63\n0.10\n    61\nORNE\n36.25\n0.32\n34.60\n0.10\n0.03\n0.00\n0.02\n0.25\n0.80\n    62\nPAS-DE-CALAIS\n47.46\n1.82\n39.95\n0.81\n1.50\n−0.04\n1.62\n1.21\n0.23\n    63\nPUY-DE-DOME\n29.96\n−0.53\n35.35\n0.20\n−0.10\n0.00\n0.04\n−0.48\n0.63\n    64\nPYRENEES-ATLANTIQUES\n25.18\n−1.17\n31.40\n−0.33\n0.39\n−0.01\n0.45\n0.61\n0.54\n    65\nHAUTES-PYRENEES\n32.00\n−0.25\n27.43\n−0.87\n0.22\n0.00\n0.02\n1.52\n0.13\n    66\nPYRENEES-ORIENTALES\n43.38\n1.27\n36.54\n0.36\n0.46\n−0.02\n0.81\n0.53\n0.60\n    67\nBAS-RHIN\n31.55\n−0.31\n38.56\n0.63\n−0.20\n0.00\n0.02\n−1.27\n0.20\n    68\nHAUT-RHIN\n35.97\n0.28\n36.79\n0.39\n0.11\n0.00\n0.03\n0.69\n0.49\n    69\nRHONE\n23.66\n−1.37\n35.38\n0.20\n−0.28\n−0.02\n0.45\n−0.38\n0.70\n    70\nHAUTE-SAONE\n45.80\n1.60\n37.96\n0.55\n0.88\n−0.03\n0.40\n1.44\n0.15\n    71\nSAONE-ET-LOIRE\n37.76\n0.52\n34.28\n0.05\n0.03\n0.00\n0.04\n0.16\n0.87\n    72\nSARTHE\n35.87\n0.27\n32.71\n−0.16\n−0.04\n0.00\n0.01\n−0.39\n0.70\n    73\nSAVOIE\n31.56\n−0.31\n32.04\n−0.25\n0.08\n0.00\n0.02\n0.51\n0.61\n    74\nHAUTE-SAVOIE\n29.32\n−0.61\n34.05\n0.02\n−0.01\n0.00\n0.19\n−0.02\n0.98\n    75\nPARIS\n8.54\n−3.40\n15.88\n−2.42\n8.30\n−0.13\n3.37\n4.59\n0.00\n    76\nSEINE-MARITIME\n36.36\n0.33\n42.82\n1.20\n0.40\n0.00\n0.04\n2.11\n0.04\n    77\nSEINE-ET-MARNE\n33.71\n−0.02\n34.05\n0.02\n0.00\n0.00\n0.00\n−0.07\n0.94\n    78\nYVELINES\n20.53\n−1.79\n29.04\n−0.65\n1.18\n−0.03\n0.61\n1.56\n0.12\n    79\nDEUX-SEVRES\n29.74\n−0.56\n31.49\n−0.32\n0.18\n0.00\n0.06\n0.75\n0.45\n    80\nSOMME\n42.56\n1.16\n43.01\n1.22\n1.44\n−0.01\n0.26\n2.85\n0.00\n    81\nTARN\n33.88\n0.00\n33.60\n−0.04\n0.00\n0.00\n0.00\n−0.09\n0.93\n    82\nTARN-ET-GARONNE\n38.81\n0.66\n30.74\n−0.42\n−0.28\n0.00\n0.07\n−1.05\n0.30\n    83\nVAR\n43.23\n1.25\n37.78\n0.52\n0.66\n−0.02\n0.38\n1.10\n0.27\n    84\nVAUCLUSE\n40.24\n0.85\n37.46\n0.48\n0.41\n−0.01\n0.12\n1.24\n0.22\n    85\nVENDEE\n32.20\n−0.23\n28.00\n−0.79\n0.18\n0.00\n0.01\n1.61\n0.11\n    86\nVIENNE\n30.35\n−0.47\n31.98\n−0.26\n0.12\n0.00\n0.04\n0.66\n0.51\n    87\nHAUTE-VIENNE\n31.60\n−0.31\n34.73\n0.11\n−0.04\n0.00\n0.02\n−0.28\n0.78\n    88\nVOSGES\n41.96\n1.08\n39.87\n0.80\n0.88\n−0.01\n0.16\n2.24\n0.02\n    89\nYONNE\n41.45\n1.01\n36.98\n0.42\n0.43\n−0.01\n0.20\n0.98\n0.33\n    90\nTERRITOIRE DE BELFORT\n36.85\n0.40\n39.35\n0.73\n0.29\n0.00\n0.04\n1.50\n0.13\n    91\nESSONNE\n25.90\n−1.07\n26.30\n−1.02\n1.10\n−0.01\n0.18\n2.61\n0.01\n    92\nHAUTS-DE-SEINE\n13.16\n−2.78\n19.16\n−1.98\n5.55\n−0.08\n1.14\n5.28\n0.00\n    93\nSEINE-SAINT-DENIS\n16.89\n−2.28\n19.70\n−1.90\n4.38\n−0.06\n0.96\n4.54\n0.00\n    94\nVAL-DE-MARNE\n17.59\n−2.19\n19.64\n−1.91\n4.22\n−0.05\n0.89\n4.54\n0.00\n    95\nVAL-D'OISE\n25.51\n−1.12\n28.37\n−0.74\n0.84\n−0.01\n0.20\n1.91\n0.06"
  },
  {
    "objectID": "autocor.html#carte-des-lisa",
    "href": "autocor.html#carte-des-lisa",
    "title": "Autocorrélation spatiale",
    "section": "Carte des LISA",
    "text": "Carte des LISA"
  },
  {
    "objectID": "autocor.html#typologie-de-moran-1",
    "href": "autocor.html#typologie-de-moran-1",
    "title": "Autocorrélation spatiale",
    "section": "Typologie de Moran",
    "text": "Typologie de Moran"
  },
  {
    "objectID": "autocor.html#préparation-des-données-1",
    "href": "autocor.html#préparation-des-données-1",
    "title": "Autocorrélation spatiale",
    "section": "Préparation des données",
    "text": "Préparation des données\n\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 517 \nNumber of nonzero links: 2776 \nPercentage nonzero weights: 1.038576 \nAverage number of links: 5.369439 \nLink number distribution:\n\n  1   2   3   4   5   6   7   8   9  10  11 \n  3  18  64  79 116 100  73  46  11   6   1 \n3 least connected regions:\n17001 56005 59013 with 1 link\n1 most connected region:\n42004 with 11 links\n\nWeights style: W \nWeights constants summary:\n    n     nn  S0       S1       S2\nW 517 267289 517 208.7879 2132.706"
  },
  {
    "objectID": "autocor.html#choix-dune-variable-y-2",
    "href": "autocor.html#choix-dune-variable-y-2",
    "title": "Autocorrélation spatiale",
    "section": "Choix d’une variable Y",
    "text": "Choix d’une variable Y"
  },
  {
    "objectID": "autocor.html#valeurs-de-voisinage-3",
    "href": "autocor.html#valeurs-de-voisinage-3",
    "title": "Autocorrélation spatiale",
    "section": "Valeurs de voisinage",
    "text": "Valeurs de voisinage\n\n\n\n\n\n\n  \n    \n      Valeurs standardisées et moyenne des voisins\n    \n    \n    \n      code\n      nom\n      Y\n      Y_std\n      Y_lag\n      Y_std_lag\n    \n  \n  \n    33004\n33004\n30.6\n−0.2\n28.6\n−0.4\n    38001\n38001\n15.2\n−1.7\n24.5\n−0.8\n    59010\n59010\n34.9\n0.3\n25.4\n−0.7\n    33007\n33007\n20.0\n−1.3\n23.8\n−0.9\n    01001\n01001\n37.8\n0.6\n37.1\n0.5\n    01002\n01002\n36.7\n0.4\n33.6\n0.1\n    01003\n01003\n27.5\n−0.5\n35.5\n0.3\n    01004\n01004\n40.3\n0.8\n35.8\n0.4\n    01005\n01005\n39.1\n0.7\n36.0\n0.4\n    02001\n02001\n50.2\n1.8\n46.0\n1.4\n    02002\n02002\n49.0\n1.7\n52.2\n2.0\n    02003\n02003\n55.9\n2.4\n49.3\n1.7\n    02004\n02004\n50.9\n1.9\n47.3\n1.5\n    02005\n02005\n48.2\n1.6\n42.1\n1.0\n    03001\n03001\n36.5\n0.4\n38.4\n0.6\n    03002\n03002\n37.8\n0.6\n36.2\n0.4\n    03003\n03003\n35.8\n0.4\n36.7\n0.4\n    04001\n04001\n38.5\n0.6\n39.6\n0.7\n    04002\n04002\n34.3\n0.2\n35.9\n0.4\n    05001\n05001\n32.6\n0.0\n30.0\n−0.2\n    05002\n05002\n29.4\n−0.3\n32.7\n0.0\n    06002\n06002\n40.2\n0.8\n38.0\n0.6\n    06004\n06004\n44.9\n1.3\n34.4\n0.2\n    06005\n06005\n36.3\n0.4\n38.1\n0.6\n    06006\n06006\n42.3\n1.0\n36.4\n0.4\n    06007\n06007\n32.8\n0.0\n39.7\n0.7\n    07001\n07001\n36.6\n0.4\n38.9\n0.7\n    07002\n07002\n35.5\n0.3\n37.5\n0.5\n    07003\n07003\n32.0\n0.0\n37.1\n0.5\n    08001\n08001\n45.7\n1.4\n45.4\n1.3\n    08002\n08002\n45.8\n1.4\n46.0\n1.4\n    08003\n08003\n46.3\n1.4\n43.9\n1.2\n    09001\n09001\n30.7\n−0.2\n36.8\n0.4\n    09002\n09002\n34.2\n0.2\n32.6\n0.0\n    10001\n10001\n47.4\n1.5\n44.8\n1.3\n    10002\n10002\n43.1\n1.1\n43.1\n1.1\n    11001\n11001\n42.4\n1.0\n40.8\n0.9\n    11002\n11002\n42.7\n1.0\n44.0\n1.2\n    11003\n11003\n37.1\n0.5\n36.5\n0.4\n    12001\n12001\n27.5\n−0.5\n31.3\n−0.1\n    12002\n12002\n28.3\n−0.4\n30.8\n−0.2\n    12003\n12003\n28.7\n−0.4\n33.2\n0.1\n    13008\n13008\n41.3\n0.9\n41.6\n0.9\n    13009\n13009\n40.7\n0.8\n37.6\n0.5\n    13010\n13010\n43.6\n1.1\n34.7\n0.2\n    13011\n13011\n32.1\n0.0\n38.0\n0.6\n    13012\n13012\n48.5\n1.6\n36.9\n0.5\n    13013\n13013\n44.2\n1.2\n45.5\n1.3\n    13014\n13014\n28.9\n−0.4\n41.0\n0.9\n    13015\n13015\n43.2\n1.1\n36.6\n0.4\n    13016\n13016\n42.6\n1.0\n42.6\n1.0\n    14001\n14001\n20.6\n−1.2\n29.0\n−0.3\n    14002\n14002\n23.0\n−0.9\n31.2\n−0.1\n    14003\n14003\n38.8\n0.6\n34.9\n0.3\n    14004\n14004\n32.4\n0.0\n34.1\n0.2\n    14005\n14005\n30.0\n−0.2\n28.7\n−0.4\n    14006\n14006\n34.0\n0.2\n30.3\n−0.2\n    15001\n15001\n32.4\n0.0\n30.1\n−0.2\n    15002\n15002\n35.2\n0.3\n30.9\n−0.1\n    16001\n16001\n29.0\n−0.3\n38.1\n0.6\n    16002\n16002\n37.1\n0.5\n35.7\n0.3\n    16003\n16003\n39.1\n0.7\n33.6\n0.1\n    17001\n17001\n21.1\n−1.1\n31.3\n−0.1\n    17002\n17002\n31.3\n−0.1\n32.7\n0.0\n    17003\n17003\n35.7\n0.3\n36.2\n0.4\n    17004\n17004\n39.0\n0.7\n38.7\n0.6\n    17005\n17005\n38.5\n0.6\n35.3\n0.3\n    18001\n18001\n36.5\n0.4\n39.2\n0.7\n    18002\n18002\n36.4\n0.4\n39.9\n0.8\n    18003\n18003\n40.4\n0.8\n37.6\n0.5\n    19001\n19001\n31.6\n−0.1\n32.0\n0.0\n    19002\n19002\n33.5\n0.1\n32.2\n0.0\n    21002\n21002\n32.4\n0.0\n36.8\n0.5\n    21004\n21004\n39.3\n0.7\n38.7\n0.6\n    21005\n21005\n38.1\n0.6\n35.7\n0.3\n    22001\n22001\n25.2\n−0.7\n29.6\n−0.3\n    22002\n22002\n28.7\n−0.4\n27.1\n−0.5\n    22003\n22003\n33.3\n0.1\n29.4\n−0.3\n    22004\n22004\n31.1\n−0.1\n27.9\n−0.5\n    22005\n22005\n24.6\n−0.8\n28.1\n−0.4\n    23001\n23001\n35.4\n0.3\n35.6\n0.3\n    24001\n24001\n34.6\n0.2\n37.8\n0.5\n    24002\n24002\n36.7\n0.4\n38.5\n0.6\n    24003\n24003\n35.7\n0.3\n36.8\n0.4\n    24004\n24004\n32.3\n0.0\n33.2\n0.1\n    25003\n25003\n40.2\n0.8\n37.3\n0.5\n    25004\n25004\n44.0\n1.2\n38.0\n0.6\n    25005\n25005\n32.8\n0.1\n33.1\n0.1\n    26001\n26001\n29.2\n−0.3\n34.9\n0.3\n    26002\n26002\n38.9\n0.7\n34.6\n0.2\n    26003\n26003\n27.9\n−0.5\n34.9\n0.3\n    26004\n26004\n37.5\n0.5\n33.1\n0.1\n    27003\n27003\n44.4\n1.2\n39.6\n0.7\n    27004\n27004\n41.1\n0.9\n40.6\n0.8\n    27005\n27005\n42.8\n1.1\n38.0\n0.6\n    34006\n34006\n45.4\n1.3\n42.4\n1.0\n    38002\n38002\n27.7\n−0.5\n22.4\n−1.0\n    56005\n56005\n24.0\n−0.8\n32.4\n0.0\n    57006\n57006\n47.7\n1.6\n46.9\n1.5\n    59005\n59005\n37.4\n0.5\n36.3\n0.4\n    59006\n59006\n32.1\n0.0\n40.0\n0.8\n    59016\n59016\n50.3\n1.8\n44.7\n1.3\n    59017\n59017\n46.1\n1.4\n46.7\n1.4\n    59020\n59020\n47.6\n1.5\n44.4\n1.2\n    78004\n78004\n15.9\n−1.7\n16.1\n−1.6\n    78005\n78005\n16.2\n−1.6\n19.5\n−1.3\n    83003\n83003\n40.5\n0.8\n42.5\n1.0\n    91001\n91001\n23.7\n−0.9\n30.2\n−0.2\n    91006\n91006\n19.2\n−1.3\n19.7\n−1.3\n    92007\n92007\n13.9\n−1.9\n14.2\n−1.8\n    92012\n92012\n16.2\n−1.6\n12.9\n−2.0\n    93003\n93003\n21.0\n−1.1\n22.2\n−1.0\n    06001\n06001\n32.3\n0.0\n38.6\n0.6\n    31002\n31002\n21.0\n−1.1\n25.4\n−0.7\n    31003\n31003\n17.4\n−1.5\n23.2\n−0.9\n    33002\n33002\n12.8\n−2.0\n21.4\n−1.1\n    59008\n59008\n33.2\n0.1\n26.9\n−0.5\n    59009\n59009\n20.1\n−1.2\n25.9\n−0.6\n    67003\n67003\n18.6\n−1.4\n24.6\n−0.8\n    69006\n69006\n16.7\n−1.6\n19.2\n−1.3\n    95005\n95005\n18.3\n−1.4\n16.8\n−1.6\n    13001\n13001\n30.1\n−0.2\n34.9\n0.3\n    30001\n30001\n39.9\n0.8\n40.8\n0.9\n    30006\n30006\n36.0\n0.4\n41.2\n0.9\n    31004\n31004\n13.6\n−1.9\n22.8\n−1.0\n    59002\n59002\n18.4\n−1.4\n27.2\n−0.5\n    67002\n67002\n17.1\n−1.5\n20.9\n−1.2\n    69002\n69002\n13.5\n−1.9\n18.6\n−1.4\n    69004\n69004\n13.5\n−1.9\n19.1\n−1.3\n    92009\n92009\n11.6\n−2.1\n12.6\n−2.0\n    28002\n28002\n38.7\n0.6\n36.8\n0.4\n    28003\n28003\n37.4\n0.5\n38.2\n0.6\n    28004\n28004\n44.3\n1.2\n33.9\n0.2\n    29001\n29001\n21.8\n−1.1\n26.3\n−0.6\n    29003\n29003\n24.7\n−0.8\n24.1\n−0.8\n    29004\n29004\n24.8\n−0.8\n27.9\n−0.4\n    29005\n29005\n25.7\n−0.7\n24.7\n−0.8\n    29006\n29006\n26.9\n−0.6\n26.8\n−0.6\n    29007\n29007\n24.0\n−0.8\n24.3\n−0.8\n    29008\n29008\n28.0\n−0.4\n27.0\n−0.5\n    30002\n30002\n46.5\n1.4\n35.6\n0.3\n    30003\n30003\n40.6\n0.8\n40.8\n0.9\n    30004\n30004\n43.0\n1.1\n37.9\n0.6\n    30005\n30005\n36.2\n0.4\n35.3\n0.3\n    31005\n31005\n35.3\n0.3\n29.2\n−0.3\n    31006\n31006\n26.4\n−0.6\n30.3\n−0.2\n    31007\n31007\n34.2\n0.2\n25.9\n−0.6\n    31008\n31008\n36.0\n0.4\n31.1\n−0.1\n    31010\n31010\n25.0\n−0.7\n29.8\n−0.3\n    32001\n32001\n30.3\n−0.2\n31.3\n−0.1\n    32002\n32002\n32.9\n0.1\n33.4\n0.1\n    33005\n33005\n38.0\n0.6\n29.9\n−0.2\n    33008\n33008\n32.5\n0.0\n29.7\n−0.3\n    33009\n33009\n33.5\n0.1\n29.2\n−0.3\n    33010\n33010\n38.2\n0.6\n37.5\n0.5\n    33011\n33011\n46.4\n1.4\n36.1\n0.4\n    33012\n33012\n32.9\n0.1\n31.9\n0.0\n    34004\n34004\n34.6\n0.2\n34.8\n0.2\n    34005\n34005\n40.9\n0.9\n38.3\n0.6\n    34007\n34007\n43.8\n1.2\n38.5\n0.6\n    35002\n35002\n14.5\n−1.8\n21.4\n−1.1\n    35003\n35003\n21.7\n−1.1\n26.0\n−0.6\n    35004\n35004\n29.2\n−0.3\n23.5\n−0.9\n    35005\n35005\n25.9\n−0.7\n25.4\n−0.7\n    35006\n35006\n29.1\n−0.3\n25.1\n−0.7\n    35007\n35007\n26.2\n−0.6\n26.5\n−0.6\n    36001\n36001\n39.0\n0.7\n35.5\n0.3\n    36002\n36002\n40.9\n0.9\n37.2\n0.5\n    37002\n37002\n32.0\n0.0\n31.1\n−0.1\n    37003\n37003\n30.1\n−0.2\n34.4\n0.2\n    37004\n37004\n29.9\n−0.3\n29.4\n−0.3\n    37005\n37005\n26.8\n−0.6\n32.4\n0.0\n    38004\n38004\n28.6\n−0.4\n28.7\n−0.4\n    38005\n38005\n27.3\n−0.5\n29.8\n−0.3\n    38006\n38006\n43.6\n1.1\n35.1\n0.3\n    38007\n38007\n41.8\n1.0\n35.1\n0.3\n    38008\n38008\n37.9\n0.6\n37.4\n0.5\n    38009\n38009\n31.0\n−0.1\n30.2\n−0.2\n    38010\n38010\n38.2\n0.6\n34.9\n0.3\n    39001\n39001\n33.6\n0.1\n37.6\n0.5\n    39002\n39002\n32.3\n0.0\n34.2\n0.2\n    39003\n39003\n37.8\n0.6\n35.3\n0.3\n    40001\n40001\n32.8\n0.0\n33.7\n0.1\n    40002\n40002\n27.8\n−0.5\n29.4\n−0.3\n    40003\n40003\n31.6\n−0.1\n29.3\n−0.3\n    41001\n41001\n32.1\n0.0\n37.2\n0.5\n    41002\n41002\n41.9\n1.0\n34.5\n0.2\n    41003\n41003\n37.8\n0.6\n34.8\n0.2\n    42003\n42003\n36.7\n0.4\n32.2\n0.0\n    42004\n42004\n38.6\n0.6\n35.4\n0.3\n    42005\n42005\n38.8\n0.6\n35.5\n0.3\n    42006\n42006\n38.4\n0.6\n34.7\n0.2\n    43001\n43001\n39.6\n0.7\n35.6\n0.3\n    43002\n43002\n35.4\n0.3\n33.2\n0.1\n    44006\n44006\n30.5\n−0.2\n25.5\n−0.7\n    44007\n44007\n28.7\n−0.4\n30.0\n−0.2\n    44008\n44008\n27.1\n−0.5\n26.5\n−0.6\n    44009\n44009\n29.5\n−0.3\n24.8\n−0.8\n    44010\n44010\n23.8\n−0.9\n23.4\n−0.9\n    45003\n45003\n39.5\n0.7\n36.6\n0.4\n    45004\n45004\n45.6\n1.3\n37.1\n0.5\n    45005\n45005\n40.9\n0.9\n36.3\n0.4\n    46001\n46001\n27.4\n−0.5\n34.8\n0.2\n    46002\n46002\n25.8\n−0.7\n31.5\n−0.1\n    47001\n47001\n36.8\n0.5\n37.5\n0.5\n    47002\n47002\n40.9\n0.9\n35.6\n0.3\n    47003\n47003\n38.4\n0.6\n36.1\n0.4\n    48001\n48001\n31.9\n0.0\n32.5\n0.0\n    49005\n49005\n27.1\n−0.5\n27.5\n−0.5\n    49007\n49007\n24.4\n−0.8\n26.6\n−0.6\n    50001\n50001\n33.6\n0.1\n31.1\n−0.1\n    50002\n50002\n30.1\n−0.2\n33.0\n0.1\n    50003\n50003\n32.3\n0.0\n30.8\n−0.2\n    50004\n50004\n28.9\n−0.3\n32.9\n0.1\n    51001\n51001\n35.9\n0.4\n42.7\n1.0\n    51002\n51002\n36.6\n0.4\n42.4\n1.0\n    51003\n51003\n39.6\n0.7\n43.4\n1.1\n    51004\n51004\n38.1\n0.6\n43.2\n1.1\n    51005\n51005\n49.5\n1.7\n44.3\n1.2\n    52001\n52001\n42.5\n1.0\n43.6\n1.1\n    52002\n52002\n52.8\n2.1\n46.1\n1.4\n    53001\n53001\n29.0\n−0.3\n31.8\n−0.1\n    53002\n53002\n28.0\n−0.4\n29.8\n−0.3\n    53003\n53003\n32.2\n0.0\n29.3\n−0.3\n    54003\n54003\n41.4\n0.9\n41.8\n1.0\n    54004\n54004\n43.1\n1.1\n37.6\n0.5\n    54005\n54005\n40.7\n0.8\n39.4\n0.7\n    54006\n54006\n42.0\n1.0\n37.2\n0.5\n    55001\n55001\n46.0\n1.4\n44.9\n1.3\n    55002\n55002\n46.1\n1.4\n42.8\n1.1\n    56001\n56001\n22.2\n−1.0\n31.3\n−0.1\n    56002\n56002\n27.0\n−0.5\n29.7\n−0.3\n    56003\n56003\n34.4\n0.2\n29.5\n−0.3\n    56004\n56004\n32.5\n0.0\n28.6\n−0.4\n    56006\n56006\n32.4\n0.0\n29.2\n−0.3\n    57003\n57003\n33.1\n0.1\n40.2\n0.8\n    57004\n57004\n46.6\n1.4\n39.4\n0.7\n    57005\n57005\n45.5\n1.3\n44.0\n1.2\n    57007\n57007\n48.6\n1.6\n40.5\n0.8\n    57008\n57008\n43.0\n1.1\n36.4\n0.4\n    57009\n57009\n34.7\n0.2\n41.6\n0.9\n    58001\n58001\n37.9\n0.6\n39.0\n0.7\n    58002\n58002\n39.8\n0.8\n38.8\n0.7\n    59015\n59015\n41.6\n0.9\n43.6\n1.1\n    59021\n59021\n41.9\n1.0\n50.5\n1.8\n    60001\n60001\n48.7\n1.6\n44.4\n1.2\n    60002\n60002\n48.8\n1.7\n41.4\n0.9\n    60003\n60003\n42.4\n1.0\n37.4\n0.5\n    60004\n60004\n36.4\n0.4\n38.4\n0.6\n    60005\n60005\n41.2\n0.9\n45.0\n1.3\n    60006\n60006\n43.6\n1.1\n47.7\n1.6\n    60007\n60007\n42.2\n1.0\n43.5\n1.1\n    61001\n61001\n33.4\n0.1\n33.8\n0.1\n    61002\n61002\n39.1\n0.7\n38.9\n0.7\n    61003\n61003\n36.2\n0.4\n35.1\n0.3\n    62001\n62001\n48.8\n1.7\n46.8\n1.5\n    62002\n62002\n36.0\n0.4\n52.4\n2.0\n    62004\n62004\n39.1\n0.7\n45.8\n1.4\n    62005\n62005\n41.9\n1.0\n42.8\n1.1\n    62006\n62006\n46.5\n1.4\n46.5\n1.4\n    62007\n62007\n48.4\n1.6\n45.2\n1.3\n    62008\n62008\n45.4\n1.3\n47.0\n1.5\n    62009\n62009\n45.2\n1.3\n44.2\n1.2\n    62010\n62010\n57.6\n2.6\n46.2\n1.4\n    62012\n62012\n55.5\n2.3\n46.4\n1.4\n    63002\n63002\n33.0\n0.1\n32.5\n0.0\n    63003\n63003\n24.0\n−0.8\n31.9\n0.0\n    63004\n63004\n28.7\n−0.4\n30.6\n−0.2\n    63005\n63005\n35.9\n0.4\n34.5\n0.2\n    64002\n64002\n27.8\n−0.5\n27.7\n−0.5\n    64003\n64003\n28.3\n−0.4\n28.0\n−0.4\n    64004\n64004\n24.1\n−0.8\n27.1\n−0.5\n    64005\n64005\n24.0\n−0.8\n26.8\n−0.6\n    64006\n64006\n22.1\n−1.0\n24.1\n−0.8\n    65001\n65001\n30.6\n−0.2\n33.2\n0.1\n    65002\n65002\n33.3\n0.1\n28.2\n−0.4\n    66002\n66002\n47.4\n1.5\n41.1\n0.9\n    66003\n66003\n39.9\n0.8\n39.9\n0.8\n    66004\n66004\n42.5\n1.0\n43.1\n1.1\n    67004\n67004\n29.9\n−0.2\n28.7\n−0.4\n    67005\n67005\n36.9\n0.5\n36.3\n0.4\n    67006\n67006\n36.9\n0.5\n40.4\n0.8\n    67007\n67007\n39.9\n0.8\n39.7\n0.7\n    67008\n67008\n41.7\n0.9\n40.9\n0.9\n    67009\n67009\n37.4\n0.5\n32.5\n0.0\n    68002\n68002\n33.9\n0.2\n39.4\n0.7\n    68003\n68003\n37.3\n0.5\n36.1\n0.4\n    68004\n68004\n42.2\n1.0\n34.6\n0.2\n    69008\n69008\n30.5\n−0.2\n26.3\n−0.6\n    69009\n69009\n34.3\n0.2\n34.0\n0.2\n    69010\n69010\n27.6\n−0.5\n32.4\n0.0\n    69011\n69011\n34.4\n0.2\n32.0\n0.0\n    69012\n69012\n22.1\n−1.0\n26.6\n−0.6\n    69013\n69013\n34.0\n0.2\n34.2\n0.2\n    70001\n70001\n44.5\n1.2\n37.2\n0.5\n    70002\n70002\n47.1\n1.5\n38.4\n0.6\n    71001\n71001\n31.1\n−0.1\n38.3\n0.6\n    38003\n38003\n18.4\n−1.4\n25.9\n−0.6\n    57001\n57001\n36.2\n0.4\n38.3\n0.6\n    59004\n59004\n22.9\n−0.9\n25.9\n−0.7\n    59013\n59013\n41.2\n0.9\n43.9\n1.2\n    59014\n59014\n43.9\n1.2\n44.6\n1.2\n    63001\n63001\n27.2\n−0.5\n30.4\n−0.2\n    66001\n66001\n41.9\n1.0\n43.3\n1.1\n    67001\n67001\n14.2\n−1.8\n21.9\n−1.1\n    68005\n68005\n29.1\n−0.3\n38.2\n0.6\n    69014\n69014\n26.8\n−0.6\n21.8\n−1.1\n    06003\n06003\n34.6\n0.2\n37.8\n0.6\n    31001\n31001\n17.6\n−1.5\n24.1\n−0.8\n    33001\n33001\n15.9\n−1.7\n26.4\n−0.6\n    54001\n54001\n25.1\n−0.7\n38.1\n0.6\n    59001\n59001\n20.6\n−1.2\n25.3\n−0.7\n    59019\n59019\n53.1\n2.1\n48.1\n1.6\n    62003\n62003\n52.2\n2.0\n48.7\n1.6\n    62011\n62011\n54.5\n2.2\n43.2\n1.1\n    69001\n69001\n13.5\n−1.9\n21.3\n−1.1\n    69003\n69003\n13.5\n−1.9\n17.8\n−1.5\n    71002\n71002\n38.2\n0.6\n36.7\n0.4\n    71003\n71003\n39.5\n0.7\n39.1\n0.7\n    71004\n71004\n41.1\n0.9\n36.6\n0.4\n    71005\n71005\n38.1\n0.6\n37.5\n0.5\n    72001\n72001\n33.4\n0.1\n32.5\n0.0\n    72002\n72002\n32.9\n0.1\n36.4\n0.4\n    72003\n72003\n40.9\n0.9\n34.0\n0.2\n    72004\n72004\n34.9\n0.3\n34.1\n0.2\n    72005\n72005\n36.5\n0.4\n36.4\n0.4\n    73001\n73001\n31.8\n0.0\n29.3\n−0.3\n    73002\n73002\n34.4\n0.2\n29.6\n−0.3\n    73003\n73003\n35.4\n0.3\n29.4\n−0.3\n    73004\n73004\n25.2\n−0.7\n31.8\n0.0\n    74001\n74001\n27.2\n−0.5\n29.9\n−0.2\n    74002\n74002\n25.8\n−0.7\n30.8\n−0.2\n    74003\n74003\n34.0\n0.2\n28.7\n−0.4\n    74004\n74004\n28.1\n−0.4\n30.2\n−0.2\n    74005\n74005\n30.3\n−0.2\n31.4\n−0.1\n    74006\n74006\n32.0\n0.0\n31.1\n−0.1\n    76002\n76002\n32.2\n0.0\n38.3\n0.6\n    76004\n76004\n39.1\n0.7\n33.7\n0.1\n    76005\n76005\n40.9\n0.9\n36.7\n0.4\n    76006\n76006\n44.9\n1.3\n43.4\n1.1\n    76009\n76009\n42.8\n1.1\n38.0\n0.6\n    76010\n76010\n43.6\n1.1\n40.2\n0.8\n    77001\n77001\n30.1\n−0.2\n33.5\n0.1\n    77002\n77002\n30.7\n−0.2\n39.4\n0.7\n    77003\n77003\n37.1\n0.5\n37.3\n0.5\n    77004\n77004\n46.0\n1.4\n38.9\n0.7\n    77005\n77005\n38.7\n0.6\n39.9\n0.8\n    77006\n77006\n39.1\n0.7\n36.8\n0.5\n    77007\n77007\n34.4\n0.2\n28.9\n−0.3\n    77008\n77008\n26.5\n−0.6\n35.8\n0.4\n    77009\n77009\n34.4\n0.2\n29.1\n−0.3\n    78002\n78002\n15.5\n−1.7\n18.3\n−1.4\n    78006\n78006\n16.8\n−1.6\n20.5\n−1.2\n    78007\n78007\n23.5\n−0.9\n26.3\n−0.6\n    78008\n78008\n30.1\n−0.2\n29.0\n−0.3\n    78009\n78009\n32.0\n0.0\n32.0\n0.0\n    78010\n78010\n23.8\n−0.9\n28.1\n−0.4\n    78012\n78012\n22.4\n−1.0\n22.4\n−1.0\n    79001\n79001\n23.4\n−0.9\n34.1\n0.2\n    79002\n79002\n32.2\n0.0\n32.3\n0.0\n    79003\n79003\n34.1\n0.2\n31.3\n−0.1\n    80001\n80001\n37.3\n0.5\n40.1\n0.8\n    80003\n80003\n46.1\n1.4\n40.7\n0.8\n    80004\n80004\n46.1\n1.4\n44.2\n1.2\n    80005\n80005\n51.8\n2.0\n48.4\n1.6\n    81001\n81001\n33.2\n0.1\n33.3\n0.1\n    81002\n81002\n32.5\n0.0\n31.5\n−0.1\n    81003\n81003\n35.8\n0.4\n31.2\n−0.1\n    82001\n82001\n35.1\n0.3\n32.0\n0.0\n    82002\n82002\n42.4\n1.0\n33.2\n0.1\n    83004\n83004\n45.5\n1.3\n44.0\n1.2\n    83005\n83005\n45.0\n1.3\n42.8\n1.1\n    83006\n83006\n46.4\n1.4\n40.8\n0.9\n    83008\n83008\n44.2\n1.2\n39.3\n0.7\n    84002\n84002\n39.7\n0.7\n37.5\n0.5\n    84004\n84004\n44.1\n1.2\n38.8\n0.6\n    84005\n84005\n37.9\n0.6\n37.9\n0.6\n    85001\n85001\n31.0\n−0.1\n29.5\n−0.3\n    85003\n85003\n33.5\n0.1\n31.1\n−0.1\n    85004\n85004\n27.8\n−0.5\n30.8\n−0.2\n    85005\n85005\n36.0\n0.4\n30.3\n−0.2\n    86003\n86003\n35.3\n0.3\n32.9\n0.1\n    86004\n86004\n39.4\n0.7\n32.4\n0.0\n    87002\n87002\n32.3\n0.0\n33.7\n0.1\n    88001\n88001\n39.7\n0.7\n43.6\n1.1\n    88002\n88002\n45.9\n1.4\n37.9\n0.6\n    88003\n88003\n36.9\n0.5\n40.6\n0.8\n    88004\n88004\n45.1\n1.3\n44.6\n1.2\n    89001\n89001\n36.8\n0.5\n42.4\n1.0\n    89002\n89002\n42.0\n1.0\n40.8\n0.9\n    89003\n89003\n45.2\n1.3\n40.4\n0.8\n    90001\n90001\n39.2\n0.7\n38.6\n0.6\n    90002\n90002\n34.6\n0.2\n41.0\n0.9\n    91002\n91002\n37.3\n0.5\n31.9\n0.0\n    91003\n91003\n30.4\n−0.2\n30.4\n−0.2\n    91004\n91004\n27.5\n−0.5\n22.0\n−1.0\n    91005\n91005\n13.6\n−1.9\n18.2\n−1.4\n    91009\n91009\n27.4\n−0.5\n28.3\n−0.4\n    92013\n92013\n12.6\n−2.0\n15.5\n−1.7\n    93004\n93004\n18.5\n−1.4\n19.6\n−1.3\n    93008\n93008\n22.5\n−1.0\n17.6\n−1.5\n    94003\n94003\n27.3\n−0.5\n24.5\n−0.8\n    94004\n94004\n25.0\n−0.7\n23.5\n−0.9\n    95001\n95001\n31.6\n−0.1\n33.8\n0.2\n    95006\n95006\n20.7\n−1.2\n19.7\n−1.3\n    95007\n95007\n26.4\n−0.6\n22.8\n−1.0\n    95009\n95009\n31.5\n−0.1\n25.6\n−0.7\n    29002\n29002\n22.4\n−1.0\n25.2\n−0.7\n    35008\n35008\n14.8\n−1.8\n20.3\n−1.2\n    59011\n59011\n27.9\n−0.4\n33.6\n0.1\n    59018\n59018\n52.0\n2.0\n50.8\n1.9\n    06009\n06009\n37.8\n0.6\n39.0\n0.7\n    13002\n13002\n30.1\n−0.2\n30.1\n−0.2\n    25001\n25001\n27.4\n−0.5\n35.8\n0.4\n    25002\n25002\n28.0\n−0.4\n38.4\n0.6\n    28001\n28001\n33.0\n0.1\n35.2\n0.3\n    31009\n31009\n20.4\n−1.2\n22.5\n−1.0\n    34001\n34001\n29.5\n−0.3\n27.6\n−0.5\n    34002\n34002\n16.7\n−1.6\n30.4\n−0.2\n    34003\n34003\n26.1\n−0.6\n33.4\n0.1\n    34008\n34008\n33.1\n0.1\n30.1\n−0.2\n    34009\n34009\n33.1\n0.1\n29.7\n−0.3\n    35001\n35001\n15.7\n−1.7\n21.1\n−1.1\n    44005\n44005\n19.3\n−1.3\n20.3\n−1.2\n    49001\n49001\n23.5\n−0.9\n26.8\n−0.6\n    49002\n49002\n21.2\n−1.1\n28.8\n−0.4\n    49003\n49003\n35.2\n0.3\n29.8\n−0.3\n    49006\n49006\n25.3\n−0.7\n24.3\n−0.8\n    59012\n59012\n50.8\n1.9\n50.3\n1.8\n    68006\n68006\n35.2\n0.3\n36.2\n0.4\n    76007\n76007\n29.7\n−0.3\n37.1\n0.5\n    76008\n76008\n31.4\n−0.1\n36.3\n0.4\n    83002\n83002\n41.4\n0.9\n41.4\n0.9\n    86001\n86001\n25.6\n−0.7\n32.5\n0.0\n    86002\n86002\n23.1\n−0.9\n31.0\n−0.1\n    92001\n92001\n13.3\n−1.9\n13.7\n−1.9\n    92003\n92003\n14.0\n−1.9\n13.1\n−1.9\n    92011\n92011\n11.9\n−2.1\n13.5\n−1.9\n    93001\n93001\n11.2\n−2.1\n14.2\n−1.8\n    93006\n93006\n10.2\n−2.2\n15.5\n−1.7\n    93010\n93010\n20.2\n−1.2\n22.0\n−1.0\n    94001\n94001\n17.2\n−1.5\n20.8\n−1.2\n    94006\n94006\n11.5\n−2.1\n17.4\n−1.5\n    94008\n94008\n17.1\n−1.5\n16.5\n−1.6\n    94009\n94009\n17.0\n−1.6\n16.1\n−1.6\n    94010\n94010\n13.6\n−1.9\n15.7\n−1.7\n    94011\n94011\n13.1\n−1.9\n14.9\n−1.8\n    45006\n45006\n29.2\n−0.3\n36.4\n0.4\n    06008\n06008\n38.6\n0.6\n40.0\n0.8\n    10003\n10003\n41.9\n1.0\n45.1\n1.3\n    13003\n13003\n30.1\n−0.2\n32.7\n0.0\n    13004\n13004\n30.1\n−0.2\n30.1\n−0.2\n    13005\n13005\n30.1\n−0.2\n30.1\n−0.2\n    13006\n13006\n30.1\n−0.2\n32.8\n0.0\n    13007\n13007\n30.1\n−0.2\n35.2\n0.3\n    21001\n21001\n24.4\n−0.8\n35.2\n0.3\n    21003\n21003\n31.0\n−0.1\n31.6\n−0.1\n    27001\n27001\n42.3\n1.0\n39.4\n0.7\n    27002\n27002\n42.6\n1.0\n41.7\n1.0\n    33003\n33003\n16.1\n−1.6\n25.9\n−0.6\n    33006\n33006\n24.2\n−0.8\n23.8\n−0.9\n    37001\n37001\n17.9\n−1.5\n29.7\n−0.3\n    42001\n42001\n29.2\n−0.3\n33.3\n0.1\n    42002\n42002\n24.7\n−0.8\n34.8\n0.3\n    44001\n44001\n13.9\n−1.9\n15.9\n−1.7\n    44002\n44002\n11.1\n−2.1\n18.1\n−1.4\n    44003\n44003\n17.3\n−1.5\n21.1\n−1.1\n    44004\n44004\n16.1\n−1.6\n20.4\n−1.2\n    45001\n45001\n24.9\n−0.7\n35.9\n0.4\n    45002\n45002\n30.8\n−0.2\n35.4\n0.3\n    49004\n49004\n33.0\n0.1\n30.5\n−0.2\n    54002\n54002\n20.7\n−1.2\n37.7\n0.5\n    57002\n57002\n32.1\n0.0\n39.5\n0.7\n    59003\n59003\n48.4\n1.6\n53.3\n2.1\n    64001\n64001\n25.0\n−0.7\n28.1\n−0.4\n    69005\n69005\n22.2\n−1.0\n23.9\n−0.9\n    69007\n69007\n21.9\n−1.1\n23.3\n−0.9\n    76001\n76001\n18.0\n−1.5\n34.4\n0.2\n    76003\n76003\n25.3\n−0.7\n29.8\n−0.3\n    77010\n77010\n22.5\n−1.0\n27.5\n−0.5\n    77011\n77011\n27.9\n−0.4\n32.3\n0.0\n    78001\n78001\n14.8\n−1.8\n16.4\n−1.6\n    78003\n78003\n18.1\n−1.4\n16.6\n−1.6\n    78011\n78011\n20.0\n−1.3\n18.9\n−1.4\n    80002\n80002\n28.1\n−0.4\n43.2\n1.1\n    83001\n83001\n36.8\n0.5\n40.9\n0.9\n    83007\n83007\n41.8\n1.0\n43.9\n1.2\n    84001\n84001\n31.1\n−0.1\n42.5\n1.0\n    84003\n84003\n46.4\n1.4\n38.7\n0.6\n    85002\n85002\n32.7\n0.0\n32.1\n0.0\n    87001\n87001\n30.6\n−0.2\n32.7\n0.0\n    87003\n87003\n31.7\n−0.1\n35.3\n0.3\n    91007\n91007\n25.8\n−0.7\n23.5\n−0.9\n    91008\n91008\n24.7\n−0.8\n26.8\n−0.6\n    91010\n91010\n25.7\n−0.7\n26.9\n−0.5\n    92002\n92002\n11.5\n−2.1\n12.9\n−2.0\n    92004\n92004\n13.4\n−1.9\n15.0\n−1.8\n    92005\n92005\n13.0\n−2.0\n12.8\n−2.0\n    92006\n92006\n14.4\n−1.8\n13.5\n−1.9\n    92008\n92008\n12.1\n−2.0\n14.6\n−1.8\n    92010\n92010\n11.9\n−2.1\n12.9\n−2.0\n    93002\n93002\n12.3\n−2.0\n17.4\n−1.5\n    93005\n93005\n22.2\n−1.0\n14.0\n−1.9\n    93007\n93007\n8.7\n−2.4\n15.8\n−1.7\n    93009\n93009\n13.3\n−1.9\n17.1\n−1.5\n    93011\n93011\n20.1\n−1.2\n28.1\n−0.4\n    93012\n93012\n26.2\n−0.6\n23.9\n−0.8\n    94002\n94002\n17.4\n−1.5\n20.6\n−1.2\n    94007\n94007\n19.3\n−1.3\n17.5\n−1.5\n    95002\n95002\n28.2\n−0.4\n30.2\n−0.2\n    95003\n95003\n26.7\n−0.6\n21.7\n−1.1\n    95004\n95004\n23.4\n−0.9\n24.6\n−0.8\n    95008\n95008\n20.9\n−1.2\n25.5\n−0.7\n    95010\n95010\n22.8\n−1.0\n27.8\n−0.5\n    68001\n68001\n35.1\n0.3\n37.7\n0.5\n    94005\n94005\n17.4\n−1.5\n18.4\n−1.4\n    59007\n59007\n25.7\n−0.7\n25.9\n−0.6"
  },
  {
    "objectID": "autocor.html#indice-et-diagramme-de-moran-1",
    "href": "autocor.html#indice-et-diagramme-de-moran-1",
    "title": "Autocorrélation spatiale",
    "section": "Indice et diagramme de Moran",
    "text": "Indice et diagramme de Moran\n\n\n\n    Moran I test under randomisation\n\ndata:  sel$Y  \nweights: map_nb_w    \n\nMoran I statistic standard deviate = 26.255, p-value &lt; 2.2e-16\nalternative hypothesis: two.sided\nsample estimates:\nMoran I statistic       Expectation          Variance \n     0.7284488328     -0.0019379845      0.0007739103"
  },
  {
    "objectID": "autocor.html#calcul-des-lisa-1",
    "href": "autocor.html#calcul-des-lisa-1",
    "title": "Autocorrélation spatiale",
    "section": "Calcul des LISA",
    "text": "Calcul des LISA\n\n\n\n\n\n\n  \n    \n      Indices locaux d’autocorrélation spatiale\n    \n    \n    \n      code\n      nom\n      Y\n      Y_std\n      Y_lag\n      Y_std_lag\n      Ii\n      E.Ii\n      Var.Ii\n      Z.Ii\n      Pr.z....E.Ii..\n    \n  \n  \n    33004\n33004\n30.57\n−0.18\n28.62\n−0.38\n0.07\n0.00\n0.00\n1.00\n0.32\n    38001\n38001\n15.17\n−1.73\n24.46\n−0.80\n1.38\n−0.01\n1.00\n1.39\n0.16\n    59010\n59010\n34.88\n0.26\n25.39\n−0.70\n−0.18\n0.00\n0.02\n−1.22\n0.22\n    33007\n33007\n19.96\n−1.25\n23.82\n−0.86\n1.08\n0.00\n0.31\n1.94\n0.05\n    01001\n01001\n37.80\n0.55\n37.06\n0.48\n0.26\n0.00\n0.06\n1.07\n0.28\n    01002\n01002\n36.74\n0.44\n33.64\n0.13\n0.06\n0.00\n0.03\n0.35\n0.72\n    01003\n01003\n27.55\n−0.48\n35.54\n0.32\n−0.16\n0.00\n0.04\n−0.79\n0.43\n    01004\n01004\n40.34\n0.81\n35.81\n0.35\n0.28\n0.00\n0.13\n0.79\n0.43\n    01005\n01005\n39.13\n0.69\n35.99\n0.37\n0.25\n0.00\n0.07\n0.99\n0.32\n    02001\n02001\n50.21\n1.81\n46.00\n1.38\n2.50\n−0.01\n0.46\n3.70\n0.00\n    02002\n02002\n48.96\n1.68\n52.15\n2.00\n3.37\n−0.01\n0.56\n4.51\n0.00\n    02003\n02003\n55.87\n2.38\n49.35\n1.72\n4.10\n−0.01\n0.93\n4.27\n0.00\n    02004\n02004\n50.86\n1.87\n47.33\n1.52\n2.84\n−0.01\n0.58\n3.75\n0.00\n    02005\n02005\n48.16\n1.60\n42.08\n0.98\n1.58\n0.00\n0.28\n2.99\n0.00\n    03001\n03001\n36.50\n0.42\n38.40\n0.61\n0.26\n0.00\n0.04\n1.38\n0.17\n    03002\n03002\n37.79\n0.55\n36.24\n0.39\n0.22\n0.00\n0.06\n0.89\n0.37\n    03003\n03003\n35.84\n0.35\n36.69\n0.44\n0.16\n0.00\n0.02\n1.08\n0.28\n    04001\n04001\n38.50\n0.62\n39.57\n0.73\n0.46\n0.00\n0.13\n1.27\n0.20\n    04002\n04002\n34.26\n0.19\n35.87\n0.36\n0.07\n0.00\n0.00\n1.02\n0.31\n    05001\n05001\n32.56\n0.02\n30.03\n−0.23\n−0.01\n0.00\n0.00\n−0.47\n0.64\n    05002\n05002\n29.44\n−0.29\n32.70\n0.04\n−0.01\n0.00\n0.02\n−0.07\n0.94\n    06002\n06002\n40.23\n0.80\n38.03\n0.58\n0.46\n0.00\n0.09\n1.54\n0.12\n    06004\n06004\n44.87\n1.27\n34.40\n0.21\n0.27\n0.00\n0.53\n0.37\n0.71\n    06005\n06005\n36.30\n0.40\n38.10\n0.58\n0.23\n0.00\n0.03\n1.43\n0.15\n    06006\n06006\n42.31\n1.01\n36.44\n0.41\n0.42\n0.00\n0.34\n0.72\n0.47\n    06007\n06007\n32.79\n0.05\n39.74\n0.75\n0.03\n0.00\n0.00\n1.50\n0.13\n    07001\n07001\n36.60\n0.43\n38.85\n0.66\n0.28\n0.00\n0.03\n1.62\n0.10\n    07002\n07002\n35.49\n0.32\n37.47\n0.52\n0.17\n0.00\n0.01\n1.38\n0.17\n    07003\n07003\n32.02\n−0.03\n37.13\n0.48\n−0.02\n0.00\n0.00\n−1.19\n0.23\n    08001\n08001\n45.72\n1.35\n45.36\n1.32\n1.78\n0.00\n0.30\n3.25\n0.00\n    08002\n08002\n45.78\n1.36\n46.03\n1.38\n1.88\n0.00\n0.92\n1.97\n0.05\n    08003\n08003\n46.34\n1.41\n43.93\n1.17\n1.66\n0.00\n0.50\n2.36\n0.02\n    09001\n09001\n30.74\n−0.16\n36.78\n0.45\n−0.07\n0.00\n0.01\n−0.90\n0.37\n    09002\n09002\n34.21\n0.19\n32.60\n0.03\n0.01\n0.00\n0.01\n0.06\n0.95\n    10001\n10001\n47.38\n1.52\n44.85\n1.26\n1.92\n0.00\n0.38\n3.13\n0.00\n    10002\n10002\n43.06\n1.08\n43.14\n1.09\n1.18\n0.00\n0.23\n2.46\n0.01\n    11001\n11001\n42.38\n1.01\n40.77\n0.85\n0.87\n0.00\n0.20\n1.92\n0.06\n    11002\n11002\n42.68\n1.05\n44.01\n1.18\n1.24\n0.00\n0.27\n2.37\n0.02\n    11003\n11003\n37.07\n0.48\n36.49\n0.42\n0.20\n0.00\n0.03\n1.12\n0.26\n    12001\n12001\n27.52\n−0.49\n31.32\n−0.10\n0.05\n0.00\n0.05\n0.23\n0.82\n    12002\n12002\n28.33\n−0.40\n30.76\n−0.16\n0.06\n0.00\n0.02\n0.43\n0.67\n    12003\n12003\n28.75\n−0.36\n33.24\n0.09\n−0.03\n0.00\n0.02\n−0.24\n0.81\n    13008\n13008\n41.34\n0.91\n41.60\n0.94\n0.85\n0.00\n0.21\n1.88\n0.06\n    13009\n13009\n40.68\n0.84\n37.58\n0.53\n0.45\n0.00\n0.18\n1.07\n0.29\n    13010\n13010\n43.62\n1.14\n34.72\n0.24\n0.27\n0.00\n0.21\n0.60\n0.55\n    13011\n13011\n32.09\n−0.02\n37.98\n0.57\n−0.01\n0.00\n0.00\n−1.52\n0.13\n    13012\n13012\n48.54\n1.64\n36.94\n0.47\n0.76\n−0.01\n0.67\n0.94\n0.35\n    13013\n13013\n44.18\n1.20\n45.55\n1.33\n1.60\n0.00\n0.72\n1.90\n0.06\n    13014\n13014\n28.85\n−0.35\n41.02\n0.88\n−0.31\n0.00\n0.02\n−2.33\n0.02\n    13015\n13015\n43.21\n1.10\n36.61\n0.43\n0.48\n0.00\n0.17\n1.16\n0.25\n    13016\n13016\n42.55\n1.03\n42.62\n1.04\n1.07\n0.00\n0.18\n2.56\n0.01\n    14001\n14001\n20.65\n−1.18\n29.03\n−0.33\n0.40\n0.00\n0.46\n0.58\n0.56\n    14002\n14002\n23.02\n−0.94\n31.17\n−0.12\n0.11\n0.00\n0.18\n0.27\n0.79\n    14003\n14003\n38.76\n0.65\n34.86\n0.26\n0.17\n0.00\n0.07\n0.63\n0.53\n    14004\n14004\n32.38\n0.00\n34.06\n0.17\n0.00\n0.00\n0.00\n0.35\n0.73\n    14005\n14005\n30.04\n−0.23\n28.73\n−0.36\n0.08\n0.00\n0.01\n0.82\n0.41\n    14006\n14006\n34.02\n0.17\n30.34\n−0.20\n−0.03\n0.00\n0.00\n−0.54\n0.59\n    15001\n15001\n32.41\n0.01\n30.08\n−0.23\n0.00\n0.00\n0.00\n−0.51\n0.61\n    15002\n15002\n35.19\n0.29\n30.92\n−0.14\n−0.04\n0.00\n0.01\n−0.38\n0.70\n    16001\n16001\n28.96\n−0.34\n38.08\n0.58\n−0.20\n0.00\n0.06\n−0.82\n0.41\n    16002\n16002\n37.10\n0.48\n35.69\n0.34\n0.16\n0.00\n0.05\n0.76\n0.45\n    16003\n16003\n39.06\n0.68\n33.61\n0.13\n0.09\n0.00\n0.06\n0.37\n0.71\n    17001\n17001\n21.15\n−1.13\n31.30\n−0.10\n0.12\n0.00\n1.28\n0.11\n0.91\n    17002\n17002\n31.30\n−0.10\n32.72\n0.04\n0.00\n0.00\n0.00\n−0.09\n0.93\n    17003\n17003\n35.70\n0.34\n36.19\n0.39\n0.13\n0.00\n0.02\n0.96\n0.34\n    17004\n17004\n38.98\n0.67\n38.69\n0.64\n0.43\n0.00\n0.09\n1.44\n0.15\n    17005\n17005\n38.51\n0.62\n35.33\n0.30\n0.19\n0.00\n0.13\n0.53\n0.60\n    18001\n18001\n36.46\n0.42\n39.23\n0.70\n0.29\n0.00\n0.03\n1.57\n0.12\n    18002\n18002\n36.43\n0.41\n39.93\n0.77\n0.32\n0.00\n0.04\n1.54\n0.12\n    18003\n18003\n40.41\n0.82\n37.65\n0.54\n0.44\n0.00\n0.08\n1.53\n0.13\n    19001\n19001\n31.64\n−0.07\n32.00\n−0.03\n0.00\n0.00\n0.00\n0.09\n0.93\n    19002\n19002\n33.54\n0.12\n32.20\n−0.01\n0.00\n0.00\n0.00\n−0.04\n0.97\n    21002\n21002\n32.38\n0.00\n36.81\n0.45\n0.00\n0.00\n0.00\n1.20\n0.23\n    21004\n21004\n39.31\n0.71\n38.69\n0.64\n0.45\n0.00\n0.06\n1.83\n0.07\n    21005\n21005\n38.11\n0.58\n35.66\n0.34\n0.20\n0.00\n0.04\n0.96\n0.34\n    22001\n22001\n25.17\n−0.72\n29.65\n−0.27\n0.20\n0.00\n0.17\n0.47\n0.64\n    22002\n22002\n28.70\n−0.37\n27.08\n−0.53\n0.20\n0.00\n0.05\n0.92\n0.36\n    22003\n22003\n33.33\n0.10\n29.43\n−0.29\n−0.03\n0.00\n0.00\n−0.78\n0.43\n    22004\n22004\n31.06\n−0.13\n27.86\n−0.45\n0.06\n0.00\n0.00\n1.11\n0.27\n    22005\n22005\n24.55\n−0.79\n28.12\n−0.43\n0.34\n0.00\n0.31\n0.61\n0.54\n    23001\n23001\n35.40\n0.31\n35.64\n0.33\n0.10\n0.00\n0.01\n0.95\n0.34\n    24001\n24001\n34.58\n0.23\n37.78\n0.55\n0.12\n0.00\n0.01\n1.10\n0.27\n    24002\n24002\n36.66\n0.44\n38.47\n0.62\n0.27\n0.00\n0.03\n1.53\n0.13\n    24003\n24003\n35.74\n0.34\n36.78\n0.45\n0.15\n0.00\n0.01\n1.28\n0.20\n    24004\n24004\n32.30\n0.00\n33.17\n0.08\n0.00\n0.00\n0.00\n−0.22\n0.82\n    25003\n25003\n40.17\n0.79\n37.32\n0.50\n0.40\n0.00\n0.12\n1.13\n0.26\n    25004\n25004\n44.04\n1.18\n37.99\n0.57\n0.68\n0.00\n0.46\n1.00\n0.32\n    25005\n25005\n32.85\n0.05\n33.13\n0.08\n0.00\n0.00\n0.00\n0.18\n0.86\n    26001\n26001\n29.16\n−0.32\n34.95\n0.26\n−0.08\n0.00\n0.03\n−0.53\n0.60\n    26002\n26002\n38.90\n0.66\n34.64\n0.23\n0.15\n0.00\n0.09\n0.53\n0.60\n    26003\n26003\n27.86\n−0.45\n34.88\n0.26\n−0.12\n0.00\n0.02\n−0.77\n0.44\n    26004\n26004\n37.53\n0.52\n33.07\n0.07\n0.04\n0.00\n0.05\n0.17\n0.87\n    27003\n27003\n44.43\n1.22\n39.60\n0.73\n0.90\n0.00\n0.18\n2.10\n0.04\n    27004\n27004\n41.10\n0.89\n40.57\n0.83\n0.74\n0.00\n0.13\n2.05\n0.04\n    27005\n27005\n42.75\n1.05\n38.01\n0.57\n0.60\n0.00\n0.18\n1.42\n0.16\n    34006\n34006\n45.40\n1.32\n42.45\n1.02\n1.35\n0.00\n0.58\n1.78\n0.07\n    38002\n38002\n27.67\n−0.47\n22.36\n−1.01\n0.48\n0.00\n0.06\n2.02\n0.04\n    56005\n56005\n23.96\n−0.85\n32.43\n0.01\n−0.01\n0.00\n0.72\n−0.01\n0.99\n    57006\n57006\n47.70\n1.55\n46.91\n1.47\n2.29\n0.00\n0.80\n2.57\n0.01\n    59005\n59005\n37.36\n0.51\n36.31\n0.40\n0.20\n0.00\n0.04\n1.07\n0.28\n    59006\n59006\n32.08\n−0.03\n40.00\n0.77\n−0.02\n0.00\n0.00\n−2.06\n0.04\n    59016\n59016\n50.33\n1.82\n44.73\n1.25\n2.28\n−0.01\n0.82\n2.53\n0.01\n    59017\n59017\n46.05\n1.39\n46.69\n1.45\n2.01\n0.00\n0.27\n3.87\n0.00\n    59020\n59020\n47.64\n1.55\n44.36\n1.22\n1.88\n0.00\n0.59\n2.45\n0.01\n    78004\n78004\n15.94\n−1.66\n16.13\n−1.64\n2.72\n−0.01\n0.45\n4.05\n0.00\n    78005\n78005\n16.23\n−1.63\n19.46\n−1.30\n2.12\n−0.01\n0.66\n2.62\n0.01\n    83003\n83003\n40.50\n0.83\n42.53\n1.03\n0.85\n0.00\n0.17\n2.07\n0.04\n    91001\n91001\n23.65\n−0.88\n30.20\n−0.22\n0.19\n0.00\n0.19\n0.44\n0.66\n    91006\n91006\n19.16\n−1.33\n19.75\n−1.27\n1.70\n0.00\n0.35\n2.87\n0.00\n    92007\n92007\n13.89\n−1.86\n14.23\n−1.83\n3.42\n−0.01\n0.69\n4.13\n0.00\n    92012\n92012\n16.18\n−1.63\n12.92\n−1.96\n3.21\n−0.01\n0.44\n4.85\n0.00\n    93003\n93003\n21.04\n−1.14\n22.21\n−1.02\n1.17\n0.00\n0.22\n2.53\n0.01\n    06001\n06001\n32.28\n−0.01\n38.60\n0.63\n0.00\n0.00\n0.00\n−1.10\n0.27\n    31002\n31002\n21.04\n−1.14\n25.36\n−0.71\n0.81\n0.00\n0.22\n1.74\n0.08\n    31003\n31003\n17.37\n−1.51\n23.17\n−0.93\n1.40\n0.00\n0.45\n2.09\n0.04\n    33002\n33002\n12.79\n−1.98\n21.36\n−1.11\n2.20\n−0.01\n0.77\n2.51\n0.01\n    59008\n59008\n33.17\n0.08\n26.90\n−0.55\n−0.05\n0.00\n0.00\n−0.95\n0.34\n    59009\n59009\n20.08\n−1.24\n25.95\n−0.65\n0.80\n0.00\n0.25\n1.60\n0.11\n    67003\n67003\n18.59\n−1.39\n24.64\n−0.78\n1.08\n0.00\n0.48\n1.57\n0.12\n    69006\n69006\n16.74\n−1.58\n19.19\n−1.33\n2.10\n0.00\n0.82\n2.32\n0.02\n    95005\n95005\n18.34\n−1.41\n16.80\n−1.57\n2.22\n0.00\n0.28\n4.19\n0.00\n    13001\n13001\n30.14\n−0.22\n34.94\n0.26\n−0.06\n0.00\n0.01\n−0.59\n0.55\n    30001\n30001\n39.87\n0.76\n40.82\n0.86\n0.65\n0.00\n0.10\n2.12\n0.03\n    30006\n30006\n36.04\n0.37\n41.17\n0.89\n0.33\n0.00\n0.05\n1.55\n0.12\n    31004\n31004\n13.56\n−1.90\n22.83\n−0.96\n1.83\n−0.01\n0.59\n2.38\n0.02\n    59002\n59002\n18.35\n−1.41\n27.18\n−0.52\n0.74\n0.00\n0.40\n1.18\n0.24\n    67002\n67002\n17.05\n−1.54\n20.90\n−1.16\n1.79\n0.00\n0.79\n2.02\n0.04\n    69002\n69002\n13.46\n−1.91\n18.61\n−1.39\n2.65\n−0.01\n0.72\n3.13\n0.00\n    69004\n69004\n13.46\n−1.91\n19.09\n−1.34\n2.56\n−0.01\n0.60\n3.31\n0.00\n    92009\n92009\n11.63\n−2.09\n12.63\n−1.99\n4.17\n−0.01\n1.45\n3.48\n0.00\n    28002\n28002\n38.75\n0.65\n36.78\n0.45\n0.29\n0.00\n0.08\n1.01\n0.31\n    28003\n28003\n37.39\n0.51\n38.23\n0.60\n0.30\n0.00\n0.04\n1.47\n0.14\n    28004\n28004\n44.26\n1.20\n33.93\n0.16\n0.19\n0.00\n0.18\n0.47\n0.64\n    29001\n29001\n21.79\n−1.07\n26.28\n−0.61\n0.65\n0.00\n0.38\n1.07\n0.29\n    29003\n29003\n24.66\n−0.78\n24.06\n−0.84\n0.65\n0.00\n0.30\n1.19\n0.24\n    29004\n29004\n24.79\n−0.76\n27.89\n−0.45\n0.34\n0.00\n0.19\n0.78\n0.43\n    29005\n29005\n25.73\n−0.67\n24.69\n−0.77\n0.52\n0.00\n0.11\n1.55\n0.12\n    29006\n29006\n26.89\n−0.55\n26.82\n−0.56\n0.31\n0.00\n0.04\n1.49\n0.14\n    29007\n29007\n23.97\n−0.85\n24.34\n−0.81\n0.68\n0.00\n0.36\n1.15\n0.25\n    29008\n29008\n27.96\n−0.44\n27.04\n−0.54\n0.24\n0.00\n0.07\n0.93\n0.35\n    30002\n30002\n46.46\n1.43\n35.58\n0.33\n0.47\n0.00\n0.40\n0.74\n0.46\n    30003\n30003\n40.63\n0.84\n40.79\n0.85\n0.72\n0.00\n0.09\n2.44\n0.01\n    30004\n30004\n43.00\n1.08\n37.93\n0.57\n0.61\n0.00\n0.16\n1.51\n0.13\n    30005\n30005\n36.25\n0.40\n35.34\n0.30\n0.12\n0.00\n0.02\n0.87\n0.39\n    31005\n31005\n35.26\n0.30\n29.18\n−0.32\n−0.09\n0.00\n0.01\n−0.79\n0.43\n    31006\n31006\n26.37\n−0.60\n30.28\n−0.21\n0.13\n0.00\n0.05\n0.60\n0.55\n    31007\n31007\n34.18\n0.19\n25.92\n−0.65\n−0.12\n0.00\n0.01\n−1.59\n0.11\n    31008\n31008\n35.97\n0.37\n31.07\n−0.13\n−0.05\n0.00\n0.02\n−0.31\n0.75\n    31010\n31010\n25.03\n−0.74\n29.85\n−0.25\n0.19\n0.00\n0.09\n0.62\n0.53\n    32001\n32001\n30.32\n−0.20\n31.30\n−0.11\n0.02\n0.00\n0.01\n0.28\n0.78\n    32002\n32002\n32.93\n0.06\n33.38\n0.11\n0.01\n0.00\n0.00\n0.26\n0.80\n    33005\n33005\n37.99\n0.57\n29.92\n−0.24\n−0.14\n0.00\n0.06\n−0.54\n0.59\n    33008\n33008\n32.51\n0.02\n29.68\n−0.27\n0.00\n0.00\n0.00\n−0.60\n0.55\n    33009\n33009\n33.45\n0.11\n29.20\n−0.32\n−0.04\n0.00\n0.00\n−0.78\n0.44\n    33010\n33010\n38.20\n0.59\n37.50\n0.52\n0.31\n0.00\n0.07\n1.17\n0.24\n    33011\n33011\n46.41\n1.42\n36.10\n0.38\n0.54\n0.00\n0.29\n1.02\n0.31\n    33012\n33012\n32.93\n0.06\n31.85\n−0.05\n0.00\n0.00\n0.00\n−0.11\n0.91\n    34004\n34004\n34.60\n0.23\n34.81\n0.25\n0.06\n0.00\n0.01\n0.62\n0.54\n    34005\n34005\n40.87\n0.86\n38.33\n0.61\n0.52\n0.00\n0.09\n1.73\n0.08\n    34007\n34007\n43.79\n1.16\n38.48\n0.62\n0.72\n0.00\n0.33\n1.25\n0.21\n    35002\n35002\n14.51\n−1.80\n21.43\n−1.10\n1.99\n−0.01\n0.64\n2.49\n0.01\n    35003\n35003\n21.73\n−1.07\n26.03\n−0.64\n0.68\n0.00\n0.14\n1.82\n0.07\n    35004\n35004\n29.17\n−0.32\n23.51\n−0.89\n0.29\n0.00\n0.02\n2.20\n0.03\n    35005\n35005\n25.90\n−0.65\n25.45\n−0.70\n0.45\n0.00\n0.05\n1.99\n0.05\n    35006\n35006\n29.06\n−0.33\n25.10\n−0.73\n0.24\n0.00\n0.02\n1.80\n0.07\n    35007\n35007\n26.17\n−0.62\n26.50\n−0.59\n0.37\n0.00\n0.13\n1.03\n0.30\n    36001\n36001\n39.04\n0.68\n35.46\n0.32\n0.21\n0.00\n0.08\n0.78\n0.44\n    36002\n36002\n40.94\n0.87\n37.21\n0.49\n0.43\n0.00\n0.13\n1.22\n0.22\n    37002\n37002\n32.00\n−0.03\n31.09\n−0.13\n0.00\n0.00\n0.00\n0.31\n0.76\n    37003\n37003\n30.07\n−0.23\n34.43\n0.21\n−0.05\n0.00\n0.01\n−0.56\n0.57\n    37004\n37004\n29.85\n−0.25\n29.43\n−0.29\n0.07\n0.00\n0.01\n0.66\n0.51\n    37005\n37005\n26.78\n−0.56\n32.38\n0.00\n0.00\n0.00\n0.04\n−0.01\n0.99\n    38004\n38004\n28.55\n−0.38\n28.71\n−0.37\n0.14\n0.00\n0.02\n1.05\n0.30\n    38005\n38005\n27.27\n−0.51\n29.79\n−0.26\n0.13\n0.00\n0.03\n0.78\n0.44\n    38006\n38006\n43.63\n1.14\n35.12\n0.28\n0.32\n0.00\n0.26\n0.64\n0.52\n    38007\n38007\n41.85\n0.96\n35.14\n0.28\n0.27\n0.00\n0.13\n0.76\n0.45\n    38008\n38008\n37.85\n0.56\n37.41\n0.51\n0.29\n0.00\n0.06\n1.15\n0.25\n    38009\n38009\n30.98\n−0.14\n30.25\n−0.21\n0.03\n0.00\n0.00\n0.52\n0.60\n    38010\n38010\n38.20\n0.59\n34.86\n0.25\n0.15\n0.00\n0.05\n0.68\n0.50\n    39001\n39001\n33.58\n0.13\n37.63\n0.54\n0.07\n0.00\n0.00\n1.20\n0.23\n    39002\n39002\n32.29\n−0.01\n34.19\n0.19\n0.00\n0.00\n0.00\n−0.42\n0.67\n    39003\n39003\n37.83\n0.56\n35.28\n0.30\n0.17\n0.00\n0.04\n0.85\n0.40\n    40001\n40001\n32.78\n0.04\n33.71\n0.14\n0.01\n0.00\n0.00\n0.37\n0.71\n    40002\n40002\n27.76\n−0.46\n29.43\n−0.29\n0.14\n0.00\n0.07\n0.51\n0.61\n    40003\n40003\n31.55\n−0.08\n29.35\n−0.30\n0.02\n0.00\n0.00\n0.74\n0.46\n    41001\n41001\n32.07\n−0.03\n37.24\n0.50\n−0.01\n0.00\n0.00\n−0.86\n0.39\n    41002\n41002\n41.91\n0.97\n34.47\n0.22\n0.21\n0.00\n0.10\n0.66\n0.51\n    41003\n41003\n37.80\n0.55\n34.76\n0.24\n0.14\n0.00\n0.03\n0.79\n0.43\n    42003\n42003\n36.72\n0.44\n32.15\n−0.02\n−0.01\n0.00\n0.03\n−0.04\n0.97\n    42004\n42004\n38.62\n0.63\n35.41\n0.31\n0.20\n0.00\n0.04\n1.04\n0.30\n    42005\n42005\n38.76\n0.65\n35.51\n0.32\n0.21\n0.00\n0.07\n0.79\n0.43\n    42006\n42006\n38.42\n0.61\n34.69\n0.24\n0.15\n0.00\n0.06\n0.59\n0.56\n    43001\n43001\n39.59\n0.73\n35.63\n0.33\n0.24\n0.00\n0.11\n0.75\n0.45\n    43002\n43002\n35.40\n0.31\n33.24\n0.09\n0.03\n0.00\n0.01\n0.26\n0.79\n    44006\n44006\n30.48\n−0.19\n25.51\n−0.69\n0.13\n0.00\n0.00\n2.09\n0.04\n    44007\n44007\n28.73\n−0.36\n30.02\n−0.23\n0.09\n0.00\n0.04\n0.41\n0.68\n    44008\n44008\n27.07\n−0.53\n26.50\n−0.59\n0.31\n0.00\n0.07\n1.19\n0.24\n    44009\n44009\n29.51\n−0.29\n24.80\n−0.76\n0.22\n0.00\n0.01\n1.88\n0.06\n    44010\n44010\n23.77\n−0.87\n23.40\n−0.90\n0.78\n0.00\n0.09\n2.58\n0.01\n    45003\n45003\n39.55\n0.73\n36.57\n0.43\n0.31\n0.00\n0.07\n1.22\n0.22\n    45004\n45004\n45.55\n1.34\n37.08\n0.48\n0.64\n0.00\n0.29\n1.19\n0.24\n    45005\n45005\n40.94\n0.87\n36.33\n0.40\n0.35\n0.00\n0.13\n1.00\n0.32\n    46001\n46001\n27.42\n−0.50\n34.81\n0.25\n−0.12\n0.00\n0.05\n−0.56\n0.58\n    46002\n46002\n25.82\n−0.66\n31.52\n−0.08\n0.05\n0.00\n0.07\n0.21\n0.84\n    47001\n47001\n36.84\n0.45\n37.49\n0.52\n0.24\n0.00\n0.04\n1.17\n0.24\n    47002\n47002\n40.90\n0.87\n35.61\n0.33\n0.29\n0.00\n0.11\n0.88\n0.38\n    47003\n47003\n38.40\n0.61\n36.09\n0.38\n0.23\n0.00\n0.06\n0.94\n0.35\n    48001\n48001\n31.93\n−0.04\n32.52\n0.02\n0.00\n0.00\n0.00\n−0.05\n0.96\n    49005\n49005\n27.13\n−0.53\n27.53\n−0.49\n0.26\n0.00\n0.05\n1.20\n0.23\n    49007\n49007\n24.43\n−0.80\n26.63\n−0.58\n0.46\n0.00\n0.13\n1.30\n0.19\n    50001\n50001\n33.60\n0.13\n31.06\n−0.13\n−0.02\n0.00\n0.00\n−0.29\n0.77\n    50002\n50002\n30.07\n−0.23\n32.98\n0.06\n−0.01\n0.00\n0.01\n−0.17\n0.86\n    50003\n50003\n32.28\n−0.01\n30.85\n−0.15\n0.00\n0.00\n0.00\n0.26\n0.79\n    50004\n50004\n28.88\n−0.35\n32.94\n0.06\n−0.02\n0.00\n0.06\n−0.09\n0.93\n    51001\n51001\n35.87\n0.36\n42.66\n1.04\n0.37\n0.00\n0.03\n2.09\n0.04\n    51002\n51002\n36.58\n0.43\n42.39\n1.02\n0.44\n0.00\n0.04\n2.28\n0.02\n    51003\n51003\n39.62\n0.74\n43.37\n1.11\n0.82\n0.00\n0.09\n2.75\n0.01\n    51004\n51004\n38.12\n0.58\n43.22\n1.10\n0.64\n0.00\n0.04\n3.13\n0.00\n    51005\n51005\n49.51\n1.73\n44.30\n1.21\n2.10\n−0.01\n0.50\n2.99\n0.00\n    52001\n52001\n42.50\n1.03\n43.59\n1.14\n1.17\n0.00\n0.17\n2.81\n0.01\n    52002\n52002\n52.85\n2.07\n46.08\n1.39\n2.88\n−0.01\n0.85\n3.14\n0.00\n    53001\n53001\n29.02\n−0.34\n31.76\n−0.06\n0.02\n0.00\n0.03\n0.12\n0.91\n    53002\n53002\n28.03\n−0.44\n29.80\n−0.26\n0.11\n0.00\n0.02\n0.73\n0.46\n    53003\n53003\n32.20\n−0.01\n29.25\n−0.31\n0.00\n0.00\n0.00\n0.77\n0.44\n    54003\n54003\n41.40\n0.92\n41.84\n0.96\n0.88\n0.00\n0.21\n1.93\n0.05\n    54004\n54004\n43.09\n1.09\n37.59\n0.53\n0.58\n0.00\n0.15\n1.52\n0.13\n    54005\n54005\n40.73\n0.85\n39.37\n0.71\n0.60\n0.00\n0.14\n1.60\n0.11\n    54006\n54006\n42.02\n0.98\n37.22\n0.49\n0.48\n0.00\n0.10\n1.50\n0.13\n    55001\n55001\n45.96\n1.38\n44.91\n1.27\n1.75\n0.00\n0.27\n3.40\n0.00\n    55002\n55002\n46.12\n1.39\n42.77\n1.05\n1.47\n0.00\n0.39\n2.38\n0.02\n    56001\n56001\n22.18\n−1.03\n31.30\n−0.10\n0.11\n0.00\n0.35\n0.18\n0.85\n    56002\n56002\n27.02\n−0.54\n29.67\n−0.27\n0.15\n0.00\n0.10\n0.47\n0.64\n    56003\n56003\n34.39\n0.21\n29.49\n−0.29\n−0.06\n0.00\n0.01\n−0.64\n0.52\n    56004\n56004\n32.50\n0.02\n28.57\n−0.38\n−0.01\n0.00\n0.00\n−1.01\n0.31\n    56006\n56006\n32.43\n0.01\n29.23\n−0.31\n0.00\n0.00\n0.00\n−0.84\n0.40\n    57003\n57003\n33.07\n0.07\n40.22\n0.80\n0.06\n0.00\n0.00\n1.96\n0.05\n    57004\n57004\n46.63\n1.44\n39.40\n0.71\n1.03\n0.00\n0.21\n2.29\n0.02\n    57005\n57005\n45.46\n1.33\n43.99\n1.18\n1.56\n0.00\n0.44\n2.37\n0.02\n    57007\n57007\n48.64\n1.65\n40.53\n0.83\n1.37\n−0.01\n0.67\n1.67\n0.09\n    57008\n57008\n42.96\n1.07\n36.36\n0.41\n0.44\n0.00\n0.29\n0.82\n0.41\n    57009\n57009\n34.72\n0.24\n41.56\n0.93\n0.23\n0.00\n0.02\n1.62\n0.11\n    58001\n58001\n37.85\n0.56\n39.05\n0.68\n0.38\n0.00\n0.08\n1.36\n0.17\n    58002\n58002\n39.78\n0.75\n38.82\n0.66\n0.49\n0.00\n0.06\n2.10\n0.04\n    59015\n59015\n41.62\n0.94\n43.60\n1.14\n1.07\n0.00\n0.18\n2.56\n0.01\n    59021\n59021\n41.91\n0.97\n50.52\n1.84\n1.78\n0.00\n0.31\n3.19\n0.00\n    60001\n60001\n48.66\n1.65\n44.38\n1.22\n2.01\n−0.01\n0.54\n2.75\n0.01\n    60002\n60002\n48.78\n1.66\n41.36\n0.91\n1.52\n−0.01\n0.34\n2.61\n0.01\n    60003\n60003\n42.42\n1.02\n37.43\n0.51\n0.53\n0.00\n0.21\n1.16\n0.25\n    60004\n60004\n36.41\n0.41\n38.41\n0.61\n0.25\n0.00\n0.02\n1.75\n0.08\n    60005\n60005\n41.22\n0.90\n44.98\n1.28\n1.15\n0.00\n0.13\n3.15\n0.00\n    60006\n60006\n43.59\n1.14\n47.74\n1.56\n1.77\n0.00\n0.26\n3.50\n0.00\n    60007\n60007\n42.21\n1.00\n43.50\n1.13\n1.13\n0.00\n0.20\n2.54\n0.01\n    61001\n61001\n33.44\n0.11\n33.78\n0.15\n0.02\n0.00\n0.00\n0.39\n0.70\n    61002\n61002\n39.10\n0.68\n38.93\n0.67\n0.46\n0.00\n0.05\n2.02\n0.04\n    61003\n61003\n36.23\n0.39\n35.08\n0.28\n0.11\n0.00\n0.03\n0.62\n0.53\n    62001\n62001\n48.80\n1.66\n46.81\n1.46\n2.44\n−0.01\n0.30\n4.44\n0.00\n    62002\n62002\n35.99\n0.37\n52.44\n2.03\n0.75\n0.00\n0.02\n5.00\n0.00\n    62004\n62004\n39.11\n0.68\n45.81\n1.36\n0.93\n0.00\n0.12\n2.73\n0.01\n    62005\n62005\n41.87\n0.96\n42.79\n1.06\n1.02\n0.00\n0.46\n1.50\n0.13\n    62006\n62006\n46.47\n1.43\n46.46\n1.43\n2.04\n0.00\n0.29\n3.81\n0.00\n    62007\n62007\n48.41\n1.62\n45.19\n1.30\n2.11\n−0.01\n1.31\n1.85\n0.06\n    62008\n62008\n45.45\n1.32\n46.98\n1.48\n1.96\n0.00\n0.35\n3.33\n0.00\n    62009\n62009\n45.25\n1.30\n44.24\n1.20\n1.57\n0.00\n0.28\n2.97\n0.00\n    62010\n62010\n57.65\n2.56\n46.24\n1.40\n3.60\n−0.01\n1.07\n3.49\n0.00\n    62012\n62012\n55.47\n2.34\n46.36\n1.42\n3.32\n−0.01\n0.77\n3.80\n0.00\n    63002\n63002\n33.04\n0.07\n32.53\n0.02\n0.00\n0.00\n0.00\n0.05\n0.96\n    63003\n63003\n23.97\n−0.85\n31.85\n−0.05\n0.04\n0.00\n0.12\n0.12\n0.90\n    63004\n63004\n28.69\n−0.37\n30.61\n−0.17\n0.06\n0.00\n0.03\n0.35\n0.72\n    63005\n63005\n35.90\n0.36\n34.49\n0.22\n0.08\n0.00\n0.02\n0.62\n0.53\n    64002\n64002\n27.82\n−0.46\n27.70\n−0.47\n0.21\n0.00\n0.05\n0.94\n0.35\n    64003\n64003\n28.32\n−0.41\n28.02\n−0.44\n0.18\n0.00\n0.02\n1.16\n0.24\n    64004\n64004\n24.14\n−0.83\n27.10\n−0.53\n0.44\n0.00\n0.14\n1.19\n0.23\n    64005\n64005\n23.97\n−0.85\n26.77\n−0.56\n0.48\n0.00\n0.14\n1.27\n0.21\n    64006\n64006\n22.08\n−1.04\n24.06\n−0.84\n0.87\n0.00\n0.54\n1.19\n0.23\n    65001\n65001\n30.62\n−0.17\n33.20\n0.09\n−0.02\n0.00\n0.01\n−0.15\n0.88\n    65002\n65002\n33.31\n0.10\n28.25\n−0.41\n−0.04\n0.00\n0.00\n−0.93\n0.35\n    66002\n66002\n47.37\n1.52\n41.07\n0.88\n1.34\n0.00\n0.38\n2.18\n0.03\n    66003\n66003\n39.88\n0.76\n39.92\n0.77\n0.59\n0.00\n0.12\n1.72\n0.08\n    66004\n66004\n42.51\n1.03\n43.05\n1.08\n1.12\n0.00\n0.35\n1.88\n0.06\n    67004\n67004\n29.94\n−0.24\n28.71\n−0.37\n0.09\n0.00\n0.01\n0.98\n0.33\n    67005\n67005\n36.94\n0.47\n36.35\n0.41\n0.19\n0.00\n0.04\n0.91\n0.36\n    67006\n67006\n36.91\n0.46\n40.39\n0.81\n0.38\n0.00\n0.04\n2.01\n0.04\n    67007\n67007\n39.89\n0.76\n39.68\n0.74\n0.57\n0.00\n0.10\n1.83\n0.07\n    67008\n67008\n41.73\n0.95\n40.92\n0.87\n0.83\n0.00\n0.30\n1.51\n0.13\n    67009\n67009\n37.42\n0.51\n32.54\n0.02\n0.01\n0.00\n0.07\n0.04\n0.97\n    68002\n68002\n33.91\n0.16\n39.42\n0.72\n0.11\n0.00\n0.01\n1.61\n0.11\n    68003\n68003\n37.27\n0.50\n36.07\n0.38\n0.19\n0.00\n0.05\n0.85\n0.40\n    68004\n68004\n42.22\n1.00\n34.60\n0.23\n0.23\n0.00\n0.14\n0.61\n0.54\n    69008\n69008\n30.48\n−0.19\n26.29\n−0.61\n0.12\n0.00\n0.00\n1.74\n0.08\n    69009\n69009\n34.27\n0.20\n33.97\n0.16\n0.03\n0.00\n0.01\n0.44\n0.66\n    69010\n69010\n27.63\n−0.48\n32.42\n0.01\n0.00\n0.00\n0.04\n−0.02\n0.99\n    69011\n69011\n34.39\n0.21\n31.96\n−0.04\n−0.01\n0.00\n0.01\n−0.10\n0.92\n    69012\n69012\n22.12\n−1.03\n26.55\n−0.58\n0.60\n0.00\n0.21\n1.32\n0.19\n    69013\n69013\n33.99\n0.17\n34.22\n0.19\n0.03\n0.00\n0.00\n0.51\n0.61\n    70001\n70001\n44.54\n1.23\n37.18\n0.49\n0.60\n0.00\n0.21\n1.31\n0.19\n    70002\n70002\n47.07\n1.49\n38.43\n0.62\n0.92\n0.00\n0.31\n1.65\n0.10\n    71001\n71001\n31.12\n−0.12\n38.30\n0.60\n−0.07\n0.00\n0.00\n−1.48\n0.14\n    38003\n38003\n18.43\n−1.41\n25.93\n−0.65\n0.91\n0.00\n0.39\n1.46\n0.14\n    57001\n57001\n36.25\n0.40\n38.31\n0.60\n0.24\n0.00\n0.03\n1.36\n0.18\n    59004\n59004\n22.94\n−0.95\n25.87\n−0.65\n0.62\n0.00\n0.22\n1.31\n0.19\n    59013\n59013\n41.16\n0.89\n43.90\n1.17\n1.04\n0.00\n0.80\n1.17\n0.24\n    59014\n59014\n43.90\n1.17\n44.62\n1.24\n1.45\n0.00\n0.27\n2.80\n0.01\n    63001\n63001\n27.16\n−0.52\n30.40\n−0.20\n0.10\n0.00\n0.07\n0.39\n0.69\n    66001\n66001\n41.90\n0.97\n43.26\n1.10\n1.07\n0.00\n0.31\n1.92\n0.05\n    67001\n67001\n14.16\n−1.84\n21.86\n−1.06\n1.95\n−0.01\n1.12\n1.85\n0.06\n    68005\n68005\n29.12\n−0.33\n38.23\n0.60\n−0.19\n0.00\n0.04\n−1.03\n0.30\n    69014\n69014\n26.81\n−0.56\n21.83\n−1.06\n0.59\n0.00\n0.04\n2.83\n0.00\n    06003\n06003\n34.64\n0.23\n37.82\n0.55\n0.13\n0.00\n0.02\n0.96\n0.34\n    31001\n31001\n17.61\n−1.49\n24.06\n−0.84\n1.25\n0.00\n0.55\n1.69\n0.09\n    33001\n33001\n15.91\n−1.66\n26.39\n−0.60\n1.00\n−0.01\n0.68\n1.21\n0.22\n    54001\n54001\n25.10\n−0.73\n38.12\n0.58\n−0.43\n0.00\n0.13\n−1.17\n0.24\n    59001\n59001\n20.62\n−1.18\n25.33\n−0.71\n0.84\n0.00\n0.28\n1.60\n0.11\n    59019\n59019\n53.13\n2.10\n48.11\n1.59\n3.36\n−0.01\n0.72\n3.95\n0.00\n    62003\n62003\n52.18\n2.01\n48.66\n1.65\n3.31\n−0.01\n1.33\n2.88\n0.00\n    62011\n62011\n54.50\n2.24\n43.19\n1.10\n2.46\n−0.01\n0.82\n2.72\n0.01\n    69001\n69001\n13.46\n−1.91\n21.26\n−1.12\n2.14\n−0.01\n0.72\n2.53\n0.01\n    69003\n69003\n13.46\n−1.91\n17.82\n−1.47\n2.80\n−0.01\n0.72\n3.31\n0.00\n    71002\n71002\n38.16\n0.59\n36.74\n0.45\n0.26\n0.00\n0.04\n1.27\n0.20\n    71003\n71003\n39.53\n0.73\n39.06\n0.68\n0.49\n0.00\n0.11\n1.53\n0.13\n    71004\n71004\n41.11\n0.89\n36.59\n0.43\n0.38\n0.00\n0.11\n1.15\n0.25\n    71005\n71005\n38.14\n0.59\n37.48\n0.52\n0.31\n0.00\n0.09\n1.05\n0.30\n    72001\n72001\n33.36\n0.10\n32.46\n0.01\n0.00\n0.00\n0.00\n0.03\n0.97\n    72002\n72002\n32.94\n0.06\n36.41\n0.41\n0.03\n0.00\n0.00\n0.83\n0.41\n    72003\n72003\n40.94\n0.87\n34.01\n0.17\n0.15\n0.00\n0.12\n0.42\n0.67\n    72004\n72004\n34.86\n0.26\n34.08\n0.18\n0.05\n0.00\n0.01\n0.40\n0.69\n    72005\n72005\n36.50\n0.42\n36.42\n0.41\n0.17\n0.00\n0.03\n1.10\n0.27\n    73001\n73001\n31.85\n−0.05\n29.34\n−0.30\n0.02\n0.00\n0.00\n0.86\n0.39\n    73002\n73002\n34.36\n0.20\n29.59\n−0.28\n−0.06\n0.00\n0.01\n−0.56\n0.58\n    73003\n73003\n35.44\n0.31\n29.44\n−0.29\n−0.09\n0.00\n0.02\n−0.72\n0.47\n    73004\n73004\n25.16\n−0.72\n31.85\n−0.05\n0.04\n0.00\n0.13\n0.10\n0.92\n    74001\n74001\n27.20\n−0.52\n29.94\n−0.24\n0.13\n0.00\n0.07\n0.49\n0.63\n    74002\n74002\n25.75\n−0.67\n30.77\n−0.16\n0.11\n0.00\n0.07\n0.39\n0.69\n    74003\n74003\n34.03\n0.17\n28.68\n−0.37\n−0.06\n0.00\n0.01\n−0.83\n0.41\n    74004\n74004\n28.14\n−0.42\n30.18\n−0.22\n0.09\n0.00\n0.04\n0.49\n0.62\n    74005\n74005\n30.30\n−0.21\n31.40\n−0.09\n0.02\n0.00\n0.01\n0.17\n0.87\n    74006\n74006\n32.02\n−0.03\n31.11\n−0.12\n0.00\n0.00\n0.00\n0.25\n0.80\n    76002\n76002\n32.21\n−0.01\n38.28\n0.60\n−0.01\n0.00\n0.00\n−1.82\n0.07\n    76004\n76004\n39.13\n0.69\n33.66\n0.13\n0.09\n0.00\n0.08\n0.33\n0.74\n    76005\n76005\n40.93\n0.87\n36.71\n0.44\n0.38\n0.00\n0.12\n1.09\n0.28\n    76006\n76006\n44.92\n1.27\n43.37\n1.11\n1.42\n0.00\n0.32\n2.51\n0.01\n    76009\n76009\n42.85\n1.06\n38.03\n0.58\n0.61\n0.00\n0.22\n1.30\n0.19\n    76010\n76010\n43.64\n1.14\n40.23\n0.80\n0.91\n0.00\n0.32\n1.61\n0.11\n    77001\n77001\n30.13\n−0.22\n33.50\n0.12\n−0.03\n0.00\n0.01\n−0.26\n0.79\n    77002\n77002\n30.73\n−0.16\n39.38\n0.71\n−0.12\n0.00\n0.00\n−1.75\n0.08\n    77003\n77003\n37.14\n0.49\n37.29\n0.50\n0.24\n0.00\n0.05\n1.12\n0.26\n    77004\n77004\n46.01\n1.38\n38.94\n0.67\n0.92\n0.00\n0.24\n1.91\n0.06\n    77005\n77005\n38.68\n0.64\n39.94\n0.77\n0.49\n0.00\n0.10\n1.54\n0.12\n    77006\n77006\n39.10\n0.68\n36.83\n0.45\n0.31\n0.00\n0.09\n1.02\n0.31\n    77007\n77007\n34.40\n0.21\n28.91\n−0.35\n−0.07\n0.00\n0.01\n−0.92\n0.36\n    77008\n77008\n26.51\n−0.59\n35.84\n0.35\n−0.21\n0.00\n0.06\n−0.87\n0.38\n    77009\n77009\n34.38\n0.21\n29.09\n−0.33\n−0.07\n0.00\n0.00\n−1.05\n0.30\n    78002\n78002\n15.48\n−1.70\n18.27\n−1.42\n2.43\n−0.01\n0.41\n3.80\n0.00\n    78006\n78006\n16.83\n−1.57\n20.48\n−1.20\n1.88\n0.00\n0.41\n2.96\n0.00\n    78007\n78007\n23.53\n−0.89\n26.33\n−0.61\n0.54\n0.00\n0.10\n1.73\n0.08\n    78008\n78008\n30.10\n−0.23\n29.04\n−0.33\n0.08\n0.00\n0.02\n0.58\n0.56\n    78009\n78009\n32.05\n−0.03\n32.02\n−0.03\n0.00\n0.00\n0.00\n0.10\n0.92\n    78010\n78010\n23.78\n−0.87\n28.12\n−0.43\n0.37\n0.00\n0.09\n1.22\n0.22\n    78012\n78012\n22.37\n−1.01\n22.37\n−1.01\n1.02\n0.00\n0.17\n2.49\n0.01\n    79001\n79001\n23.41\n−0.90\n34.12\n0.18\n−0.16\n0.00\n0.27\n−0.31\n0.76\n    79002\n79002\n32.19\n−0.01\n32.30\n0.00\n0.00\n0.00\n0.00\n0.01\n0.99\n    79003\n79003\n34.11\n0.18\n31.28\n−0.11\n−0.02\n0.00\n0.00\n−0.28\n0.78\n    80001\n80001\n37.25\n0.50\n40.11\n0.79\n0.39\n0.00\n0.08\n1.37\n0.17\n    80003\n80003\n46.08\n1.39\n40.72\n0.85\n1.18\n0.00\n0.32\n2.10\n0.04\n    80004\n80004\n46.12\n1.39\n44.23\n1.20\n1.68\n0.00\n0.21\n3.65\n0.00\n    80005\n80005\n51.85\n1.97\n48.38\n1.62\n3.20\n−0.01\n0.64\n4.02\n0.00\n    81001\n81001\n33.20\n0.09\n33.26\n0.09\n0.01\n0.00\n0.00\n0.21\n0.83\n    81002\n81002\n32.53\n0.02\n31.46\n−0.09\n0.00\n0.00\n0.00\n−0.22\n0.83\n    81003\n81003\n35.83\n0.35\n31.19\n−0.12\n−0.04\n0.00\n0.02\n−0.33\n0.74\n    82001\n82001\n35.09\n0.28\n31.96\n−0.04\n−0.01\n0.00\n0.01\n−0.09\n0.93\n    82002\n82002\n42.42\n1.02\n33.19\n0.09\n0.09\n0.00\n0.15\n0.23\n0.82\n    83004\n83004\n45.52\n1.33\n44.04\n1.18\n1.58\n0.00\n0.44\n2.38\n0.02\n    83005\n83005\n45.00\n1.28\n42.79\n1.06\n1.35\n0.00\n0.54\n1.84\n0.07\n    83006\n83006\n46.41\n1.42\n40.82\n0.86\n1.22\n0.00\n0.25\n2.45\n0.01\n    83008\n83008\n44.23\n1.20\n39.31\n0.70\n0.85\n0.00\n0.14\n2.26\n0.02\n    84002\n84002\n39.71\n0.74\n37.49\n0.52\n0.39\n0.00\n0.11\n1.17\n0.24\n    84004\n84004\n44.10\n1.19\n38.75\n0.65\n0.77\n0.00\n0.20\n1.73\n0.08\n    84005\n84005\n37.85\n0.56\n37.92\n0.56\n0.31\n0.00\n0.04\n1.50\n0.13\n    85001\n85001\n31.04\n−0.13\n29.47\n−0.29\n0.04\n0.00\n0.00\n0.65\n0.52\n    85003\n85003\n33.53\n0.12\n31.10\n−0.13\n−0.02\n0.00\n0.00\n−0.22\n0.83\n    85004\n85004\n27.80\n−0.46\n30.81\n−0.15\n0.07\n0.00\n0.03\n0.38\n0.70\n    85005\n85005\n36.04\n0.37\n30.26\n−0.21\n−0.08\n0.00\n0.02\n−0.51\n0.61\n    86003\n86003\n35.28\n0.30\n32.86\n0.05\n0.02\n0.00\n0.01\n0.14\n0.89\n    86004\n86004\n39.39\n0.71\n32.40\n0.01\n0.00\n0.00\n0.06\n0.02\n0.98\n    87002\n87002\n32.27\n−0.01\n33.70\n0.14\n0.00\n0.00\n0.00\n−0.34\n0.73\n    88001\n88001\n39.67\n0.74\n43.60\n1.14\n0.84\n0.00\n0.11\n2.56\n0.01\n    88002\n88002\n45.86\n1.37\n37.91\n0.56\n0.77\n0.00\n0.31\n1.39\n0.16\n    88003\n88003\n36.94\n0.47\n40.55\n0.83\n0.39\n0.00\n0.04\n2.05\n0.04\n    88004\n88004\n45.06\n1.29\n44.55\n1.23\n1.59\n0.00\n0.20\n3.53\n0.00\n    89001\n89001\n36.81\n0.45\n42.40\n1.02\n0.46\n0.00\n0.04\n2.29\n0.02\n    89002\n89002\n41.96\n0.97\n40.83\n0.86\n0.84\n0.00\n0.19\n1.93\n0.05\n    89003\n89003\n45.18\n1.30\n40.39\n0.81\n1.06\n0.00\n0.21\n2.33\n0.02\n    90001\n90001\n39.20\n0.69\n38.63\n0.64\n0.44\n0.00\n0.16\n1.11\n0.27\n    90002\n90002\n34.59\n0.23\n40.99\n0.87\n0.20\n0.00\n0.01\n2.33\n0.02\n    91002\n91002\n37.32\n0.50\n31.92\n−0.04\n−0.02\n0.00\n0.03\n−0.12\n0.91\n    91003\n91003\n30.40\n−0.20\n30.37\n−0.20\n0.04\n0.00\n0.01\n0.49\n0.62\n    91004\n91004\n27.46\n−0.49\n22.00\n−1.04\n0.52\n0.00\n0.03\n2.78\n0.01\n    91005\n91005\n13.62\n−1.89\n18.17\n−1.43\n2.71\n−0.01\n0.71\n3.23\n0.00\n    91009\n91009\n27.36\n−0.50\n28.35\n−0.40\n0.20\n0.00\n0.03\n1.15\n0.25\n    92013\n92013\n12.58\n−2.00\n15.53\n−1.70\n3.40\n−0.01\n0.66\n4.21\n0.00\n    93004\n93004\n18.49\n−1.40\n19.63\n−1.28\n1.80\n0.00\n0.24\n3.67\n0.00\n    93008\n93008\n22.52\n−0.99\n17.62\n−1.49\n1.48\n0.00\n0.14\n3.97\n0.00\n    94003\n94003\n27.29\n−0.51\n24.53\n−0.79\n0.40\n0.00\n0.04\n2.10\n0.04\n    94004\n94004\n24.99\n−0.74\n23.45\n−0.90\n0.67\n0.00\n0.11\n2.02\n0.04\n    95001\n95001\n31.56\n−0.08\n33.83\n0.15\n−0.01\n0.00\n0.00\n−0.43\n0.67\n    95006\n95006\n20.69\n−1.18\n19.72\n−1.28\n1.50\n0.00\n0.23\n3.15\n0.00\n    95007\n95007\n26.38\n−0.60\n22.78\n−0.97\n0.58\n0.00\n0.04\n2.76\n0.01\n    95009\n95009\n31.53\n−0.08\n25.63\n−0.68\n0.06\n0.00\n0.00\n1.93\n0.05\n    29002\n29002\n22.40\n−1.00\n25.20\n−0.72\n0.73\n0.00\n0.50\n1.03\n0.31\n    35008\n35008\n14.77\n−1.78\n20.28\n−1.22\n2.17\n−0.01\n0.78\n2.46\n0.01\n    59011\n59011\n27.92\n−0.45\n33.56\n0.12\n−0.06\n0.00\n0.04\n−0.28\n0.78\n    59018\n59018\n51.96\n1.98\n50.78\n1.86\n3.70\n−0.01\n0.55\n4.99\n0.00\n    06009\n06009\n37.82\n0.55\n38.96\n0.67\n0.37\n0.00\n0.08\n1.35\n0.18\n    13002\n13002\n30.14\n−0.22\n30.14\n−0.22\n0.05\n0.00\n0.02\n0.31\n0.75\n    25001\n25001\n27.35\n−0.50\n35.81\n0.35\n−0.18\n0.00\n0.06\n−0.70\n0.48\n    25002\n25002\n28.03\n−0.43\n38.40\n0.61\n−0.27\n0.00\n0.04\n−1.37\n0.17\n    28001\n28001\n33.00\n0.07\n35.24\n0.29\n0.02\n0.00\n0.00\n0.66\n0.51\n    31009\n31009\n20.41\n−1.21\n22.54\n−0.99\n1.20\n0.00\n0.36\n1.99\n0.05\n    34001\n34001\n29.47\n−0.29\n27.61\n−0.48\n0.14\n0.00\n0.03\n0.83\n0.41\n    34002\n34002\n16.68\n−1.58\n30.44\n−0.19\n0.30\n0.00\n0.62\n0.39\n0.69\n    34003\n34003\n26.12\n−0.63\n33.36\n0.10\n−0.06\n0.00\n0.07\n−0.25\n0.80\n    34008\n34008\n33.07\n0.07\n30.13\n−0.22\n−0.02\n0.00\n0.00\n−0.50\n0.62\n    34009\n34009\n33.09\n0.08\n29.68\n−0.27\n−0.02\n0.00\n0.00\n−0.54\n0.59\n    35001\n35001\n15.70\n−1.68\n21.09\n−1.14\n1.91\n−0.01\n0.70\n2.29\n0.02\n    44005\n44005\n19.27\n−1.32\n20.29\n−1.22\n1.61\n0.00\n0.29\n3.01\n0.00\n    49001\n49001\n23.47\n−0.90\n26.82\n−0.56\n0.50\n0.00\n0.16\n1.26\n0.21\n    49002\n49002\n21.22\n−1.12\n28.81\n−0.36\n0.40\n0.00\n0.25\n0.81\n0.42\n    49003\n49003\n35.16\n0.29\n29.76\n−0.26\n−0.07\n0.00\n0.01\n−0.69\n0.49\n    49006\n49006\n25.25\n−0.72\n24.25\n−0.82\n0.59\n0.00\n0.07\n2.18\n0.03\n    59012\n59012\n50.79\n1.86\n50.26\n1.81\n3.38\n−0.01\n0.69\n4.09\n0.00\n    68006\n68006\n35.21\n0.29\n36.20\n0.39\n0.11\n0.00\n0.03\n0.68\n0.50\n    76007\n76007\n29.72\n−0.26\n37.14\n0.49\n−0.13\n0.00\n0.03\n−0.69\n0.49\n    76008\n76008\n31.43\n−0.09\n36.28\n0.40\n−0.04\n0.00\n0.00\n−0.56\n0.57\n    83002\n83002\n41.37\n0.91\n41.38\n0.91\n0.84\n0.00\n0.21\n1.84\n0.07\n    86001\n86001\n25.59\n−0.68\n32.48\n0.01\n−0.01\n0.00\n0.12\n−0.03\n0.98\n    86002\n86002\n23.06\n−0.94\n31.02\n−0.13\n0.12\n0.00\n0.29\n0.23\n0.81\n    92001\n92001\n13.35\n−1.92\n13.69\n−1.88\n3.62\n−0.01\n0.73\n4.25\n0.00\n    92003\n92003\n13.95\n−1.86\n13.14\n−1.94\n3.61\n−0.01\n0.68\n4.38\n0.00\n    92011\n92011\n11.86\n−2.07\n13.45\n−1.91\n3.96\n−0.01\n1.06\n3.85\n0.00\n    93001\n93001\n11.21\n−2.13\n14.20\n−1.83\n3.92\n−0.01\n0.64\n4.91\n0.00\n    93006\n93006\n10.23\n−2.23\n15.49\n−1.70\n3.81\n−0.01\n0.98\n3.85\n0.00\n    93010\n93010\n20.17\n−1.23\n22.02\n−1.04\n1.28\n0.00\n0.25\n2.58\n0.01\n    94001\n94001\n17.17\n−1.53\n20.83\n−1.16\n1.79\n0.00\n0.47\n2.62\n0.01\n    94006\n94006\n11.46\n−2.11\n17.41\n−1.51\n3.19\n−0.01\n1.10\n3.05\n0.00\n    94008\n94008\n17.12\n−1.54\n16.49\n−1.60\n2.47\n0.00\n0.47\n3.61\n0.00\n    94009\n94009\n16.99\n−1.55\n16.08\n−1.64\n2.55\n0.00\n0.48\n3.70\n0.00\n    94010\n94010\n13.57\n−1.90\n15.74\n−1.68\n3.19\n−0.01\n1.19\n2.93\n0.00\n    94011\n94011\n13.12\n−1.94\n14.85\n−1.77\n3.44\n−0.01\n0.75\n3.99\n0.00\n    45006\n45006\n29.25\n−0.31\n36.36\n0.41\n−0.13\n0.00\n0.02\n−0.91\n0.36\n    06008\n06008\n38.61\n0.63\n39.96\n0.77\n0.49\n0.00\n0.10\n1.55\n0.12\n    10003\n10003\n41.85\n0.96\n45.12\n1.29\n1.24\n0.00\n0.15\n3.19\n0.00\n    13003\n13003\n30.14\n−0.22\n32.71\n0.04\n−0.01\n0.00\n0.01\n−0.09\n0.93\n    13004\n13004\n30.14\n−0.22\n30.14\n−0.22\n0.05\n0.00\n0.02\n0.39\n0.70\n    13005\n13005\n30.14\n−0.22\n30.14\n−0.22\n0.05\n0.00\n0.01\n0.50\n0.62\n    13006\n13006\n30.14\n−0.22\n32.78\n0.04\n−0.01\n0.00\n0.01\n−0.09\n0.93\n    13007\n13007\n30.14\n−0.22\n35.23\n0.29\n−0.06\n0.00\n0.01\n−0.59\n0.56\n    21001\n21001\n24.36\n−0.81\n35.20\n0.29\n−0.23\n0.00\n0.16\n−0.58\n0.56\n    21003\n21003\n31.00\n−0.14\n31.62\n−0.07\n0.01\n0.00\n0.01\n0.13\n0.90\n    27001\n27001\n42.35\n1.01\n39.39\n0.71\n0.72\n0.00\n0.17\n1.76\n0.08\n    27002\n27002\n42.56\n1.03\n41.74\n0.95\n0.98\n0.00\n0.27\n1.91\n0.06\n    33003\n33003\n16.13\n−1.64\n25.94\n−0.65\n1.06\n−0.01\n0.53\n1.46\n0.14\n    33006\n33006\n24.22\n−0.82\n23.83\n−0.86\n0.71\n0.00\n0.13\n1.93\n0.05\n    37001\n37001\n17.88\n−1.46\n29.68\n−0.27\n0.39\n0.00\n0.53\n0.55\n0.59\n    42001\n42001\n29.20\n−0.32\n33.33\n0.10\n−0.03\n0.00\n0.03\n−0.17\n0.86\n    42002\n42002\n24.65\n−0.78\n34.85\n0.25\n−0.20\n0.00\n0.20\n−0.44\n0.66\n    44001\n44001\n13.86\n−1.87\n15.89\n−1.66\n3.11\n−0.01\n1.15\n2.90\n0.00\n    44002\n44002\n11.12\n−2.14\n18.06\n−1.44\n3.10\n−0.01\n0.91\n3.26\n0.00\n    44003\n44003\n17.29\n−1.52\n21.06\n−1.14\n1.74\n0.00\n0.33\n3.05\n0.00\n    44004\n44004\n16.11\n−1.64\n20.42\n−1.20\n1.98\n−0.01\n0.67\n2.43\n0.02\n    45001\n45001\n24.92\n−0.75\n35.87\n0.36\n−0.27\n0.00\n0.11\n−0.80\n0.42\n    45002\n45002\n30.85\n−0.15\n35.43\n0.31\n−0.05\n0.00\n0.00\n−0.70\n0.48\n    49004\n49004\n33.02\n0.07\n30.52\n−0.18\n−0.01\n0.00\n0.00\n−0.49\n0.63\n    54002\n54002\n20.74\n−1.17\n37.73\n0.55\n−0.64\n0.00\n0.34\n−1.09\n0.28\n    57002\n57002\n32.09\n−0.03\n39.49\n0.72\n−0.02\n0.00\n0.00\n−1.45\n0.15\n    59003\n59003\n48.43\n1.63\n53.33\n2.12\n3.46\n−0.01\n1.32\n3.02\n0.00\n    64001\n64001\n25.03\n−0.74\n28.07\n−0.43\n0.32\n0.00\n0.27\n0.61\n0.54\n    69005\n69005\n22.18\n−1.03\n23.86\n−0.86\n0.88\n0.00\n0.15\n2.29\n0.02\n    69007\n69007\n21.92\n−1.05\n23.34\n−0.91\n0.96\n0.00\n0.16\n2.43\n0.02\n    76001\n76001\n17.99\n−1.45\n34.39\n0.21\n−0.30\n0.00\n0.52\n−0.41\n0.68\n    76003\n76003\n25.28\n−0.71\n29.77\n−0.26\n0.18\n0.00\n0.17\n0.45\n0.65\n    77010\n77010\n22.50\n−0.99\n27.51\n−0.49\n0.49\n0.00\n0.16\n1.21\n0.23\n    77011\n77011\n27.92\n−0.45\n32.30\n0.00\n0.00\n0.00\n0.05\n0.01\n0.99\n    78001\n78001\n14.84\n−1.77\n16.39\n−1.61\n2.85\n−0.01\n0.77\n3.25\n0.00\n    78003\n78003\n18.08\n−1.44\n16.56\n−1.59\n2.30\n0.00\n0.29\n4.26\n0.00\n    78011\n78011\n19.96\n−1.25\n18.91\n−1.36\n1.70\n0.00\n0.31\n3.06\n0.00\n    80002\n80002\n28.14\n−0.42\n43.15\n1.09\n−0.46\n0.00\n0.06\n−1.90\n0.06\n    83001\n83001\n36.82\n0.45\n40.93\n0.87\n0.39\n0.00\n0.10\n1.23\n0.22\n    83007\n83007\n41.80\n0.96\n43.89\n1.17\n1.12\n0.00\n0.46\n1.66\n0.10\n    84001\n84001\n31.12\n−0.12\n42.49\n1.03\n−0.13\n0.00\n0.00\n−2.06\n0.04\n    84003\n84003\n46.41\n1.42\n38.68\n0.64\n0.91\n0.00\n0.40\n1.45\n0.15\n    85002\n85002\n32.74\n0.04\n32.11\n−0.02\n0.00\n0.00\n0.00\n−0.05\n0.96\n    87001\n87001\n30.55\n−0.18\n32.75\n0.04\n−0.01\n0.00\n0.01\n−0.08\n0.93\n    87003\n87003\n31.66\n−0.07\n35.27\n0.30\n−0.02\n0.00\n0.00\n−0.73\n0.47\n    91007\n91007\n25.82\n−0.66\n23.53\n−0.89\n0.59\n0.00\n0.05\n2.54\n0.01\n    91008\n91008\n24.66\n−0.78\n26.82\n−0.56\n0.43\n0.00\n0.20\n0.97\n0.33\n    91010\n91010\n25.74\n−0.67\n26.94\n−0.55\n0.36\n0.00\n0.09\n1.23\n0.22\n    92002\n92002\n11.50\n−2.11\n12.88\n−1.97\n4.15\n−0.01\n1.10\n3.97\n0.00\n    92004\n92004\n13.44\n−1.91\n14.98\n−1.75\n3.36\n−0.01\n0.60\n4.34\n0.00\n    92005\n92005\n13.02\n−1.95\n12.76\n−1.98\n3.87\n−0.01\n0.94\n3.99\n0.00\n    92006\n92006\n14.39\n−1.81\n13.47\n−1.91\n3.46\n−0.01\n1.09\n3.33\n0.00\n    92008\n92008\n12.06\n−2.05\n14.58\n−1.79\n3.68\n−0.01\n0.59\n4.81\n0.00\n    92010\n92010\n11.93\n−2.06\n12.93\n−1.96\n4.05\n−0.01\n1.05\n3.96\n0.00\n    93002\n93002\n12.26\n−2.03\n17.40\n−1.51\n3.07\n−0.01\n0.81\n3.41\n0.00\n    93005\n93005\n22.21\n−1.02\n14.00\n−1.85\n1.90\n0.00\n0.35\n3.22\n0.00\n    93007\n93007\n8.69\n−2.39\n15.75\n−1.68\n4.01\n−0.01\n1.88\n2.93\n0.00\n    93009\n93009\n13.28\n−1.93\n17.05\n−1.54\n2.98\n−0.01\n0.61\n3.83\n0.00\n    93011\n93011\n20.06\n−1.24\n28.08\n−0.43\n0.53\n0.00\n0.38\n0.87\n0.39\n    93012\n93012\n26.24\n−0.62\n23.93\n−0.85\n0.52\n0.00\n0.08\n1.91\n0.06\n    94002\n94002\n17.35\n−1.51\n20.61\n−1.19\n1.80\n0.00\n0.38\n2.93\n0.00\n    94007\n94007\n19.26\n−1.32\n17.50\n−1.50\n1.98\n0.00\n0.29\n3.70\n0.00\n    95002\n95002\n28.21\n−0.42\n30.17\n−0.22\n0.09\n0.00\n0.02\n0.63\n0.53\n    95003\n95003\n26.71\n−0.57\n21.70\n−1.07\n0.61\n0.00\n0.04\n3.07\n0.00\n    95004\n95004\n23.38\n−0.91\n24.59\n−0.78\n0.71\n0.00\n0.27\n1.36\n0.17\n    95008\n95008\n20.95\n−1.15\n25.47\n−0.69\n0.80\n0.00\n0.44\n1.21\n0.23\n    95010\n95010\n22.81\n−0.96\n27.77\n−0.46\n0.45\n0.00\n0.31\n0.81\n0.42\n    68001\n68001\n35.13\n0.28\n37.69\n0.54\n0.15\n0.00\n0.03\n0.94\n0.35\n    94005\n94005\n17.39\n−1.51\n18.36\n−1.41\n2.14\n0.00\n0.45\n3.19\n0.00\n    59007\n59007\n25.74\n−0.67\n25.92\n−0.65\n0.43\n0.00\n0.11\n1.30\n0.19"
  },
  {
    "objectID": "autocor.html#carte-des-lisa-1",
    "href": "autocor.html#carte-des-lisa-1",
    "title": "Autocorrélation spatiale",
    "section": "Carte des LISA",
    "text": "Carte des LISA"
  },
  {
    "objectID": "autocor.html#typologie-de-moran-2",
    "href": "autocor.html#typologie-de-moran-2",
    "title": "Autocorrélation spatiale",
    "section": "Typologie de Moran",
    "text": "Typologie de Moran\n\n\n\n\n\n\n\n\nGéoprisme 2024"
  },
  {
    "objectID": "classifregio.html#objectif",
    "href": "classifregio.html#objectif",
    "title": "Classification/Régionalisation",
    "section": "Objectif",
    "text": "Objectif\nOn commence par charger un jeu de données comportant plusieurs variables qui vont servir à construire une ou plusieurs matrices de dissimilarités. Dans l’exemple qui va suivre, on a choisit de prendre les deux principales listes d’extrêmes droite :\n\nX1 : % de votes pour Jordan Bardella (RN)\nX2 : % de votes pour Marion Marechal Le Pen (Reconquête)\n\n\n\n\n\n\n\n  \n    \n      Tableau de données\n    \n    \n    \n      code\n      nom\n      X1\n      X2\n    \n  \n  \n    44\nACAL\n38.3\n5.5\n    75\nAQUI\n30.9\n5.0\n    84\nAURA\n30.9\n5.6\n    27\nBOFC\n37.1\n5.3\n    53\nBRET\n25.6\n4.2\n    24\nCVDL\n34.9\n5.4\n    11\nIDF\n18.8\n5.7\n    76\nOCCI\n33.7\n5.5\n    32\nNOPI\n42.4\n4.6\n    28\nNORM\n35.3\n4.6\n    52\nPDL\n27.6\n4.7\n    93\nPACA\n38.6\n7.7"
  },
  {
    "objectID": "classifregio.html#variables-non-standardisées",
    "href": "classifregio.html#variables-non-standardisées",
    "title": "Classification/Régionalisation",
    "section": "Variables non standardisées",
    "text": "Variables non standardisées"
  },
  {
    "objectID": "classifregio.html#variance",
    "href": "classifregio.html#variance",
    "title": "Classification/Régionalisation",
    "section": "Variance",
    "text": "Variance\nOn remarque immédiatement que les deux variables ont des moyennes et des variances différentes :\n\n\n\n\n\n\n  \n    \n      Paramètres principaux (non standardisés)\n    \n    \n    \n      X1\n      X2\n    \n  \n  \n    32.9\n5.3\n    18.8\n4.2\n    42.4\n7.7\n    6.5\n0.9\n    42.7\n0.8\n    98.2\n1.8"
  },
  {
    "objectID": "classifregio.html#positions",
    "href": "classifregio.html#positions",
    "title": "Classification/Régionalisation",
    "section": "Positions",
    "text": "Positions\nLa variance des scores de la variable X1 (Bardella) est beaucoup plus forte que celle de la variable X2 (Marechal), ce qui signifie que si l’on s’en tient aux variables brutes, les différences entre régions seront liées essentiellement aux variations de la liste X1 :"
  },
  {
    "objectID": "classifregio.html#dissimilarités",
    "href": "classifregio.html#dissimilarités",
    "title": "Classification/Régionalisation",
    "section": "Dissimilarités",
    "text": "Dissimilarités\nLes distances euclidiennes entre les points sont donc dépendantes pour l’essentielle des résultat du score de Bardella (X1) et très peu de celui de Marion Maréchal (X2). C’est ce que montre bien la distance de dissimilarité associée :\n\n\n\n\n\n\n  \n    \n      Dissimilarité en distance euclidienne non standardisée\n    \n    \n    \n      \n      ACAL\n      AQUI\n      AURA\n      BOFC\n      BRET\n      CVDL\n      IDF\n      OCCI\n      NOPI\n      NORM\n      PDL\n      PACA\n    \n  \n  \n    ACAL\n0.0\n7.4\n7.4\n1.3\n12.8\n3.4\n19.5\n4.6\n4.2\n3.1\n10.7\n2.2\n    AQUI\n7.4\n0.0\n0.6\n6.2\n5.4\n4.0\n12.2\n2.8\n11.5\n4.4\n3.3\n8.2\n    AURA\n7.4\n0.6\n0.0\n6.2\n5.5\n4.0\n12.1\n2.8\n11.5\n4.5\n3.4\n8.0\n    BOFC\n1.3\n6.2\n6.2\n0.0\n11.6\n2.2\n18.3\n3.4\n5.4\n1.9\n9.5\n2.9\n    BRET\n12.8\n5.4\n5.5\n11.6\n0.0\n9.4\n6.9\n8.2\n16.8\n9.8\n2.1\n13.5\n    CVDL\n3.4\n4.0\n4.0\n2.2\n9.4\n0.0\n16.2\n1.3\n7.5\n0.9\n7.3\n4.4\n    IDF\n19.5\n12.2\n12.1\n18.3\n6.9\n16.2\n0.0\n14.9\n23.6\n16.6\n8.9\n20.0\n    OCCI\n4.6\n2.8\n2.8\n3.4\n8.2\n1.3\n14.9\n0.0\n8.8\n1.9\n6.1\n5.4\n    NOPI\n4.2\n11.5\n11.5\n5.4\n16.8\n7.5\n23.6\n8.8\n0.0\n7.1\n14.8\n4.9\n    NORM\n3.1\n4.4\n4.5\n1.9\n9.8\n0.9\n16.6\n1.9\n7.1\n0.0\n7.7\n4.5\n    PDL\n10.7\n3.3\n3.4\n9.5\n2.1\n7.3\n8.9\n6.1\n14.8\n7.7\n0.0\n11.4\n    PACA\n2.2\n8.2\n8.0\n2.9\n13.5\n4.4\n20.0\n5.4\n4.9\n4.5\n11.4\n0.0"
  },
  {
    "objectID": "classifregio.html#classification",
    "href": "classifregio.html#classification",
    "title": "Classification/Régionalisation",
    "section": "Classification",
    "text": "Classification\nUne classification ascendante hiérarchique utilisant la méthode de Ward aboutira alors à un résultat qui est à peu près identique à celui qu’on aurait obtenu en découpant uniquement selon la variable Bardella X1."
  },
  {
    "objectID": "classifregio.html#variables-standardisées",
    "href": "classifregio.html#variables-standardisées",
    "title": "Classification/Régionalisation",
    "section": "Variables standardisées",
    "text": "Variables standardisées\nSupposons maintenant que nous reprenions la même analyse mais en utilisant des variables standardisées dont on ramène la moyenne à 0 et l’écart-type à 1"
  },
  {
    "objectID": "classifregio.html#variance-1",
    "href": "classifregio.html#variance-1",
    "title": "Classification/Régionalisation",
    "section": "Variance",
    "text": "Variance\nDésormais les deux variables ont une même moyenne et une même variances. Elles vont donc jouer un rôle équivalent dans la classification.\n\n\n\n\n\n\n  \n    \n      Paramètres principaux (standardisés)\n    \n    \n    \n      \n      X1_std\n      X2_std\n    \n  \n  \n    moy\n0.0\n0.0\n    min\n−2.2\n−1.2\n    max\n1.5\n2.7\n    std\n1.0\n1.0\n    var\n1.0\n1.0\n    varpct\n50.0\n50.0"
  },
  {
    "objectID": "classifregio.html#positions-1",
    "href": "classifregio.html#positions-1",
    "title": "Classification/Régionalisation",
    "section": "Positions",
    "text": "Positions\nDésormais ce n’est plus la région Ile-de-France qui fait figure de région exceptionnelle mais plutôt la région PACA en raison du score exceptionnellement élevé de la liste Maréchal."
  },
  {
    "objectID": "classifregio.html#dissimilarités-1",
    "href": "classifregio.html#dissimilarités-1",
    "title": "Classification/Régionalisation",
    "section": "Dissimilarités",
    "text": "Dissimilarités\nLes distances euclidiennes entre les points sont donc désormais aussi dépendante du score de Bardella que celui de Maréchal en raison de la standardisation. Les très fortes dissimilarités concernent donc autant l’Ile-de-France (score exceptionnellement bas de Bardella) que la région PACA (score exceptionnellement haut de Maréchal)\n\n\n\n\n\n\n  \n    \n      Dissimilarité en distance euclidienne standardisée\n    \n    \n    \n      \n      ACAL\n      AQUI\n      AURA\n      BOFC\n      BRET\n      CVDL\n      IDF\n      OCCI\n      NOPI\n      NORM\n      PDL\n      PACA\n    \n  \n  \n    ACAL\n0.0\n1.3\n1.1\n0.3\n2.4\n0.5\n3.0\n0.7\n1.2\n1.1\n1.9\n2.5\n    AQUI\n1.3\n0.0\n0.7\n1.0\n1.2\n0.8\n2.0\n0.7\n1.8\n0.8\n0.6\n3.3\n    AURA\n1.1\n0.7\n0.0\n1.0\n1.7\n0.6\n1.9\n0.4\n2.1\n1.3\n1.1\n2.7\n    BOFC\n0.3\n1.0\n1.0\n0.0\n2.1\n0.4\n2.8\n0.6\n1.1\n0.8\n1.6\n2.7\n    BRET\n2.4\n1.2\n1.7\n2.1\n0.0\n2.0\n1.9\n1.9\n2.6\n1.6\n0.6\n4.4\n    CVDL\n0.5\n0.8\n0.6\n0.4\n2.0\n0.0\n2.5\n0.2\n1.5\n0.9\n1.4\n2.6\n    IDF\n3.0\n2.0\n1.9\n2.8\n1.9\n2.5\n0.0\n2.3\n3.8\n2.8\n1.7\n3.8\n    OCCI\n0.7\n0.7\n0.4\n0.6\n1.9\n0.2\n2.3\n0.0\n1.7\n1.0\n1.3\n2.6\n    NOPI\n1.2\n1.8\n2.1\n1.1\n2.6\n1.5\n3.8\n1.7\n0.0\n1.1\n2.3\n3.6\n    NORM\n1.1\n0.8\n1.3\n0.8\n1.6\n0.9\n2.8\n1.0\n1.1\n0.0\n1.2\n3.5\n    PDL\n1.9\n0.6\n1.1\n1.6\n0.6\n1.4\n1.7\n1.3\n2.3\n1.2\n0.0\n3.8\n    PACA\n2.5\n3.3\n2.7\n2.7\n4.4\n2.6\n3.8\n2.6\n3.6\n3.5\n3.8\n0.0"
  },
  {
    "objectID": "classifregio.html#classification-1",
    "href": "classifregio.html#classification-1",
    "title": "Classification/Régionalisation",
    "section": "Classification",
    "text": "Classification\nLa classification ascendante hiérarchique va désormais donner un résultat différent en isolant à la fois la région PACA (fort vote Bardella et Maréchal) et la région Ile de France (faible vote Bardella mais fort vote Maréchal)"
  },
  {
    "objectID": "classifregio.html#discussion",
    "href": "classifregio.html#discussion",
    "title": "Classification/Régionalisation",
    "section": "Discussion",
    "text": "Discussion\nFaut-il standardiser ?\n\nTout dépend de l’objectif !\nSi on veut conserver les effets de masse (poids réel des partis) il ne faut pas standardiser\nSi l’on veut analyser la diversité des votes (variété des comportements), il faut au contraire standardiser pour accorder le même poids à toute les listes.\n\nAvons nous régionalisé ?\n\nNon, même si la classification a produit des regroupements de régions proches.\nPour régionaliser, il faut introduire des contraintes spatiales qui interdisent l’apparition de classes disjointes.\n\nRégionalisation = classificiation sous contrainte\n\nLorsque nous avons effectué une classification, nous avons autorisé le regroupement de n’importe quelle unité avec n’importe quelle autre.\nDans le cas d’une régionalisation, nous allons limiter les choix en n’autorisant que des regroupements entre régions voisines."
  },
  {
    "objectID": "classifregio.html#le-graphe-de-voisinage",
    "href": "classifregio.html#le-graphe-de-voisinage",
    "title": "Classification/Régionalisation",
    "section": "Le graphe de voisinage",
    "text": "Le graphe de voisinage\nLe graphe de voisinage (\\(G^{vois}\\)) est une réduction du graphe complet (\\(G^{tot}\\)) utilisé lors de la classification pour regrouper les unités spatiales."
  },
  {
    "objectID": "classifregio.html#graphe-de-voisinage-pondéré",
    "href": "classifregio.html#graphe-de-voisinage-pondéré",
    "title": "Classification/Régionalisation",
    "section": "Graphe de voisinage pondéré",
    "text": "Graphe de voisinage pondéré\nOn procède à une pondération du graphe de voisinage par la dissimilarité qui sépare deux entités voisines. On peut considérer ceci comme un coût de mise en relation de deux unités différentes. On voit que le coût le plus fort est entre NOPI et IDF, le coût le plus faible entre ACAL et BOFC."
  },
  {
    "objectID": "classifregio.html#arbre-couvrant-minimum-théorie",
    "href": "classifregio.html#arbre-couvrant-minimum-théorie",
    "title": "Classification/Régionalisation",
    "section": "Arbre couvrant minimum (théorie)",
    "text": "Arbre couvrant minimum (théorie)\n\n\n\nEn théorie des graphes, étant donné un graphe non orienté connexe dont les arêtes sont pondérées, un arbre couvrant minimum (ACM),de ce graphe est un arbre couvrant (sous-ensemble qui est un arbre et qui connecte tous les sommets ensemble) dont la somme des poids des arêtes est minimale (c’est-à-dire de poids inférieur ou égal à celui de tous les autres arbres couvrants du graphe).\n\n\nL’arbre couvrant minimum peut s’interpréter de différentes manières selon ce que représente le graphe. De manière générale si on considère un réseau où un ensemble d’objets doivent être reliés entre eux (par exemple un réseau électrique et des habitations), l’arbre couvrant minimum est la façon de construire un tel réseau en minimisant un coût représenté par le poids des arêtes (par exemple la longueur totale de câble utilisée pour construire un réseau électrique).\n\nSource Wikipedia France\n\n\n\n\nArbre couvrant minimal : source Wikipedia, France"
  },
  {
    "objectID": "classifregio.html#arbre-couvrant-minimum-application",
    "href": "classifregio.html#arbre-couvrant-minimum-application",
    "title": "Classification/Régionalisation",
    "section": "Arbre couvrant minimum (application)",
    "text": "Arbre couvrant minimum (application)\nSi on applique cette méthode à notre graphe, on obtient un arbre (en rouge) qui permet de relier toutes les unités spatiales en évitant les plus fortes dissimilarités entre voisins. A titre d’exemple, IDF est relié à CVDL qui est son voisin le moins différent."
  },
  {
    "objectID": "classifregio.html#la-méthode-skater",
    "href": "classifregio.html#la-méthode-skater",
    "title": "Classification/Régionalisation",
    "section": "La méthode SKATER",
    "text": "La méthode SKATER\nLa méthode SKATER (Spatial C(K)luster Analysis by Tree Edge Removal) consiste d’une manière générale à découper l’arbre couvrant minimum au niveau des arêtes les plus dissemblables. Les deux premières étapes vont logiquement isoler PACA (très fort vote Maréchal) puis IDF (très faible vote Bardella)."
  },
  {
    "objectID": "classifregio.html#la-méthode-skater-1",
    "href": "classifregio.html#la-méthode-skater-1",
    "title": "Classification/Régionalisation",
    "section": "La méthode SKATER",
    "text": "La méthode SKATER\nLes étapes suivantes voient se détacher les régions de l’Ouest (faible vote Bardella et Maréchal) puis les régions du Nord-Ouest (fort vote Bardella mais faible vote Maréchal)"
  },
  {
    "objectID": "classifregio.html#qualité-de-la-régionalisation",
    "href": "classifregio.html#qualité-de-la-régionalisation",
    "title": "Classification/Régionalisation",
    "section": "Qualité de la régionalisation",
    "text": "Qualité de la régionalisation\n\n\nQuelle est la qualité des différentes régionalisations obtenue ? Comme dans une analyse de variance on peut décomposer les différences en variation intra-régionale et inter-régionale. La qualité d’une régionalisation est donc la part des variations inter-régionales dans la variation totale.\nDans notre exemple on voit que la part de variation interne diminue rapidement lorsqu’on sépare les deux régions exceptionnelles PACA et IDF du reste de la France. La partition en 3 classes résumé donc déjà 63% des différences.\nEn passant à 4 puis 5 classes, on arrive à une partition qui résume 80 à 90% des différences de vote pour les listes d’extrême droite\n\n\n\n\n\n\n\n  \n    \n      Variations intra et inter-régionales\n    \n    \n    \n      nbreg\n      varint\n      varext\n      vartot\n    \n  \n  \n    1.0\n100.0\n0.0\n100.0\n    2.0\n60.4\n39.6\n100.0\n    3.0\n36.8\n63.2\n100.0\n    4.0\n18.2\n81.8\n100.0\n    5.0\n9.9\n90.1\n100.0"
  },
  {
    "objectID": "classifregio.html#profil-des-régions",
    "href": "classifregio.html#profil-des-régions",
    "title": "Classification/Régionalisation",
    "section": "Profil des régions",
    "text": "Profil des régions\nComme dans une classification, on peut termine le travail par un examen du profil des régions obtenues."
  },
  {
    "objectID": "classifregio.html#discussion-1",
    "href": "classifregio.html#discussion-1",
    "title": "Classification/Régionalisation",
    "section": "Discussion",
    "text": "Discussion\nAvantage de la régionalisation / classification\n\nLa régionalisation fait émerger des régions homogènes c’est-à-dire des groupes d’entités ressemblantes et voisines.\nla régionalisation implique une analyse géographique alors que la classification adopte une perspective statistique.\n\nInconvénients de la régionalisation / classification\n\nA nombre égal de classes, la qualité du résumé offert par une régionalisation est toujours inférieur ou égal à celui d’une classification.\nEn l’absence d’autocorrélation spatiale positive, la régionalisation est inefficace et peu conduire à des regroupements absurdes.\n\nDiversité des algorithmes de régionalisation\n\nla définition du voisinage par la présence d’une frontière commune n’est pas la seule manière de définir les proximités qui servent de contrainte à la régionalisation.\nla méthode SKATER est un algorithme parmi d’autres pour chercher des groupes d’unités spatiales formant des régions homogènes.\ncomme dans le cas de la classification, le choix des variables, de leur standardisation et de leur transformation en matrice de similarité implique des choix précis.\n\n\n\n\nGéoprisme 2024"
  },
  {
    "objectID": "geom_doc.html#objectif",
    "href": "geom_doc.html#objectif",
    "title": "Géometries de mondes abstraits",
    "section": "Objectif",
    "text": "Objectif\nNous souhaitons montrer comment le choix d’une géométrie va influencer la perception des proximités entre des individus qui occupent des positions à l’intérieur d’un espace. Après avoir défini des distances entre les individus dans une géométrie, nous chercherons à définir des régions regroupant les individus de façon à maximiser un critère d’accessibilité défini comme suit\n\nles individus situés dans une même région doivent être le plus proche possibles\nles individus situés dans deux régions différentes doivent être le plus éloignés possibles\n\nIl faudra donc définir une mesure de proximité \\(D_{ij}\\) entre les positions occupées par les individus puis choisir un critère à optimiser \\(H(D,R)\\). Mais on pourra également travailler sur l’ensemble des positions possibles (qu’elles soient ou non occupées par un individu) et définir une partition de l’ensemble de l’espace en fonction de la proximité des positions inoccupées avec les groupes d’indvidus établis au cours de la première étape de l’analyse."
  },
  {
    "objectID": "geom_doc.html#dispositif-expérimental",
    "href": "geom_doc.html#dispositif-expérimental",
    "title": "Géometries de mondes abstraits",
    "section": "Dispositif expérimental",
    "text": "Dispositif expérimental\nOn suppose que le monde est décrit par une ou plusieurs dimensions \\(D_1, D_2, D_3, ...D_k\\) qui définissent des positions pouvant être occupées par des individus \\(i_1, ...i_n\\) qui forment une population.\nOn suppose que chaque dimension comporte isolément 100 positions possibles que l’on peut noter de de 1 à 100. Lorsque l’on croise deux dimensions le nombre de position est multiplié et non pas additionné. Un espace à 2 dimensions offrira donc 10 000 positions et un espace à 3 dimensions 1 million de positions.\nNous nous limiterons dans notre analyse au cas des espaces à une ou deux dimensions et nous partirons systématiquement d’un même tableau de données composé de 12 individus et décrits par le tableau suivant :\n\n\n\n\n\ncode\nD1\nD2\n\n\n\n\nA\n1\n48\n\n\nB\n17\n90\n\n\nC\n22\n6\n\n\nD\n26\n70\n\n\nE\n48\n31\n\n\nF\n52\n54\n\n\nG\n56\n67\n\n\nH\n58\n50\n\n\nI\n72\n18\n\n\nJ\n76\n86\n\n\nK\n78\n39\n\n\nL\n99\n16\n\n\n\n\n\n\nLa position D1 a été réalisée en effectuant un tirage uniforme aléatoire de 4 points entre 1 et 30, 4 points entre 41 et 60 et 4 points entre 71 et 100. Elle a donc exclu les positions \\([31;40]\\) et \\([61 ; 70]\\) du tirage au sort.\nLes positions D2 a été en revanche construites par un tirage aléatoire uniforme sur l’ensemble de l’intervalle \\([1;100]\\)"
  },
  {
    "objectID": "geom_doc.html#a.1-le-monde-est-un-segment",
    "href": "geom_doc.html#a.1-le-monde-est-un-segment",
    "title": "Géometries de mondes abstraits",
    "section": "A.1 Le monde est un segment …",
    "text": "A.1 Le monde est un segment …\nImaginons que le monde se réduise à une ligne comme la future ville de Neom en Arabie Saoudite\n\n\nDonnées\nOn ne considère que la dimension D1 et on définit un segment de longueur 100 sur lequel se distribuent les 12 individus\n\n\n\n\n\n\nX\n\n\n\n\nA\n1\n\n\nB\n17\n\n\nC\n22\n\n\nD\n26\n\n\nE\n48\n\n\nF\n52\n\n\nG\n56\n\n\nH\n58\n\n\nI\n72\n\n\nJ\n76\n\n\nK\n78\n\n\nL\n99\n\n\n\n\n\n\n\nVisualisation\nOn peut visualiser facilement le résultat en adoptant une direction quelconque puisque notre ligne n’est pas orientée vers une direction particulière.\n\n\n\n\n\n\n\nDistances\nDans notre monde linéaire on construite une distance \\(D_{ij}\\) qui sera par définition une fonction de la seule variable de localisation \\(X_i\\). Un choix évident est la différence en valeur absolue :\n\\(D_{ij} = |X_i - X_j|\\)\nComme notre monde est fini on peut normaliser la distance sur l’intervalle \\([0 ; 1]\\) en divisant les valeurs de distance par la valeur maximale possible (de préférence à la valeur maximale observée).\n\\(D_{ij}^{norm} = |X_i - X_j|/ D_{max}\\)\nLe maximum possible étant pour nous égal ici à \\(D_{max} = 100\\), la matrice de distance se calcule sans difficultés avec la fonction dist()de R-base :\n\nDij = dist(coo,diag = T, upper = T,method = \"euclidean\")\nDij = Dij/100\nkable(as.matrix(Dij),\n      caption = \"Matrice de distance normalisée\",\n      digits=2)\n\n\nMatrice de distance normalisée\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA\nB\nC\nD\nE\nF\nG\nH\nI\nJ\nK\nL\n\n\n\n\nA\n0.00\n0.16\n0.21\n0.25\n0.47\n0.51\n0.55\n0.57\n0.71\n0.75\n0.77\n0.98\n\n\nB\n0.16\n0.00\n0.05\n0.09\n0.31\n0.35\n0.39\n0.41\n0.55\n0.59\n0.61\n0.82\n\n\nC\n0.21\n0.05\n0.00\n0.04\n0.26\n0.30\n0.34\n0.36\n0.50\n0.54\n0.56\n0.77\n\n\nD\n0.25\n0.09\n0.04\n0.00\n0.22\n0.26\n0.30\n0.32\n0.46\n0.50\n0.52\n0.73\n\n\nE\n0.47\n0.31\n0.26\n0.22\n0.00\n0.04\n0.08\n0.10\n0.24\n0.28\n0.30\n0.51\n\n\nF\n0.51\n0.35\n0.30\n0.26\n0.04\n0.00\n0.04\n0.06\n0.20\n0.24\n0.26\n0.47\n\n\nG\n0.55\n0.39\n0.34\n0.30\n0.08\n0.04\n0.00\n0.02\n0.16\n0.20\n0.22\n0.43\n\n\nH\n0.57\n0.41\n0.36\n0.32\n0.10\n0.06\n0.02\n0.00\n0.14\n0.18\n0.20\n0.41\n\n\nI\n0.71\n0.55\n0.50\n0.46\n0.24\n0.20\n0.16\n0.14\n0.00\n0.04\n0.06\n0.27\n\n\nJ\n0.75\n0.59\n0.54\n0.50\n0.28\n0.24\n0.20\n0.18\n0.04\n0.00\n0.02\n0.23\n\n\nK\n0.77\n0.61\n0.56\n0.52\n0.30\n0.26\n0.22\n0.20\n0.06\n0.02\n0.00\n0.21\n\n\nL\n0.98\n0.82\n0.77\n0.73\n0.51\n0.47\n0.43\n0.41\n0.27\n0.23\n0.21\n0.00\n\n\n\n\n\n\n\nPartition\nDans notre espace à une dimension, la variable \\(X_i\\) peut correspondre indifféremment à une position spatiale ou à un attribut statistique. Le choix d’une méthode de régionalisation revient donc ici à une simple classification visant à minimiser les distances intra-classes et maximiser les distances inter-classes. Il suffit donc d’appliquer un programme de classification pour obtenir une régionalisation de notre espace. On peut utiliser ici la procédure hclust de R-base\n\n\n\n\n\nOn décide par exemple de faire 3 classes et l’on retrouve sans surprise les groupes qui avaient été favorisés dans le tirage des valeurs de la dimension D1.\n\n\n\n\n\n\n\nDensités\nPlutôt que de fixer a priori le nombre de régions, on pourrait également raisonner sur la distribution des densités de points en fonction d’une fonction décroissante de la distance, ce qui permettra de repérer des pics de forte densité (“coeurs” des régions) et des bassins de faible densité (“marges” des régions).\nSupposons par exemple que nous appliquions un voisinage gaussien de portée \\(\\mu\\) c’est à dire\n\\(f(D_{ij}) = exp(- \\alpha D_{ij}^2)\\) avec \\(\\alpha = ln(0.5)/\\mu^2\\)\n\n\n\n\n\nOn peut alors voir comment le nombre de pics de densité diminue lorsque la portée de la fonction de voisinage augmente et comment on passe de 5 pics (\\(\\mu = 5\\)) à deux pics (\\(\\mu = 10\\)) et finalement un seul (\\(\\mu = 20\\)).\nCe résultat très important montre que l’on peut construire un continuum de régionalisations en faisant varier le paramètre \\(\\mu\\) pour une certraine famille de fonction de la distance et en examinant l’évolution de la distribution des pics et des creux d’accessibilité."
  },
  {
    "objectID": "geom_doc.html#a.2-le-monde-est-un-cercle",
    "href": "geom_doc.html#a.2-le-monde-est-un-cercle",
    "title": "Géometries de mondes abstraits",
    "section": "A.2 Le monde est un cercle …",
    "text": "A.2 Le monde est un cercle …\nImaginons maintenant que le monde se réduit à une cercle autour d’une planète, comme dans le cas des anneaux de Saturne\n\n\nDonnées\nOn transfrome les coordonnées de \\(D_1\\) en positions angulaires sur le cercle dans le sens trigonométrique \\(\\theta_1 ...\\theta_{12}\\) qui corresponde aux longitudes sur cette planète\n\n\n\n\n\n\ntheta\n\n\n\n\nA\n3.6\n\n\nB\n61.2\n\n\nC\n79.2\n\n\nD\n93.6\n\n\nE\n172.8\n\n\nF\n187.2\n\n\nG\n201.6\n\n\nH\n208.8\n\n\nI\n259.2\n\n\nJ\n273.6\n\n\nK\n280.8\n\n\nL\n356.4\n\n\n\n\n\nIl s’agit apparemment de la même situation que précédemment (les valeurs de position angulaire \\(\\theta\\) mesurées en degrés correspondent aux valeurs précédentes de X) mais la géométrie n’est plus la même ce qui change fondamentalement le calcul de distances.\n\n\nVisualisation\nSi l’on veut visualiser les points dans un espace à deux dimensions on peut les projeter, à la manière d’une carte du monde en projection polaire dont la longitude serait notre variable \\(\\theta\\) et la latitude une constante égale à zéro correspondant à l’équateur. Si par exemple notre monde est une planète de rayon \\(R\\) = 1000 km, on aura\n\\(x_i = R \\times cos(\\theta_i)\\)\n\\(y_i = R \\times sin(\\theta_i)\\)\n\n\n\nCoordonnées en projection polaire (R = 1000 km)\n\n\n\nx\ny\n\n\n\n\nA\n998.02673\n62.79052\n\n\nB\n481.75367\n876.30668\n\n\nC\n187.38131\n982.28725\n\n\nD\n-62.79052\n998.02673\n\n\nE\n-992.11470\n125.33323\n\n\nF\n-992.11470\n-125.33323\n\n\nG\n-929.77649\n-368.12455\n\n\nH\n-876.30668\n-481.75367\n\n\nI\n-187.38131\n-982.28725\n\n\nJ\n62.79052\n-998.02673\n\n\nK\n187.38131\n-982.28725\n\n\nL\n998.02673\n-62.79052\n\n\n\n\n\nMais en réalité il est inutile d’introduire une projection dans un espace à deux dimensions si l’on supposer que les relations ne peuvent se faire qu’en circulant le long du cercle. La visualisation correcte de ce monde n’a donc pas besoin d’une échelle de distance mais plutôt d’une échelle angulaire.\n\n\n\n\n\nLe changement de géométrie entraîne un rapprochement spectaculaire des points \\(A\\) et \\(L\\) qui étaient auparavant les deux points les plus éloignés dans le monde linéaire.\n\n\nDistances\nDans notre monde circulaire, il n’est pas possible de se déplacer en ligne droite. Les distances correspondent donc aux trajets effectués surun arc de cercle ce qui donne une valeur maximale égale à \\(\\pi \\times R\\) avec \\(R\\) égal au rayon du cercle. On normalise par la distance maximale qui est égale à \\(\\pi R\\) soit 3141.5 km dans notre exemple.\n\n\n\n\n\n\nLe package circular\n\n\n\n\n\nLe calcul des distances angulaires est très facile avec le package circular.\nCelui-ci comporte par ailleurs de très nombreuses fonctions d’analyse statistique appliqués à cette géométrie particulière du cercle Lund et Agostinelli (2004), Jammalamadaka et SenGupta (2001)\n\n\n\n\n\n\nDistance circulaire normalisée\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA\nB\nC\nD\nE\nF\nG\nH\nI\nJ\nK\nL\n\n\n\n\nA\n0.00\n0.32\n0.42\n0.50\n0.94\n0.98\n0.90\n0.86\n0.58\n0.50\n0.46\n0.04\n\n\nB\n0.32\n0.00\n0.10\n0.18\n0.62\n0.70\n0.78\n0.82\n0.90\n0.82\n0.78\n0.36\n\n\nC\n0.42\n0.10\n0.00\n0.08\n0.52\n0.60\n0.68\n0.72\n1.00\n0.92\n0.88\n0.46\n\n\nD\n0.50\n0.18\n0.08\n0.00\n0.44\n0.52\n0.60\n0.64\n0.92\n1.00\n0.96\n0.54\n\n\nE\n0.94\n0.62\n0.52\n0.44\n0.00\n0.08\n0.16\n0.20\n0.48\n0.56\n0.60\n0.98\n\n\nF\n0.98\n0.70\n0.60\n0.52\n0.08\n0.00\n0.08\n0.12\n0.40\n0.48\n0.52\n0.94\n\n\nG\n0.90\n0.78\n0.68\n0.60\n0.16\n0.08\n0.00\n0.04\n0.32\n0.40\n0.44\n0.86\n\n\nH\n0.86\n0.82\n0.72\n0.64\n0.20\n0.12\n0.04\n0.00\n0.28\n0.36\n0.40\n0.82\n\n\nI\n0.58\n0.90\n1.00\n0.92\n0.48\n0.40\n0.32\n0.28\n0.00\n0.08\n0.12\n0.54\n\n\nJ\n0.50\n0.82\n0.92\n1.00\n0.56\n0.48\n0.40\n0.36\n0.08\n0.00\n0.04\n0.46\n\n\nK\n0.46\n0.78\n0.88\n0.96\n0.60\n0.52\n0.44\n0.40\n0.12\n0.04\n0.00\n0.42\n\n\nL\n0.04\n0.36\n0.46\n0.54\n0.98\n0.94\n0.86\n0.82\n0.54\n0.46\n0.42\n0.00\n\n\n\n\n\nLa distance maximale est alors observée entre des points situés à l’opposé l’un de l’autre sur le cercle comme A et D. Mais en revanche les points qui étaient auparavant très éloignés dans le monde du segment comme A et L sont désormais très proches dans le monde du cercle puisque celui-ci se referme à leur niveau.\n\n\nPartition\nDans notre monde circulaire, la classification est très différente de celle observée dans le monde du segment alors même que les valeurs numériques sont au départ les mêmes. C’est la projection qui diffère.\n\n\n\n\n\nOn va retenir ici 4 classes\n\n\n\n\n\n\n\nDensités\nComme dans le cas du monde linéaire, on peut tracer des courbes de densité paramétriques pour repérer les coeurs et les marges de notre espace. On doit alors faire apport à des lois de probabilité définies sur le cercle comme la loi de von Mises.\n\n\n\n\n\n\nLa distribution de von Mises\n\n\n\n\n\nVu notre faible niveau en mathématique, on s’appuiera ici sur l’article Wikipedia consécré à la loi de von Mises, disponible en cinq langues seulement dont le français et l’anglais.\n\nDans la théorie des probabilités et en statistiques, la loi (distribution) de von Mises (appelée également distribution normale circulaire ou distribution de Tikhonov) est une densité de probabilité continue, nommée d’après Richard von Mises. Elle donne une bonne approximation de la loi normale périodique (en), qui est l’analogue circulaire de la loi normale. Un angle de diffusion \\(θ\\) parcourant un cercle est une variable aléatoire suivant la loi normale périodique avec une variance non périodique qui croît linéairement en temps. D’un autre côté, la loi de von Mises est la distribution stationnaire d’un processus de diffusion et déviation sur le cercle dans un potentiel harmonique, i.e. avec une orientation guidée.La loi de von Mises est la loi de probabilités à entropie maximale pour une valeur donnée de \\(z = e^{i\\theta}\\). La loi de von Mises est un cas particulier de la loi de von Mises-Fisher sur la N-sphère. Source : Wikipedia France, consulté le 27 nov. 2024\n\n\n\n\nDensité de probabilité de la loi de von Mises\n\n\n\n\n\nOn utilise ici la méthode de lissage par kernel paramétrique (vonmises) du package circularavec des paramètres kappa de valeur 9 , 18 et 36.\n\n\n\n\n\nOn retouve la même méthode de calcul des densités que dans le monde linéaire, mais appliqué aux coordonnées angulaires. Mais avec une différence importante qui est ici la permanence de l’existence de 4 pics de densité aux différentes échelles de généralisation."
  },
  {
    "objectID": "geom_doc.html#b.1-le-monde-est-un-échiquier",
    "href": "geom_doc.html#b.1-le-monde-est-un-échiquier",
    "title": "Géometries de mondes abstraits",
    "section": "B.1 Le monde est un échiquier",
    "text": "B.1 Le monde est un échiquier\n\nL’image la plus simple qui vienne à l’esprit lorsque l’on évoque un monde fini à deux dimensions est celle d’un échuiquier ou d’un damier. Comme nous avons introduit l’hypothèse que chaque individu occupait une position et que deux individus ne pouvaient pas occuper la même position, on peut définit des cases ou carreaux correspondant aux différentes positions autorisées. Le faite que ces carreaux soient de forme carrée n’est évidemment pas obligatoire (on aurait pu choisir des triangles ou des hexagone pour produire un pavage de l’espace) mais cela est suffisant dans un premier temps pour formuler quelques hypothèses sur les distances à l’intérieur de ce monde et cela permet de retrouver un certain nombre de métriques théoriques (euclidienne, Manhattan, Chebyshev, …) pour définir les distances entre les individus.\n\nDonnées\nOn reprend telle quelle les données de position des dimensions D1 et D2 en soustrayant juste la valeur de 0.5 pour placer nos individus au centre des cases d’un échiquier formant un carré de dimension 100 x 100 avec un reprère orthonormé placé au point (0,0).\n\n\n\n\n\n\nX\nY\n\n\n\n\nA\n0.5\n47.5\n\n\nB\n16.5\n89.5\n\n\nC\n21.5\n5.5\n\n\nD\n25.5\n69.5\n\n\nE\n47.5\n30.5\n\n\nF\n51.5\n53.5\n\n\nG\n55.5\n66.5\n\n\nH\n57.5\n49.5\n\n\nI\n71.5\n17.5\n\n\nJ\n75.5\n85.5\n\n\nK\n77.5\n38.5\n\n\nL\n98.5\n15.5\n\n\n\n\n\n\n\nVisualisation\nLa visualisation est immédiate et facile, tous les logiciels de cartographie ou de statistique étant habitué à cette géométrie\n\n\n\n\n\n\n\nDistance\nUn grand nombre de métriques sont adaptées à cette géométrie. On peut notamment utiliser la famille des distances de Minkowski qui est uneformule générale de calcul des distance entre deux points dans l’espace dimensionnel n, applicable au cas de l’espace de dimension 2 qui nous intéresse ici. Elle est une généralisation des distances Euclidienne, de Manhattan et de Tchebychev. Dans un espace de dimension n, la distance de Minkowski de paramètre \\({\\lambda}\\) s’écrira :\n\\(D^{Mink}(a,b) = \\sqrt[\\lambda]{\\sum^n_{i=1}{(|a_i-b_i|)^\\lambda})}\\)\nLe paramètre \\(\\lambda\\) est l’ordre de la métrique de Minkowski. Pour différentes valeurs de \\(\\lambda\\), la distance peut être calculée d’au moins trois manières différentes :\n\n\\(\\lambda = 1\\) : Distance de Manhattan (métrique \\(L^1\\))\n\\(\\lambda = 2\\) : Distance Euclidienne (métrique \\(L^2\\))\n\\(\\lambda = \\infty\\) : Distance de Tchebychev (métrique \\(L^\\infty\\))\n\nSi l’on retient par exemple la distance euclidienne et si on normalise par la plus grande distance possible (\\(100\\sqrt2\\)) qui correspond à la distance entre deux points opposés du carré on obtient la matrice de distance suivante :\n\n\n\nMatrice de distance normalisée\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA\nB\nC\nD\nE\nF\nG\nH\nI\nJ\nK\nL\n\n\n\n\nA\n0.00\n0.32\n0.33\n0.24\n0.35\n0.36\n0.41\n0.40\n0.55\n0.59\n0.55\n0.73\n\n\nB\n0.32\n0.00\n0.60\n0.16\n0.47\n0.36\n0.32\n0.41\n0.64\n0.42\n0.56\n0.78\n\n\nC\n0.33\n0.60\n0.00\n0.45\n0.26\n0.40\n0.49\n0.40\n0.36\n0.68\n0.46\n0.55\n\n\nD\n0.24\n0.16\n0.45\n0.00\n0.32\n0.22\n0.21\n0.27\n0.49\n0.37\n0.43\n0.64\n\n\nE\n0.35\n0.47\n0.26\n0.32\n0.00\n0.17\n0.26\n0.15\n0.19\n0.44\n0.22\n0.38\n\n\nF\n0.36\n0.36\n0.40\n0.22\n0.17\n0.00\n0.10\n0.05\n0.29\n0.28\n0.21\n0.43\n\n\nG\n0.41\n0.32\n0.49\n0.21\n0.26\n0.10\n0.00\n0.12\n0.36\n0.20\n0.25\n0.47\n\n\nH\n0.40\n0.41\n0.40\n0.27\n0.15\n0.05\n0.12\n0.00\n0.25\n0.28\n0.16\n0.38\n\n\nI\n0.55\n0.64\n0.36\n0.49\n0.19\n0.29\n0.36\n0.25\n0.00\n0.48\n0.15\n0.19\n\n\nJ\n0.59\n0.42\n0.68\n0.37\n0.44\n0.28\n0.20\n0.28\n0.48\n0.00\n0.33\n0.52\n\n\nK\n0.55\n0.56\n0.46\n0.43\n0.22\n0.21\n0.25\n0.16\n0.15\n0.33\n0.00\n0.22\n\n\nL\n0.73\n0.78\n0.55\n0.64\n0.38\n0.43\n0.47\n0.38\n0.19\n0.52\n0.22\n0.00\n\n\n\n\n\n\n\nPartition\nOn applique comme précédemment un programme de classification sur la matrice de distancepour obtenir une régionalisation de notre espace.\n\n\n\n\n\nOn décide par exemple de faire 4 classes :\n\n\n\n\n\n\n\nDensités\nPlusieurs méthodes sont possibles pour déterminer les trajectoires de regroupement des points en fonction d’une fonction d’interaction spatiale. Par exemple on peut utiliser comme dans le monde segmentaire la méthode des potentiels avec voisinages gaussiens de portées successives (5,10,15,20). On vot alors très bien comment le nombre de pics de potentiel (donc de densité) va progressivement diminuer pour passer de \\(n\\) pics (nombre de positions occupées) pour se réduite à un pic unique."
  },
  {
    "objectID": "geom_doc.html#b.2-le-monde-est-un-disque",
    "href": "geom_doc.html#b.2-le-monde-est-un-disque",
    "title": "Géometries de mondes abstraits",
    "section": "B.2 Le monde est un disque",
    "text": "B.2 Le monde est un disque\n\nL’idée que le Monde soit un disque est une idée ancienne et même si la science a fini par l’infirmer elle demeure sans nul doute présente dans beaucoup de représentations contemporaines, propagées notamment par les théories du complot sur Youtube (Mohammed 2019). Il semble aussi que la conception d’une Terre plate soit une étape dans le dévloppement cognitif des enfants (Vaiopoulou et Papageorgiou 2018). Enfin, beaucoup de romans, notamment de science fiction ont utiliséce modèle pour construire des univers imaginaires, le plus célèbre étant sans doute celui des Annales du Disque Monde et la création annexe par l’auteur d’une série d’ouvrages portant sur la Science of Discworld (Stewart, Cohen, et Pratchett 2011) .\n\n“The Disc, as it’s referred to in the novel, is quite literally a disc. The flat planet is carefully balanced on the backs of four elephants – Berilia, Tubul, Great T’Phon, and Jerakeen – who in turn stand on the Star Turtle, the Great A’Tuin, as it swims through space. […] Since the Disc is flat, there are no cardinal directions. Instead, the four directions are Hubwards (towards the Hub), Rimwards (towards the Rim), Turnwise (the direction that the Disc rotates in), and Widdershins (opposite to Turnwise). This leads to an endless onslaught of puns and geographical jokes. At the end of the book we discover the Circumfence, the rope fence that lines the edge of the Disc to help ensure no one falls off. There’s also the beauty of the Counterweight Continent – a land fabled to be made out of pure gold that exists to keep the Disc from tipping over. Everything we learn about the geography of Discworld is strangely cohesive while being entirely silly.” Source : Fernandez W., The Color of Magic, Consulté le 21/11/2024\n\nDans la perspective d’abstraction qui est la nôtre, un monde fini en forme de disque constitue un cas particulièrement intéressant puisque les positions peuvent y être mesurées par un jeu de coordonnées à la fois métrique et angulaire, ce qui revient en pratique à combiner les deux mondes vus précédemment : segment et cercle.\n\nDonnées\nOn reprend les positions angulaires \\(\\theta_1 ...\\theta_{12}\\) issues de la variable D1 et on ajoute 12 coordonnées de rayon \\(\\rho_1 ...\\rho_{12}\\) qui mesurent la distance au centre. On fixe la distance maximale au centre à 1\n\n\n\n\n\n\ntheta\nrho\n\n\n\n\nA\n3.6\n0.48\n\n\nB\n61.2\n0.90\n\n\nC\n79.2\n0.06\n\n\nD\n93.6\n0.70\n\n\nE\n172.8\n0.31\n\n\nF\n187.2\n0.54\n\n\nG\n201.6\n0.67\n\n\nH\n208.8\n0.50\n\n\nI\n259.2\n0.18\n\n\nJ\n273.6\n0.86\n\n\nK\n280.8\n0.39\n\n\nL\n356.4\n0.16\n\n\n\n\n\n\n\nVisualisation\nOn peut propooser une visualisation planaire en projetant les coordonnées dans un espace euclidien à l’aide des formules de transformation des coordonnées polaires précédentes :\n\\(x_i = \\rho_i \\times cos(\\theta_i)\\)\n\\(y_i = \\rho_i \\times sin(\\theta_i)\\)\n\n\n\n\n\nMais en réalité, la propriété fondamentale d’un monde de ce type est qu’il n’existe pas de direction privilégiée de type “Nord”, “Sud”, “Est” ou “Ouest”. Il y a en revanche un centre et une périphérie (définis par la position sur la coordonnée sur \\(\\rho\\)) et une direction de rotation qui suit le sens trignométrique (valeurs croissantes de \\(\\theta\\)) ou le sens des aiguilles d’une montre (valeurs décroissantes de \\(\\theta\\))\n\n\nDistances\nDans le monde du disque il existe de très nombreuses possibilités de mesurer les distances, conduisant chacune à des formes différentes de regroupement des points en fonction de leur proximité. D’une manière générale on peut écrire :\n\\(D_{ij} = f(\\rho_i, \\theta_i, \\rho_j, \\theta_j)\\)\nOn peut par exemple imaginer une décomposition additive de la fontion \\(f\\) en deux fonctions \\(f_1, f_2, f_3\\) telles que :\n\\(D_{ij} = f_1(\\rho_i,\\rho_j) + f_2(\\theta_i, \\theta_j)\\)\nOn retrouve ainsi différences fonctions de distances utilisées en géographie urbaine : la distance centrale, la distance périphérique et la distance circumradiale\nLa distance centrale  fait l’hypothèse que tous les déplacements doivent passer par le centre du disque en suivant les radiales. Ce qui donne :\n\\(D_{ij}^{Ctr} = \\rho_i + \\rho_j\\)\nLa distance périphérique fait l’hypothèse que tous les déplacements dovent passer par la bordure externe du disque car le centre est saturé.\n\\(D_{ij}^{Per} = (R - \\rho_i)+ (R- \\rho_j) + 2 \\pi R \\frac{|\\theta_i-\\theta_j|}{360}\\)\nLa distance circumradiale suppose quant à alle que les déplacements peuvent s’effectuer aussi bien à l’aide de radiales que de périphériques ce qui suppose que le réseau de transport combine les deux types d’axes. Elle constitue un équivalent de la distance de Manhattan mais appliquée à des villes de plan radioconcentriques comme Sfax. On peut la paramétrer à l’aide de coefficients \\(\\alpha\\) et \\(\\beta\\) pour tenir compte de vitesses différentes de circulation sur les radiales ou les périphériques. Elle possède la propriété d’admettre une infinité d’itinéraires différents puisque le plus court chemin peut s’effectuer selon différentes radiales ou différents périphériques.\n\\(D_{ij}^{CR} = \\frac {\\alpha|\\rho_i - \\rho_j| + \\beta \\frac{ |\\theta_i-\\theta_j]|}{\\pi}}{\\alpha+\\beta}\\)\n\n\n\n\n\nEssayons à titre d’exemple de la calculer la distance circumradiale pour les paramètres \\(\\alpha = \\beta = 1\\), c’est-à-dire en accordant la même importance aux différences angulaires et aux différences radiales.\n\n\n\nDistance circumradiale\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA\nB\nC\nD\nE\nF\nG\nH\nI\nJ\nK\nL\n\n\n\n\nA\n0.00\n0.37\n0.42\n0.36\n0.56\n0.52\n0.54\n0.44\n0.44\n0.44\n0.28\n0.18\n\n\nB\n0.37\n0.00\n0.47\n0.19\n0.60\n0.53\n0.50\n0.61\n0.81\n0.43\n0.64\n0.55\n\n\nC\n0.42\n0.47\n0.00\n0.36\n0.38\n0.54\n0.64\n0.58\n0.56\n0.86\n0.60\n0.28\n\n\nD\n0.36\n0.19\n0.36\n0.00\n0.42\n0.34\n0.31\n0.42\n0.72\n0.58\n0.63\n0.54\n\n\nE\n0.56\n0.60\n0.38\n0.42\n0.00\n0.15\n0.26\n0.20\n0.30\n0.56\n0.34\n0.57\n\n\nF\n0.52\n0.53\n0.54\n0.34\n0.15\n0.00\n0.11\n0.08\n0.38\n0.40\n0.34\n0.66\n\n\nG\n0.54\n0.50\n0.64\n0.31\n0.26\n0.11\n0.00\n0.11\n0.41\n0.30\n0.36\n0.68\n\n\nH\n0.44\n0.61\n0.58\n0.42\n0.20\n0.08\n0.11\n0.00\n0.30\n0.36\n0.26\n0.58\n\n\nI\n0.44\n0.81\n0.56\n0.72\n0.30\n0.38\n0.41\n0.30\n0.00\n0.38\n0.17\n0.28\n\n\nJ\n0.44\n0.43\n0.86\n0.58\n0.56\n0.40\n0.30\n0.36\n0.38\n0.00\n0.25\n0.58\n\n\nK\n0.28\n0.64\n0.60\n0.63\n0.34\n0.34\n0.36\n0.26\n0.17\n0.25\n0.00\n0.32\n\n\nL\n0.18\n0.55\n0.28\n0.54\n0.57\n0.66\n0.68\n0.58\n0.28\n0.58\n0.32\n0.00\n\n\n\n\n\n\n\nPartition\n\n\n\n\n\nL’arbre nous suggère 4 classes que l’on peut visualiser ainsi\n\n\n\n\n\nL’image obtenu est de prime abord assez perturbante puisque des points qui nous semblent proches (en distance euclidienne) se retouvent en fait séparés dans des classes différentes et des points apparemment éloignés sont regroupés. La difficulté vient du fait que notre oeil regroupe de façon euclidienne alors que la distance qui est ici à l’oeuvre (circumradiale) opère différemment. Elle conduit en particulier à rapprocher les points localisés dans un même secteur angulaire c’est-à-dire ayant des valeurs proches de \\(\\theta\\). Deux points centraux peuvent alors être très éloignés s’ils sont situés de part et d’autre du centre.\n\n\nDensité\nLe calcul des densités avec cette géométrie pour différentes portées de lissage est assez complexe … Nous procédons ici juste à un calcul approximatif pour des voisinages gaussiens de portée 0.1 et 0.2 en distance circumradiale.\n\n\n\n\n\nLes couleurs sont calculées en fonction de la valeur du potentiel selon une échelle multiplicative. On remarque que des zones très proches du centre (ex. voisinage du point C) peuvent avoir des densités très faibles car elles ont peu d’autres points dans leur secteur angulaire. Inversement des points apparamment éloignés mais proches en terme angulaire ou en terme de distance au centre peuvent créer des pics locaux(cas des points B et D).\nN.B. : J’ai l’impression de réinventer la lune faute de recherches bibliographiques suffisante. Mais who knows ?"
  },
  {
    "objectID": "geom_doc.html#b.3-le-monde-est-un-triangle",
    "href": "geom_doc.html#b.3-le-monde-est-un-triangle",
    "title": "Géometries de mondes abstraits",
    "section": "B.3 Le monde est un triangle",
    "text": "B.3 Le monde est un triangle\n\n\n\nsource\n\n\nLes diagrammes triangulaires aussi appelés ternaires (ternary diagram) correspondent à un cas particulier de monde bidimensionnel mais construit à partir de trois variables liées par une relation. qui fait que chacune des variables peut se déduire des deux autres. On posera plus précisément que la somme des trois composantes doit toujours être égale à 1 pour chacun des éléments de la population décrit par les rois composantes.\n\\(\\forall i \\in \\{1,n\\} \\space \\space D_1(i) + D_2(i) + D_3(i) = 1\\)\nCe type de diagramme a été par exemple utilisé en minéralogie pour décrire la composition de roches composées de trois types de minéraux. Ou bien en économie dans la théorie de Rostow pour décrire le passage d’une économie du secteur primaire au secteur secondaire et finalement tertiaire.\nDans une perspective plus abstraite, la géométrie ternaire est une variante intéressante du monde de l’échiqier qui possède certaines propriétés singulières.\n\nDonnées\nPour construire un monde triangulaire, nous allons transformer nos trois dimensions initiales \\(D_1, D_2, D_3\\) en coordonnées \\(x,y,z\\) en appliquant les transformations suivantes :\n\\[\n\\left\\{\n    \\begin{array}{lll}\n        x_i = \\frac{D_1(i)}{D_1(i)+D_2(i)+D_3(i)}  \\\\\n        y_i = \\frac{D_2(i)}{D_1(i)+D_2(i)+D_3(i)}  \\\\\n        z_i = \\frac{D_3(i)}{D_1(i)+D_2(i)+D_3(i)}   \n    \\end{array}\n\\right.\n\\]\nMais on peut aussi considérer s’il n’y a que deux dimensions finies que la troisième coordonnée est la moyenne des complémentaire des deux précédentes, ce qui donne :\n\\[\n\\left\\{\n    \\begin{array}{lll}\n        \\omega(i) = \\frac{(max(D_1)-D_1(i)) + (max(D_2)-D_2(i))}{2}\\\\\n        x_i = \\frac{D_1(i)}{D_1(i)+D_2(i)+\\omega(i)}  \\\\\n        y_i = \\frac{D_2(i)}{D_1(i)+D_2(i)+\\omega(i)}  \\\\\n        z_i = \\frac{D_3(i)}{D_1(i)+D_2(i)+\\omega(i)}   \n    \\end{array}\n\\right.\n\\]\nDans notre exemple, les deux dimensions \\(D_1\\) et \\(D_2\\) ont chacune un maximum de 100 de sorte qu’on peut en déduire facilement une troisième coordonnée sans faire intervenir une dimension supplémentaire\n\n\n\nCoordonnées triangulaires\n\n\n\nx\ny\nz\n\n\n\n\nA\n0.01\n0.39\n0.61\n\n\nB\n0.11\n0.59\n0.30\n\n\nC\n0.19\n0.05\n0.75\n\n\nD\n0.18\n0.47\n0.35\n\n\nE\n0.34\n0.22\n0.43\n\n\nF\n0.34\n0.35\n0.31\n\n\nG\n0.35\n0.41\n0.24\n\n\nH\n0.38\n0.32\n0.30\n\n\nI\n0.50\n0.12\n0.38\n\n\nJ\n0.42\n0.48\n0.10\n\n\nK\n0.49\n0.25\n0.26\n\n\nL\n0.63\n0.10\n0.27\n\n\n\n\n\n\n\nVisualisation\nCompte-tenu des spécificités des liaisons entre les trois coordonnées (métrique oblilinéaire), il est préférable de faire appel à des packages spécialisés pour visualiser les points dans ce type de géométrie.\n\n\n\n\n\n\nVisualisation de diagrammes ternaires dans R\n\n\n\n\n\nIl existe un grand nombre de packages dédiés à la visualisation de diagramme ternaires dans R, parmi lesquels on peut citer ggtern, plotlyet Ternary. Le choix de l’un ou l’autre de ces packages dépend des objectifs poursuivis. Nous optons ici pour le package Ternaryqui offre de nombreuses possibilités de visualisation mais aussi de traitement.\n\nggtern est une extension de ggplot2 mise au point par Nicholas Hamilton et est donc bien adapté à des visualisations statiques pour les personnes habituées à la logique de ggplot2.\nplotly permet grâce à son type d’objet scatterternaryde construire des diagrammes ternaires dynamiques bien adaptés au web. Mais il comporte également des outils assez raffinés de délimitation de lignes ou de zones à l’intérieur de ces diagrammes.\nTernary semble enfin le plus prometteur pour notre objectif car il offre non seulement des possibilités de visualisation mais aussi de traitement, notamment pour le calcul de densités et le tracé des isolignes associées.\n\nMais il en existe sans nul doute d’autres …\n\n\n\n\n\n\n\n\n\n\nDistance\nIl existe de nombreuses distances possibles dans un triangle, mais l’une des plus logique semble être la distance oblilinéaire qui corresspond au plus court chemin en ne se déplaçant que selon l’une des trois directions du triangle. La distance sera plus ou moins longue selon que l’on passe par les axes \\((x,y)\\), \\((y,z)\\) ou \\((x,z)\\). On choisira donc la distance la plus courte parmi les trois types d’itinéraires\n\\(D^{xy}(i,j) = |x_i-x_j| + |y_i-y_j|\\)\n\\(D^{yz}(i,j) = |y_i-y_j| + |z_i-z_j|\\)\n\\(D^{xz}(i,j) = |x_i-x_j| + |z_i-z_j|\\)\n\\(D_{min}^{xyz}(i,j) = min(D^{xy}(i,j), D^{yz}(i,j), D^{xz}(i,j))\\)\nPar exemple si on considère les point \\(i(0,50,50)\\) et le point \\(j(50,20,30)\\) on a :\n\\(D^{xy}(i,j) = |0-50| + |50-20| = 80\\)\n\\(D^{yz}(i,j) = |50-20| + |50-30| = 50\\)\n\\(D^{xz}(i,j) = |0-50| + |50-30| = 70\\)\n\\(D_{min}^{xyz}(i,j) = min(80, 50, 70) = 50\\)\nLe plus court chemin est donc ici celui qui emprunte les axes \\(y\\) et \\(z\\) mais, comme dans le cas de la distance de Manhattan, il existe une infinité d’itinéraires possibles entre les deux points qui respectent la condition de plus court chemin et qui correspondent à un trapèze.\n\n\n\n\n\nLa matrice de distance entre nos 12 points pour cette métrique de plus court chemin oblilinéaire est la suivante\n\n\n\nDistance oblilinéaire\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA\nB\nC\nD\nE\nF\nG\nH\nI\nJ\nK\nL\n\n\n\n\nA\n0.00\n0.30\n0.33\n0.26\n0.34\n0.33\n0.37\n0.37\n0.49\n0.50\n0.48\n0.62\n\n\nB\n0.30\n0.00\n0.53\n0.11\n0.36\n0.23\n0.24\n0.27\n0.46\n0.31\n0.38\n0.52\n\n\nC\n0.33\n0.53\n0.00\n0.42\n0.32\n0.45\n0.52\n0.46\n0.38\n0.65\n0.49\n0.48\n\n\nD\n0.26\n0.11\n0.42\n0.00\n0.25\n0.16\n0.17\n0.20\n0.35\n0.25\n0.32\n0.45\n\n\nE\n0.34\n0.36\n0.32\n0.25\n0.00\n0.13\n0.20\n0.13\n0.15\n0.33\n0.17\n0.28\n\n\nF\n0.33\n0.23\n0.45\n0.16\n0.13\n0.00\n0.07\n0.04\n0.23\n0.20\n0.15\n0.29\n\n\nG\n0.37\n0.24\n0.52\n0.17\n0.20\n0.07\n0.00\n0.09\n0.29\n0.13\n0.17\n0.31\n\n\nH\n0.37\n0.27\n0.46\n0.20\n0.13\n0.04\n0.09\n0.00\n0.20\n0.19\n0.12\n0.25\n\n\nI\n0.49\n0.46\n0.38\n0.35\n0.15\n0.23\n0.29\n0.20\n0.00\n0.35\n0.12\n0.13\n\n\nJ\n0.50\n0.31\n0.65\n0.25\n0.33\n0.20\n0.13\n0.19\n0.35\n0.00\n0.23\n0.37\n\n\nK\n0.48\n0.38\n0.49\n0.32\n0.17\n0.15\n0.17\n0.12\n0.12\n0.23\n0.00\n0.14\n\n\nL\n0.62\n0.52\n0.48\n0.45\n0.28\n0.29\n0.31\n0.25\n0.13\n0.37\n0.14\n0.00\n\n\n\n\n\n\n\nPartition\n\n\n\n\n\nL’arbre nous suggère 3 classes que l’on peut visualiser ainsi :\n\n\n\n\n\n\n\nDensité\nLe package Ternary offre a première vue une fonction de calcul des densités ce qui facilité l’analyse des pics de concentration à différentes échelles selon un paramètre bandwidth (Bw).\n\n\n\n\n\nOn repère bien sur les deux figures la façon dont s’opère la fusion des pics de densité et la possibilité que cela offre de définir des régionalisations multi-scalaires. Mais il faudrait vérifier si le package utilise bien la distance oblilinéaire plutôt qu’une simple distance euclidienne ce qui ne serait pas logique par rapport aux hypothèses précédentes. Or, on a bien l’impression au vu des figures que le calcul est effectué en distance euclidienne puisque des cercles apparaissent autour des points isolés."
  },
  {
    "objectID": "geom_doc.html#b.4-le-monde-est-un-tore",
    "href": "geom_doc.html#b.4-le-monde-est-un-tore",
    "title": "Géometries de mondes abstraits",
    "section": "B.4 Le monde est un tore",
    "text": "B.4 Le monde est un tore\n\n\n\nSource : Wyrd Smythe, 2021, Flat Space of Torus\n\n\n\n\n\n\n\n\n\n\n\n\n\nLe tore comme variété à deux dimensions\n\n\n\n\n\n\nLa nature circulaire des angles fait que l’angle bivarié \\((\\theta,\\phi)\\) est sur le tore, qui peut être intégré comme une variété (manifold) bidimensionnelle dans \\(R^3\\), et peut être coupé et aplati comme un carré \\(T^2 = [-\\pi,\\pi) \\times [-\\pi,\\pi)\\) sur \\(R^2\\). Par conséquent, un \\((-\\pi,-\\pi)\\) est plus proche de \\((\\pi - \\epsilon ,\\pi - \\epsilon )\\) que \\((-\\pi +2 ,-\\pi +2 )\\) pour un certain \\(\\epsilon &gt;0\\). En raison de cette contrainte géométrique, la plupart des méthodes de clustering prêtes à l’emploi ne sont pas applicables, du moins pas sans une adaptation appropriée.\n\nSource : Jung, Park, et Kim (2021)\n\n\n\n\nDonnées\nComme dans le cas du monde circulaure On transforme les coordonnées \\(D_1\\) en positions angulaires sur le cercle dans le sens trigonométrique \\(\\theta_1 ...\\theta_{12}\\) et on effectue la même opération pour \\(D_2\\) afin d’obtenir un second jeu de coordonnées \\(\\phi_1 ...\\phi_{12}\\) comprises dans l’intervalle \\([-\\pi ; +\\pi]\\) (ou \\([0; 2\\pi]\\) ce qui revient au même). Comme nos dimension avaient été tirées au sort sur l’intervalle \\([0 ; 100]\\) on applique la transformation suivante :\n\\(\\theta(i) = \\frac{2 \\pi D_1(i)}{100}-\\pi\\) \\(\\phi(i) = \\frac{2 \\pi D_2(i)}{100}-\\pi\\)\n\n\n\n\n\n\ntheta\nphi\n\n\n\n\nA\n-3.0787608\n-0.1256637\n\n\nB\n-2.0734512\n2.5132741\n\n\nC\n-1.7592919\n-2.7646015\n\n\nD\n-1.5079645\n1.2566371\n\n\nE\n-0.1256637\n-1.1938052\n\n\nF\n0.1256637\n0.2513274\n\n\nG\n0.3769911\n1.0681415\n\n\nH\n0.5026548\n0.0000000\n\n\nI\n1.3823008\n-2.0106193\n\n\nJ\n1.6336282\n2.2619467\n\n\nK\n1.7592919\n-0.6911504\n\n\nL\n3.0787608\n-2.1362830\n\n\n\n\n\n\n\nVisualisation\nComme il est difficile de produire une visualisation d’un tore en trois dimensions sans que certains points soient cachés, on va utiliser ici une représentation en deux dimensions qui semble identique visuellement à celle monde de l’échiquier mais qui doit s’interpréter différemment.\n\n\n\n\n\n\nFigures à améliorer en réduisant les coordonnées à -pi / +pi et en éliminant la marge\n\n\n\nDistance\nOn peut utiliser la fonction du package circularutilisées précédement pour calculer les distances sur le cercle en l’appliquant à chacune des dimensions. On obtient alors une distance \\(D^\\theta\\) et une distance \\(D^\\phi\\) que l’on peut combiner de différentes façons pour construire une distance sur le tore. La solution la plus simple est évidemment de les additionner ce qui revient à une forme de distance orthogonale sur le tore, analogue à la distance de Manhattan dans un plan euclidien avec une distance maximale égale à \\(2\\pi\\)\n\\(D^{orth}(i,j) = |\\theta_i-\\theta_j| +|\\phi_i-\\phi_j|\\)\nMais on peut également essayer de construire une distance équivalente à la distance euclidienne qui impliquerait des déplacements en oblique sur le tore déplié et serait alors plus courte que la distance de Manhattan. Cette solution revient à calculer la distance angulaire dans un espace à p dimensions.\n\\(D^{Ang}(i,j) = |\\widehat{i,j}|\\)\nLa valeur maximale de distance angulaire est alors égale à \\(2\\pi/\\sqrt{2}\\). On peut facilement calculer cette distance angulaire à l’aide de la fonction ang.pdist du package ClusTorus proposé par Jung, Park, et Kim (2021).\nPour illustrer ces deux distances, considérons à titre d’exemple les points \\(C\\) et \\(J\\) situés respectivement en bas à gauche et enhaut à droite de la figure précédente. A première vue ils semblent très éloignés (dans un monde de type échiquier) mais ils sont en fait très proche dans la géométrie du tore où l’on ressort d’un côté pour rentrer par l’autre.\n\n\n\n\n\nSi on retient la distance angulaire et qu’on la normalise en la divisant par \\(2\\pi/\\sqrt(2)\\) pour arriver à une distance maximale de 1, la matrice de distance entre nos points est la suivante :\n\n\n\nDistance orthogonale sur le tore\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA\nB\nC\nD\nE\nF\nG\nH\nI\nJ\nK\nL\n\n\n\n\nA\n0.000\n0.636\n0.664\n0.471\n0.707\n0.698\n0.691\n0.609\n0.590\n0.643\n0.349\n0.453\n\n\nB\n0.636\n0.000\n0.237\n0.310\n0.727\n0.710\n0.640\n0.810\n0.750\n0.583\n0.886\n0.447\n\n\nC\n0.664\n0.237\n0.000\n0.512\n0.510\n0.800\n0.732\n0.804\n0.727\n0.709\n0.778\n0.355\n\n\nD\n0.471\n0.310\n0.512\n0.000\n0.633\n0.432\n0.426\n0.534\n0.940\n0.742\n0.808\n0.754\n\n\nE\n0.707\n0.727\n0.510\n0.633\n0.000\n0.330\n0.522\n0.304\n0.386\n0.750\n0.439\n0.725\n\n\nF\n0.698\n0.710\n0.800\n0.432\n0.330\n0.000\n0.192\n0.102\n0.582\n0.566\n0.424\n0.855\n\n\nG\n0.691\n0.640\n0.732\n0.426\n0.522\n0.192\n0.000\n0.242\n0.729\n0.390\n0.504\n0.922\n\n\nH\n0.609\n0.810\n0.804\n0.534\n0.304\n0.102\n0.242\n0.000\n0.494\n0.569\n0.323\n0.753\n\n\nI\n0.590\n0.750\n0.727\n0.940\n0.386\n0.582\n0.729\n0.494\n0.000\n0.456\n0.309\n0.383\n\n\nJ\n0.643\n0.583\n0.709\n0.742\n0.750\n0.566\n0.390\n0.569\n0.456\n0.000\n0.665\n0.535\n\n\nK\n0.349\n0.886\n0.778\n0.808\n0.439\n0.424\n0.504\n0.323\n0.309\n0.665\n0.000\n0.440\n\n\nL\n0.453\n0.447\n0.355\n0.754\n0.725\n0.855\n0.922\n0.753\n0.383\n0.535\n0.440\n0.000\n\n\n\n\n\n\n\nPartition\n\n\n\n\n\nL’arbre nous suggère 4 classes que l’on peut visualiser ainsi\n\n\n\n\n\nLa figure montre notamment un groupe régional composé des points \\((B,C,L)\\) qui semble contre-intuitif pour un regard habitué au monde-échiquier mais qui est parfaitement logique dans une monde en forme de tore.\n\n\nDensité"
  },
  {
    "objectID": "geom_doc.html#b.5-le-monde-est-une-sphère",
    "href": "geom_doc.html#b.5-le-monde-est-une-sphère",
    "title": "Géometries de mondes abstraits",
    "section": "B.5 Le monde est une sphère",
    "text": "B.5 Le monde est une sphère\n\n\n\nPool : tableau inspiré du poème d’Eluard “La terre est bleue comme une orange”\n\n\nLa représentation d’un monde comme une sphère est évidemment celle qui se rapproche le plus de l’intuition que peuvent avoir les lecteurs à qui on a enseigné que la Terre est une sphère légèrement aplatie au niveau des pôles. Il faut toutefois prendre garde que cette assimilation de notre Monde à une sphère est une abstraction et qu’elle peut être remise en cause d’au moins deux façons différentes :\n\nLa théorie de la terre plate : Bien que la phénomène soit difficile à évaluer, il demeure certain que dans de nombreux pays il existe une proportion importante de personnes qui estiment que la terre est plate. Certaines études suggèrent même que le phénomène aurait tendance à augmenter, notamment chez les plus jeunes : “La philosophie de la Terre plate existe depuis le XIXe siècle, mais elle a récemment pris de l’ampleur en ligne, en particulier sur YouTube et Twitter. Les croyants publient des vidéos et des mèmes qui défendent l’idée d’une Terre plate et avancent des théories du complot pour expliquer tout ce qui montre que la planète est en fait un globe terrestre.”source : Pappas S., “A Third of Young Millennials Are Confused About This Incontrovertible Fact”, Live Science\nLa science de la zone critique offre une objection de nature différente en soulignant que le Monde n’est pas une surface mais plutôt un volume compris entre deux sphères où se déroule l’ensemble de l’activité des êtres vivants, humains ou non. Ce concept de zone critique (earth’s critical zone) a été utilisé dans la littérature anglophone en 1998 par Gail Ashley , spécialiste américaine de sédimentologie(Council et al. 2001). Il a ensuite été introduit en français par le géochimiste français Jérôme Gaillardet (Gaillardet 2023) au milieu des années 2000 puis largement popularisé par Bruno Latour (Latour et Weibel 2020).\n\nOn retiendra donc juste ici l’idée que la sphère est une des projections possibles du Monde (empirique) dans un monde (abstrait).\n\nDonnées\nIl y a plusieurs façons de définir les coordonnées d’un point sur une sphère mais il suffit en pratique de deux coordonnées et non pas trois puisqu’il s’agit d’une variété d’ordre 2 projetée dans un espace de dimension 3. Nous pouvons utiliser les coordonnées en radian \\(\\lambda_i\\) et \\(\\theta_i\\) définies respectivement sur les intervalles \\([-\\frac{\\pi}{2} ; \\frac{\\pi}{2}]\\) et \\([-\\pi ; \\pi]\\). Mais l’on pourrait aussi bien les exprimer en degré pour retrouver les formulations habituelles en géographie de latitude et longitude définies respectivement sur les intervalles \\([-90 ; 90]\\) et \\([-180 ; 180]\\)\nNous convertissons les dimensions \\(D_1\\) et \\(D_2\\) précédentes en conservant leurs bornes initiales [0 ; 100] commes limites de l’espace après sa transformation sphérique.\n\n\n\n\n\n\nlambda\ntheta\nlatitude\nlongitude\n\n\n\n\nA\n-1.5393804\n-0.1256637\n-88.2\n-7.2\n\n\nB\n-1.0367256\n2.5132741\n-59.4\n144.0\n\n\nC\n-0.8796459\n-2.7646015\n-50.4\n-158.4\n\n\nD\n-0.7539822\n1.2566371\n-43.2\n72.0\n\n\nE\n-0.0628319\n-1.1938052\n-3.6\n-68.4\n\n\nF\n0.0628319\n0.2513274\n3.6\n14.4\n\n\nG\n0.1884956\n1.0681415\n10.8\n61.2\n\n\nH\n0.2513274\n0.0000000\n14.4\n0.0\n\n\nI\n0.6911504\n-2.0106193\n39.6\n-115.2\n\n\nJ\n0.8168141\n2.2619467\n46.8\n129.6\n\n\nK\n0.8796459\n-0.6911504\n50.4\n-39.6\n\n\nL\n1.5393804\n-2.1362830\n88.2\n-122.4\n\n\n\n\n\n\n\nVisualisation\nDans ce cas particulier de la sphère, nous disposons d’au moins deux modes de visualisation. Soit à l’aide de programmes géométriques de visualisation 3D utilisant les coordonnées sphériques \\((\\lambda, \\theta)\\), soit à l’aide de programmes géographiques qui attendent plutôt des coordonnées de latitude et longitude et permettent de les projeter de différentes manières dans le plan pour réaliser des cartes du monde.\nOn peut tout d’abord visualiser nos coordonnées dans le plan, ce qui correspondrait en géographie à une projection de Mercator (EPSG = 4326).\n\n\n\n\n\nMais on peut aussi effectuer différentes projections classiques de la géographie, appliquées ici à une sphère quelconque. La fonction plot_geo() du package plotly permet en outre de rendre ces cartes dynamiques et de permettre à l’utilisateur de changer l’azimuth des projections.\nSi l’on adopte par exemple la projection orthographique on ne peut visualiser qu’un seul hémisphère à la fois et on ne peut donc pas visualiser simultanément les 12 points pris en exemple.\n\n\n\n\n\n\nEn revance, si on adopte une projection azimuthal à surface égale, le monde devient un disque où apparaissent simultanément les deux hémisphères et où le cercle qui définit la bordure externe correspond en fait au point opposé au point central.\n\n\n\n\n\n\nCes trois exemples de projection suffisent à montrer la diversité des représentations planes d’une sphère. Et du même coup les illusions d’optiques qu’elles peuvent engendrer dans la perception des distances, des angles ou des surfaces…\n\n\nDistances\nLe calcul des distances entre points sur la sphère n’en demeure pas moins simple et peut être facilement réalisé avec des logiciels mathématiques ou géographiques. La différence étant que les premiers supposent une sphère parfaite alors que les seconds tiennent compte des irrégularités de l’ellipsoïde terrestre.\nComme précédemment on normalise cette distance par la valeur maximale possible sur une sphère soit \\(\\pi R\\) avec \\(R\\) le rayon de la sphère.\n\n\n\nDistance sphérique normalisée\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA\nB\nC\nD\nE\nF\nG\nH\nI\nJ\nK\nL\n\n\n\n\nA\n0.000\n0.179\n0.229\n0.258\n0.476\n0.511\n0.557\n0.571\n0.724\n0.768\n0.772\n0.990\n\n\nB\n0.179\n0.000\n0.184\n0.252\n0.623\n0.624\n0.532\n0.711\n0.714\n0.594\n0.949\n0.831\n\n\nC\n0.229\n0.184\n0.000\n0.426\n0.485\n0.738\n0.716\n0.778\n0.543\n0.641\n0.790\n0.772\n\n\nD\n0.258\n0.252\n0.426\n0.000\n0.674\n0.388\n0.305\n0.485\n0.965\n0.575\n0.747\n0.750\n\n\nE\n0.476\n0.623\n0.485\n0.674\n0.000\n0.462\n0.720\n0.390\n0.339\n0.745\n0.330\n0.515\n\n\nF\n0.511\n0.624\n0.738\n0.388\n0.462\n0.000\n0.261\n0.099\n0.649\n0.579\n0.361\n0.488\n\n\nG\n0.557\n0.532\n0.716\n0.305\n0.720\n0.261\n0.000\n0.332\n0.720\n0.375\n0.492\n0.450\n\n\nH\n0.571\n0.711\n0.778\n0.485\n0.390\n0.099\n0.332\n0.000\n0.551\n0.578\n0.268\n0.426\n\n\nI\n0.724\n0.714\n0.543\n0.965\n0.339\n0.649\n0.720\n0.551\n0.000\n0.423\n0.290\n0.270\n\n\nJ\n0.768\n0.594\n0.641\n0.575\n0.745\n0.579\n0.375\n0.578\n0.423\n0.000\n0.458\n0.243\n\n\nK\n0.772\n0.949\n0.790\n0.747\n0.330\n0.361\n0.492\n0.268\n0.290\n0.458\n0.000\n0.219\n\n\nL\n0.990\n0.831\n0.772\n0.750\n0.515\n0.488\n0.450\n0.426\n0.270\n0.243\n0.219\n0.000\n\n\n\n\n\n\n\nPartition\nOn applique la méthode habituelle de classification :\n\n\n\n\n\nL’arbre nous suggère 4 classes que l’on peut visualiser en reprenant l’une des projections précédentes. La visualisation en projection de Mercator rassemble les points apparamment très éloignés mais en fait très proches car situés sur les pôles comme A, B et C.\n\n\n\n\n\nOn se rend mieux compte des proximités en visualisant les points dans une projection orthographique où l’on peut faire tourner la sphère pour mieux percevoir les proximités des points ce chacune des classes\n\n\n\n\n\n\n\n\nDensité\nComme dans le cas du tore, la vsualisation des densités de probabilité sur la sphère doit faire appel à des packages spécialisés. Nous utilisons ici le package sm qui semble bien adapaté à l’objectif tant sur le plan statistique (utilisation de méthodes de lissage non paramétriques sur distances sphériques) que sur le plan des possibilités de visualisation.\n\n\n\n\n\n\nLe package sm et les méthodes de lissage non paramétriques\n\n\n\n\n\nLe package sm a été créé par ses auteurs pour illustrer une famille de méthodes de lissage non paramétriques décrités dans Bowman et Azzalini (1997). La finalité du package est décrite comme suit par ses auteurs :\n\nLes fonctions de ce paquetage utilisent des méthodes de noyau pour construire des estimations non paramétriques des fonctions de densité et des courbes de régression dans une variété de contextes, et pour effectuer certaines opérations inférentielles.\n\n\nEn particulier, les estimations de densité peuvent être construites pour des données à 1, 2 et 3 dimensions. La régression non paramétrique pour les données continues peut être construite avec une ou deux covariables, et une variété de tests peut être effectuée. Plusieurs autres types de données peuvent être traités, notamment les données de survie, les séries temporelles, les données de comptage et les données binomiales.\n\n\nSource : « sm: Smoothing Methods for Nonparametric Regression and Density Estimation » (1999)\n\n\n\n\nA titre d’exemple, on peut examiner la distribution des densités de probabilité pour deux valeurs du paramètre kappa = 10 (lissage faible) ou kappa = 5 (lissage plus fort) :\n\n\n\n\n\n\n\n\n\n\nComme dans les exemples précédents, on repère bien la façon dont les points isolés fusionnent dans des pics de densité de plus en plus large, ce qui permet de construire des régions en suivant les vallées qui séparent ces pics de concentration, comme nous le faisons habituellement dans le plan."
  },
  {
    "objectID": "geom_doc.html#d.1-le-monde-est-un-graphe-planaire",
    "href": "geom_doc.html#d.1-le-monde-est-un-graphe-planaire",
    "title": "Géometries de mondes abstraits",
    "section": "D.1 Le monde est un graphe planaire",
    "text": "D.1 Le monde est un graphe planaire"
  },
  {
    "objectID": "geom_doc.html#d.1-le-monde-est-un-graphe-non-planaire",
    "href": "geom_doc.html#d.1-le-monde-est-un-graphe-non-planaire",
    "title": "Géometries de mondes abstraits",
    "section": "D.1 Le monde est un graphe non planaire",
    "text": "D.1 Le monde est un graphe non planaire"
  },
  {
    "objectID": "classifregio_exo.html",
    "href": "classifregio_exo.html",
    "title": "Classification/Régionalisation",
    "section": "",
    "text": "Mise en place : Télécharger le dossier exo_autocor.zip et décompressez le sur votre ordinateur. Puis créez un projet R avant d’executer le programme\nVous allez choisir une ou plusieurs régions voisines hors Ile-de-France (données imparfaites pour Paris)\n“ALSACE-CHAMPAGNE-ARDENNE-LORRAINE”\n“AQUITAINE-LIMOUSIN-POITOU-CHARENTES” “AUVERGNE-RHONE-ALPES”\n“BOURGOGNE-FRANCHE-COMTE”\n“BRETAGNE”\n“CENTRE-VAL DE LOIRE”\n“LANGUEDOC-ROUSSILLON-MIDI-PYRENEES” “NORD-PAS-DE-CALAIS-PICARDIE”\n“NORMANDIE”\n“PAYS DE LA LOIRE”\n“PROVENCE-ALPES-COTE D’AZUR”\nRecopiez leurs noms ci-dessous :\nmyreg &lt;- c(\"LANGUEDOC-ROUSSILLON-MIDI-PYRENEES\")"
  },
  {
    "objectID": "classifregio_exo.html#tableau-de-données",
    "href": "classifregio_exo.html#tableau-de-données",
    "title": "Classification/Régionalisation",
    "section": "Tableau de données",
    "text": "Tableau de données\n\n### Données\ndon&lt;-readRDS(\"data/elect2024/don_reg.RDS\")\ncode&lt;-as.factor(don$nom_reg)\nlevels(code)&lt;-c(\"ACAL\", \"AQUI\",\"AURA\",\"BOFC\",\"BRET\",\"CVDL\",\"IDF\",\"OCCI\",\"NOPI\",\"NORM\",\"PDL\",\"PACA\")\ntab&lt;-as.matrix(don[,3:12])\nrownames(tab)&lt;-code\nkable(tab, digits=1, caption = \"Résultats des européeennes 2024 par région\")\n\n\nRésultats des européeennes 2024 par région\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAubry\nBardella\nBellamy\nDeffontaines\nGlucksman\nHayer\nLassale\nMarechal\nToussaint\nAutres\n\n\n\n\nACAL\n7.6\n38.3\n7.6\n1.6\n10.8\n14.4\n1.9\n5.5\n4.1\n8.2\n\n\nAQUI\n6.8\n30.9\n6.5\n2.9\n16.0\n14.8\n4.7\n5.0\n5.3\n7.2\n\n\nAURA\n9.5\n30.9\n8.0\n2.3\n13.8\n14.2\n2.1\n5.6\n6.2\n7.4\n\n\nBOFC\n7.0\n37.1\n7.5\n2.3\n12.2\n13.8\n2.9\n5.3\n4.4\n7.6\n\n\nBRET\n7.1\n25.6\n7.5\n2.6\n18.4\n17.4\n2.3\n4.2\n7.3\n7.6\n\n\nCVDL\n7.4\n34.9\n7.5\n2.6\n12.5\n15.1\n2.6\n5.4\n4.4\n7.5\n\n\nIDF\n18.6\n18.8\n8.8\n2.0\n15.8\n15.5\n0.8\n5.7\n7.0\n7.1\n\n\nOCCI\n9.0\n33.7\n5.5\n2.7\n15.5\n12.2\n3.8\n5.5\n5.1\n7.0\n\n\nNOPI\n8.4\n42.4\n6.1\n3.1\n9.0\n12.9\n2.5\n4.6\n3.6\n7.4\n\n\nNORM\n6.9\n35.3\n6.9\n2.8\n13.3\n15.7\n2.7\n4.6\n4.4\n7.3\n\n\nPDL\n7.1\n27.6\n7.9\n2.1\n16.1\n17.9\n2.1\n4.7\n7.1\n7.3\n\n\nPACA\n9.7\n38.6\n6.4\n2.1\n10.5\n12.3\n1.5\n7.7\n4.2\n6.9"
  },
  {
    "objectID": "classifregio_exo.html#analyse-en-composantes-principales",
    "href": "classifregio_exo.html#analyse-en-composantes-principales",
    "title": "Classification/Régionalisation",
    "section": "Analyse en composantes principales",
    "text": "Analyse en composantes principales\nOn utilise la procédure PCA de FactoMineR que la plupart des étudiants connaissent :\n\nacp&lt;-PCA(tab,  scale.unit = T)\n\n\n\n\n\n\nsummary(acp)\n\n\nCall:\nPCA(X = tab, scale.unit = T) \n\n\nEigenvalues\n                       Dim.1   Dim.2   Dim.3   Dim.4   Dim.5   Dim.6   Dim.7\nVariance               4.197   2.616   1.854   0.615   0.380   0.180   0.088\n% of var.             41.969  26.158  18.538   6.152   3.805   1.799   0.883\nCumulative % of var.  41.969  68.127  86.665  92.817  96.622  98.421  99.303\n                       Dim.8   Dim.9  Dim.10\nVariance               0.051   0.018   0.000\n% of var.              0.512   0.185   0.000\nCumulative % of var.  99.815 100.000 100.000\n\nIndividuals (the 10 first)\n                 Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3\nACAL         |  3.751 | -0.631  0.790  0.028 | -1.970 12.365  0.276 |  2.932\nAQUI         |  2.966 | -0.673  0.899  0.051 |  2.506 20.001  0.714 | -1.003\nAURA         |  1.378 |  0.911  1.648  0.437 | -0.631  1.267  0.209 | -0.075\nBOFC         |  1.637 | -0.989  1.943  0.365 | -0.325  0.337  0.039 |  1.002\nBRET         |  3.507 |  2.648 13.928  0.570 |  2.033 13.161  0.336 |  0.680\nCVDL         |  1.176 | -0.579  0.666  0.242 |  0.013  0.001  0.000 |  0.697\nIDF          |  5.120 |  4.138 34.003  0.653 | -2.230 15.836  0.190 | -1.610\nOCCI         |  3.134 | -1.618  5.199  0.267 |  1.111  3.930  0.126 | -2.107\nNOPI         |  3.620 | -3.037 18.310  0.704 |  0.276  0.242  0.006 |  0.332\nNORM         |  1.805 | -0.731  1.062  0.164 |  1.196  4.559  0.439 |  0.236\n                ctr   cos2  \nACAL         38.653  0.611 |\nAQUI          4.526  0.114 |\nAURA          0.025  0.003 |\nBOFC          4.510  0.375 |\nBRET          2.081  0.038 |\nCVDL          2.181  0.351 |\nIDF          11.648  0.099 |\nOCCI         19.947  0.452 |\nNOPI          0.495  0.008 |\nNORM          0.250  0.017 |\n\nVariables\n                Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3    ctr\nAubry        |  0.483  5.561  0.233 | -0.561 12.032  0.315 | -0.487 12.805\nBardella     | -0.938 20.984  0.881 | -0.113  0.486  0.013 |  0.293  4.631\nBellamy      |  0.818 15.932  0.669 | -0.326  4.062  0.106 |  0.336  6.086\nDeffontaines | -0.414  4.082  0.171 |  0.728 20.278  0.530 | -0.300  4.862\nGlucksman    |  0.734 12.835  0.539 |  0.547 11.432  0.299 | -0.263  3.744\nHayer        |  0.771 14.152  0.594 |  0.377  5.424  0.142 |  0.369  7.328\nLassale      | -0.453  4.882  0.205 |  0.762 22.212  0.581 | -0.141  1.077\nMarechal     | -0.248  1.470  0.062 | -0.759 22.019  0.576 | -0.417  9.363\nToussaint    |  0.918 20.091  0.843 |  0.218  1.810  0.047 | -0.183  1.799\nAutres       |  0.022  0.012  0.000 | -0.080  0.244  0.006 |  0.946 48.306\n               cos2  \nAubry         0.237 |\nBardella      0.086 |\nBellamy       0.113 |\nDeffontaines  0.090 |\nGlucksman     0.069 |\nHayer         0.136 |\nLassale       0.020 |\nMarechal      0.174 |\nToussaint     0.033 |\nAutres        0.896 |\n\n\n\nCommentaires :\n\nL’axe 1 résume … % de l’information et oppose les régons … aux régions …\nL’axe 2 résume … % de l’information et oppose les régons … aux régions …\nLa position de notre région dans le plan factoriel montre …\n\n\n\nClassification ascendante hiérarchique\nVous allez ensuite classer les régions en choisissant le nombre de classes adapté (ici 2)\n\ncah&lt;-HCPC(acp, nb.clust = 2, graph=F)\nplot(cah,choice = \"tree\")\n\n\n\ncatdes(cah$data.clust,num.var = 11)\n\n\nLink between the cluster variable and the quantitative variables\n================================================================\n               Eta2      P-value\nToussaint 0.8488306 2.078509e-05\nBardella  0.6496145 1.547239e-03\nBellamy   0.4853048 1.182744e-02\nHayer     0.4123888 2.434807e-02\nGlucksman 0.3982128 2.777675e-02\n\nDescription of each cluster by quantitative variables\n=====================================================\n$`1`\n             v.test Mean in category Overall mean sd in category Overall sd\nBardella   2.673155        36.421230    32.856784      3.2746565  6.2543056\nGlucksman -2.092926        12.479180    13.668880      2.2551663  2.6662135\nHayer     -2.129854        13.884500    14.674870      1.2455553  1.7405712\nBellamy   -2.310487         6.736277     7.178515      0.7116798  0.8977669\nToussaint -3.055673         4.460683     5.271143      0.5157216  1.2440455\n              p.value\nBardella  0.007514144\nGlucksman 0.036355724\nHayer     0.033183685\nBellamy   0.020861182\nToussaint 0.002245561\n\n$`2`\n             v.test Mean in category Overall mean sd in category Overall sd\nToussaint  3.055673         6.892064     5.271143      0.4122303  1.2440455\nBellamy    2.310487         8.062990     7.178515      0.4811800  0.8977669\nHayer      2.129854        16.255609    14.674870      1.4959422  1.7405712\nGlucksman  2.092926        16.048281    13.668880      1.6316290  2.6662135\nBardella  -2.673155        25.727894    32.856784      4.4351597  6.2543056\n              p.value\nToussaint 0.002245561\nBellamy   0.020861182\nHayer     0.033183685\nGlucksman 0.036355724\nBardella  0.007514144\n\n\n\nCommentaire : La classification met en évidence deux grands types de région.\n\nLa classe 1 ( …) correspond à des régions qui ont significativement plus voté pour la.les listes … et moins voté pour la.les listes …\nLa classe 2 (…) correspond à des régions qui ont significativement plus voté pour la.les listes … et moins voté pour la.les listes …\nnotre région appartient à la classe …\n\n\n\n\nClassification ascendante hiérarchique\n\ncah&lt;-HCPC(acp, nb.clust = 4, graph=F)\nplot(cah,choice = \"tree\")\n\n\n\ncatdes(cah$data.clust,num.var = 11)\n\n\nLink between the cluster variable and the quantitative variables\n================================================================\n               Eta2      P-value\nAubry     0.9124509 0.0001394206\nLassale   0.8415963 0.0014477425\nBardella  0.8222734 0.0022737740\nToussaint 0.7840109 0.0048701089\nGlucksman 0.7619830 0.0071046385\nHayer     0.6672698 0.0258211127\nBellamy   0.6437010 0.0335083603\n\nDescription of each cluster by quantitative variables\n=====================================================\n$`1`\n           v.test Mean in category Overall mean sd in category Overall sd\nLassale  2.693611         4.244989     2.479399      0.4051319  0.9722238\nBellamy -1.972241         5.984768     7.178515      0.5017091  0.8977669\n            p.value\nLassale 0.007068261\nBellamy 0.048582150\n\n$`2`\n             v.test Mean in category Overall mean sd in category Overall sd\nBardella   2.479272        36.808111    32.856784      3.3283332   6.254306\nToussaint -2.458332         4.491822     5.271143      0.7542412   1.244045\nGlucksman -2.830897        11.745529    13.668880      1.5835472   2.666213\n              p.value\nBardella  0.013165079\nToussaint 0.013958414\nGlucksman 0.004641762\n\n$`3`\n            v.test Mean in category Overall mean sd in category Overall sd\nHayer     2.550464        17.667821    14.674870     0.25732059   1.740571\nToussaint 2.293669         7.194924     5.271143     0.08772127   1.244045\nGlucksman 2.012458        17.286396    13.668880     1.15061744   2.666213\n             p.value\nHayer     0.01075797\nToussaint 0.02180951\nGlucksman 0.04417165\n\n$`4`\n            v.test Mean in category Overall mean sd in category Overall sd\nAubry     3.144405         18.56756      8.75000              0   3.122231\nBardella -2.249315         18.78888     32.85678              0   6.254306\n             p.value\nAubry    0.001664248\nBardella 0.024492492\n\n\n\nCommentaire : Ma région …"
  },
  {
    "objectID": "classifregio_exo.html#préparation-des-données",
    "href": "classifregio_exo.html#préparation-des-données",
    "title": "Classification/Régionalisation",
    "section": "Préparation des données",
    "text": "Préparation des données\nOn effectue cette fois-ci une jointure entre les données départementales et le fonds de carte correspondant afin de pouvoir produire des cartes.\n\n### Fonds de carte région (pour habillage)\nmapreg&lt;-st_read(\"data/elect2024/map_reg.shp\", quiet=T) %&gt;%\n      st_transform(2154)\n\n### Fonds de carte dept\nmap&lt;-st_read(\"data/elect2024/map_dept.shp\", quiet=T) %&gt;%\n      select(code=code_dpt,  geometry) %&gt;%\n      st_transform(2154)\n\n### Données\ndon&lt;-readRDS(\"data/elect2024/don_dept.RDS\") %&gt;%\n          select(code=code_dpt, nom=nom_dpt, 5:14)\n\n### Jointure\nmapdon&lt;-left_join(map[,1],don)"
  },
  {
    "objectID": "classifregio_exo.html#cartographie-rapide",
    "href": "classifregio_exo.html#cartographie-rapide",
    "title": "Classification/Régionalisation",
    "section": "Cartographie rapide",
    "text": "Cartographie rapide\nOn visualise rapidement les scores de chaque parti pour avoir une idée de leur répartition. Il est évidemment possible de faire des cartes plus belles !\n\nplot(mapdon[4:13])"
  },
  {
    "objectID": "classifregio_exo.html#analyse-en-composantes-principales-1",
    "href": "classifregio_exo.html#analyse-en-composantes-principales-1",
    "title": "Classification/Régionalisation",
    "section": "Analyse en composantes principales",
    "text": "Analyse en composantes principales\nOn utilise la même procédure que pour les régions\n\ntab&lt;-mapdon[,4:13] %&gt;% st_drop_geometry()\nrow.names(tab)&lt;- mapdon$code\nacp&lt;-PCA(tab,  scale.unit = T)\n\n\n\n\n\n\nsummary(acp)\n\n\nCall:\nPCA(X = tab, scale.unit = T) \n\n\nEigenvalues\n                       Dim.1   Dim.2   Dim.3   Dim.4   Dim.5   Dim.6   Dim.7\nVariance               3.270   2.240   1.496   1.060   0.745   0.483   0.372\n% of var.             32.696  22.401  14.962  10.604   7.452   4.827   3.723\nCumulative % of var.  32.696  55.097  70.060  80.664  88.115  92.943  96.666\n                       Dim.8   Dim.9  Dim.10\nVariance               0.261   0.073   0.000\n% of var.              2.607   0.728   0.000\nCumulative % of var.  99.272 100.000 100.000\n\nIndividuals (the 10 first)\n                 Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3\n01           |  1.707 | -0.150  0.007  0.008 | -1.602  1.219  0.880 |  0.310\n02           |  3.793 | -3.324  3.594  0.768 | -0.814  0.314  0.046 | -0.023\n03           |  3.855 | -1.729  0.972  0.201 |  1.607  1.227  0.174 |  0.752\n04           |  2.263 | -0.859  0.240  0.144 |  0.563  0.150  0.062 | -1.460\n05           |  2.129 |  1.026  0.343  0.232 |  0.382  0.069  0.032 | -0.598\n06           |  5.147 | -1.197  0.466  0.054 | -3.900  7.225  0.574 |  0.562\n07           |  1.276 | -0.356  0.041  0.078 |  0.353  0.059  0.077 | -0.613\n08           |  2.915 | -2.607  2.211  0.800 | -0.709  0.239  0.059 |  0.376\n09           |  4.097 | -0.631  0.130  0.024 |  2.969  4.187  0.525 | -1.999\n10           |  3.138 | -1.926  1.206  0.376 | -1.711  1.390  0.297 |  1.034\n                ctr   cos2  \n01            0.069  0.033 |\n02            0.000  0.000 |\n03            0.402  0.038 |\n04            1.515  0.416 |\n05            0.254  0.079 |\n06            0.224  0.012 |\n07            0.267  0.231 |\n08            0.100  0.017 |\n09            2.841  0.238 |\n10            0.760  0.108 |\n\nVariables\n                Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3    ctr\nAubry        |  0.458  6.417  0.210 | -0.180  1.439  0.032 | -0.751 37.734\nBardella     | -0.941 27.083  0.886 | -0.187  1.557  0.035 |  0.105  0.743\nBellamy      |  0.379  4.397  0.144 | -0.343  5.237  0.117 |  0.637 27.137\nDeffontaines | -0.279  2.384  0.078 |  0.773 26.707  0.598 | -0.132  1.172\nGlucksman    |  0.735 16.508  0.540 |  0.577 14.837  0.332 |  0.020  0.026\nHayer        |  0.650 12.921  0.422 | -0.119  0.637  0.014 |  0.581 22.564\nLassale      | -0.311  2.965  0.097 |  0.761 25.839  0.579 |  0.266  4.732\nMarechal     | -0.185  1.046  0.034 | -0.611 16.681  0.374 |  0.057  0.214\nToussaint    |  0.925 26.178  0.856 |  0.057  0.146  0.003 | -0.129  1.105\nAutres       |  0.057  0.101  0.003 | -0.394  6.921  0.155 | -0.262  4.573\n               cos2  \nAubry         0.565 |\nBardella      0.011 |\nBellamy       0.406 |\nDeffontaines  0.018 |\nGlucksman     0.000 |\nHayer         0.338 |\nLassale       0.071 |\nMarechal      0.003 |\nToussaint     0.017 |\nAutres        0.068 |\n\n\n\nCommentaires : A priori ils sont assez vosins de ceux déja vus pour les régions\n\nL’axe 1 résume … % de l’information et oppose les régons … aux régions …\nL’axe 2 résume … % de l’information et oppose les régons … aux régions …\n\n\nOn va cette fois-ci cartographier les axes factoriels afin de mieux comprendre les oppositions spatiales qu’ils mettent en évidence et pour situer les départements de notre région :\n\nmapdon$axe1&lt;-acp$ind$coord[,1]\nmapdon$axe2&lt;-acp$ind$coord[,2]\n\npar(mfrow=c(1,2))\nmypal&lt;- brewer.pal(6, \"RdYlBu\")\nmybreaks&lt;-c(-10,-2,-1,0,1,2,10)\n\nmf_map(mapdon, type=\"choro\", var=\"axe1\", pal=mypal, breaks=mybreaks, lwd=0.1, border=\"white\")\nmf_map(mapreg, type=\"base\", col=NA, lwd=1, add=T)\nmf_layout(\"Axe1 (33%): Ecolo+Bobos Vs Prolos+Fachos ?\", frame=T)\n\nmf_map(mapdon, type=\"choro\", var=\"axe2\",pal=mypal, breaks=mybreaks, lwd=0.1, border=\"white\")\nmf_map(mapreg, type=\"base\", col=NA, lwd=1, add=T)\nmf_layout(\"Axe2 (22%) : Gauche Vs Droite ?\", frame=T)\n\n\n\n\n\nClassification ascendante hiérarchique\nVous allez ensuite classer les départements en choisissant le nombre de classes adapté (j’ai pris 4 mais on peut faire un choix différent)\n\ncah&lt;-HCPC(acp, nb.clust = 3, graph=F)\nplot(cah,choice = \"tree\")\n\n\n\ncatdes(cah$data.clust,num.var = 11)\n\n\nLink between the cluster variable and the quantitative variables\n================================================================\n                  Eta2      P-value\nBardella     0.5971187 1.085317e-18\nToussaint    0.5868101 3.426205e-18\nLassale      0.5335313 8.539308e-16\nGlucksman    0.5226421 2.440101e-15\nDeffontaines 0.4185499 1.928936e-11\nHayer        0.3603235 1.483196e-09\nMarechal     0.1478857 6.881012e-04\nAubry        0.1339412 1.440145e-03\n\nDescription of each cluster by quantitative variables\n=====================================================\n$`1`\n             v.test Mean in category Overall mean sd in category Overall sd\nBardella   6.976394        39.726945    33.884648       4.054609  7.4155479\nMarechal   3.596471         5.686227     5.337026       0.932885  0.8597853\nLassale   -1.988401         2.673761     3.079946       1.039553  1.8088826\nHayer     -4.164846        12.961003    14.112831       1.396425  2.4489474\nToussaint -5.705205         3.891450     4.895653       0.817938  1.5586223\nGlucksman -6.971136        11.081598    13.434096       1.736401  2.9882460\n               p.value\nBardella  3.028535e-12\nMarechal  3.225641e-04\nLassale   4.676734e-02\nHayer     3.115632e-05\nToussaint 1.162031e-08\nGlucksman 3.143924e-12\n\n$`2`\n                v.test Mean in category Overall mean sd in category Overall sd\nLassale       6.911539         5.655660     3.079946      1.8822244  1.8088826\nDeffontaines  6.132592         3.516519     2.529523      0.7656561  0.7811937\nGlucksman     3.137765        15.365838    13.434096      1.8852301  2.9882460\nAutres       -2.234648         7.043583     7.320773      0.4512943  0.6020832\nMarechal     -2.464580         4.900464     5.337026      0.4063327  0.8597853\n                  p.value\nLassale      4.794224e-12\nDeffontaines 8.645878e-10\nGlucksman    1.702416e-03\nAutres       2.544049e-02\nMarechal     1.371738e-02\n\n$`3`\n                v.test Mean in category Overall mean sd in category Overall sd\nToussaint     7.290583         6.535799     4.895653      1.3155696  1.5586223\nHayer         5.769028        16.152039    14.112831      2.7410936  2.4489474\nGlucksman     4.669887        15.448294    13.434096      2.5218415  2.9882460\nAubry         3.450912        10.507913     8.283339      6.5710953  4.4661535\nBellamy       2.345550         7.665869     7.122164      1.6174986  1.6059764\nDeffontaines -3.287260         2.158866     2.529523      0.4916698  0.7811937\nLassale      -3.766977         2.096427     3.079946      0.9632606  1.8088826\nBardella     -6.570856        26.851584    33.884648      6.0192932  7.4155479\n                  p.value\nToussaint    3.086155e-13\nHayer        7.973011e-09\nGlucksman    3.013658e-06\nAubry        5.586960e-04\nBellamy      1.899904e-02\nDeffontaines 1.011672e-03\nLassale      1.652365e-04\nBardella     5.002687e-11\n\n\n\nCommentaire : La classification met en évidence deux grands types de région.\n\nLa classe 1 ( …)\nLa classe 2 (…) .\nla classe 3 (…)\n…\n\n\nOn peut ensuite cartogaphier les classes correspondantes pour mieux voir la distribution spatiale. Cela suppose que l’on ait donné aux classes des noms suite à l’interprétation\n\nmapdon$cah&lt;-as.factor(cah$data.clust$clust)\nlevels(mapdon$cah)&lt;-c(\"Classe 1 : Fachos ?\", \n                      \"Classe 2 = Gauchos ?\",\n                      \"Classe 3 = Bobos \")\n\n\npar(mfrow=c(1,1))\n\nmf_map(mapdon, type=\"typo\", var=\"cah\", lwd=0.1, border=\"white\", leg_title = \"Classes\")\nmf_map(mapreg, type=\"base\", col=NA, lwd=1, add=T)\nmf_layout(\"Typologie en trois classes aux noms ...discutables !\", frame=T,credits = \"\")\n\n\n\n\n\nCommentaire : Les différentes classes recouvrent souvent des départements voisins mais elles neforment pas des régions puisque chaque classe se compose de plusieurs blocs départementaux séparés. Seule la classe 1 forme presque une région d’un seul bloc."
  },
  {
    "objectID": "classifregio_exo.html#préparation-des-données-1",
    "href": "classifregio_exo.html#préparation-des-données-1",
    "title": "Classification/Régionalisation",
    "section": "Préparation des données",
    "text": "Préparation des données\nla préparation des données est la même que précédemment\n\n### Fonds de carte région (pour habillage)\nmapreg&lt;-st_read(\"data/elect2024/map_reg.shp\", quiet=T) %&gt;%\n      st_transform(2154)\n\n### Fonds de carte dept\nmap&lt;-st_read(\"data/elect2024/map_dept.shp\", quiet=T) %&gt;%\n      select(code=code_dpt,  geometry) %&gt;%\n      st_transform(2154)\n\n### Données\ndon&lt;-readRDS(\"data/elect2024/don_dept.RDS\") %&gt;%\n          select(code=code_dpt, nom=nom_dpt, 5:14)\n\n### Jointure\nmapdon&lt;-left_join(map[,1],don)"
  },
  {
    "objectID": "classifregio_exo.html#calcul-du-graphe-de-contiguïté",
    "href": "classifregio_exo.html#calcul-du-graphe-de-contiguïté",
    "title": "Classification/Régionalisation",
    "section": "Calcul du graphe de contiguïté",
    "text": "Calcul du graphe de contiguïté\nOn utilise la procédure poly2nb() du package spdep :\n\n# Table de voisinage\nmap_nb&lt;-spdep::poly2nb(mapdon,row.names = mapdon$code)\n\n# Table de poids\nmap_nb_w&lt;-nb2listw(map_nb)\nsummary(map_nb_w)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 94 \nNumber of nonzero links: 474 \nPercentage nonzero weights: 5.364418 \nAverage number of links: 5.042553 \nLink number distribution:\n\n 2  3  4  5  6  7  8 10 \n 6 12 14 19 30 11  1  1 \n6 least connected regions:\n06 29 57 62 66 74 with 2 links\n1 most connected region:\n77 with 10 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 94 8836 94 40.29206 383.9874\n\n# Carte de voisinage\ncoo&lt;-st_coordinates(st_centroid(mapdon))\nmf_map(mapdon, type=\"base\",col=\"lightyellow\")\nmf_layout(\"Carte des liens de voisinage\", frame=T)\nplot.nb(map_nb,coords = coo,add = T,col = \"red\",points = F)\nmf_label(mapdon, var=\"code\", col=\"blue\",cex=0.6,halo = T, bg=\"white\",r = 0.1)\n\n\n\n\n\nCommentaire : On vérifie que le graphe est connexe et que chaque département a au moins un voisin. Certains départements situes aux extrémités du pays ont un seul voisin (ex. O6 Alpes Maritime ou 09 Finistère) tandis que d’autres ont jusqu’à 10 voisins (77 : Seine-et-Marne). Leurs possibilités de regroupement en région seront donc plus ou moins contraintes."
  },
  {
    "objectID": "classifregio_exo.html#calcul-de-la-matrice-de-dissimilarité",
    "href": "classifregio_exo.html#calcul-de-la-matrice-de-dissimilarité",
    "title": "Classification/Régionalisation",
    "section": "Calcul de la matrice de dissimilarité",
    "text": "Calcul de la matrice de dissimilarité\nNous devons calculer la matrice de dissimilarité directement à partir du tableau des variables standardisées.\n\n# choix des variables\ntab&lt;-mapdon[,4:13] %&gt;% st_drop_geometry()\nrow.names(tab)&lt;- mapdon$code\n\n# standardisation\ntabstd &lt;-scale(tab)\n\n# calcul des distances\nmatdis &lt;- as.matrix(dist(tabstd, method=\"euclidean\"))\n\n# Extrait de la matrice\nkable(matdis[c(\"06\",\"83\",\"92\",\"78\"),c(\"06\",\"83\",\"92\",\"78\")], digits=2, caption=\"Extrait de la matrice de dissimilarité\")\n\n\nExtrait de la matrice de dissimilarité\n\n\n\n06\n83\n92\n78\n\n\n\n\n06\n0.00\n1.91\n6.86\n5.03\n\n\n83\n1.91\n0.00\n7.90\n6.13\n\n\n92\n6.86\n7.90\n0.00\n2.08\n\n\n78\n5.03\n6.13\n2.08\n0.00\n\n\n\n\n\n\nCommentaire : Les Alpes Maritime (06) et le Var (83) ont des profils très proches (d = 1.91). Tout comme les Hauts-de-Seine (92) et les Yvelines (d= 2.08). Par contre les départements de chaque groupe sont très différents de ceux de l’autre groupe(d &gt; 5), la plus forte différence étant observée ici entre les Hauts de Seine et le Var (d = 7.90)"
  },
  {
    "objectID": "classifregio_exo.html#calcul-de-larbre-couvrant-minimal-minimum-spanning-tree",
    "href": "classifregio_exo.html#calcul-de-larbre-couvrant-minimal-minimum-spanning-tree",
    "title": "Classification/Régionalisation",
    "section": "Calcul de l’arbre couvrant minimal (minimum spanning tree)",
    "text": "Calcul de l’arbre couvrant minimal (minimum spanning tree)\nOn va ensuite utilise un algorithme pour déterminer l’arbre couvrant minimum, c’est-à-dire le graphe permettant de relier tous les départements les uns en l’autre en empruntant des chemins où les différences sont les plus faibles possibles.\n\nmap_nb&lt;-poly2nb(mapdon)\nlcosts &lt;- nbcosts(map_nb,tabstd,method=\"euclidean\",)\n#summary(lcosts)\nsim &lt;- nb2listw(map_nb,lcosts,style=\"B\")\n#summary(sim)\nmst &lt;- mstree(sim)\nclass(mst)\n\n[1] \"mst\"    \"matrix\"\n\nsize&lt;-mst[,3]\nsize&lt;-size/max(size)\nmst[,3]&lt;-0.5+4*size\n\n\ny&lt;-unlist(sim$neighbours)\nw&lt;-unlist(sim$weights)\nx&lt;-as.numeric(lapply(sim$neighbours, length))\nn&lt;-length(x)\nxx&lt;-NULL\nfor (i in 1:n) {\n  z&lt;-rep(i,x[i])\n  xx&lt;-c(xx,z)\n}\n\n\nq&lt;-data.frame(xx,y,w)\n\nctr&lt;-st_coordinates(st_centroid(mapdon))\n\nmf_map(mapdon, type=\"base\",col=\"lightyellow\",lwd=0.2)\nmf_map(mapreg, type=\"base\", col=NA, lwd=1, add=T)\n#segments(ctr[q[,1],1] ,ctr[q[,1],2], ctr[q[,2],1] ,ctr[q[,2],2],\n#         col=\"gray\", lwd=1+2*q$w, lty=2)\nsegments(ctr[mst[,1],1] ,ctr[mst[,1],2], ctr[mst[,2],1] ,ctr[mst[,2],2],\n         col=\"red\", lwd=mst[,3])\n\n#points(x=(ctr[q[,1],1] +ctr[q[,2],1])/2,  y=(ctr[q[,1],2] +ctr[q[,2],2])/2,   pch=22, # bg=\"white\", cex=3, col=\"black\")\n#text(  x=(ctr[q[,1],1] +ctr[q[,2],1])/2,  y=(ctr[q[,1],2] +ctr[q[,2],2])/2, #round(q$w,1), cex=0.7)\nmf_label(mapdon, var=\"code\", col=\"blue\",cex=0.5,halo = T,bg = \"white\")\nmf_layout(\"Arbre couvrant minimum du graphe de dissimilarité\", frame=T)\n\n\n\n\n\nCommentaire : Il est intéressant de voir que l’arbre couvrant minimum respecte plus ou moins bien les limites régionales. Certaines régions sont assez compactes tandis que d’autres sont plus écartelées. Qu’en est-il pour votre région ?"
  },
  {
    "objectID": "classifregio_exo.html#régionalisation-par-la-méthode-skater",
    "href": "classifregio_exo.html#régionalisation-par-la-méthode-skater",
    "title": "Classification/Régionalisation",
    "section": "Régionalisation par la méthode SKATER",
    "text": "Régionalisation par la méthode SKATER\nCette méthode consiste à découper l’arbre couvrant minimal en plusieurs sous-arbres de façon à minimiser les différences intra-régionales et maximiser les différences inter-régionales. On ne sait pas a priori le nombre de régions qui sont nécessaire et on doit tatonner pour trouver le nombre de région permettant d’assurer un bon compromis entre efficacité (peu de régions rendent le résultat plus simple à interpréter) et homogénéité (beaucoup de régions permet d’assurer une plus grande homogénéité).\n\ncontig_w&lt;-queen_weights(mapdon)\nregio&lt;-skater(6, contig_w, tab, scale_method = \"standardize\")\n\n\nmapdon$regio&lt;-as.factor(regio$Clusters)\ndon$regio&lt;-as.factor(regio$Clusters)\n\nmf_map(mapdon, type=\"typo\",var=\"regio\",leg_title = \"Regionalisation\", lwd=0.4, border=\"white\")\nmf_map(mapreg, type=\"base\", col=NA, lwd=1, add=T)\nsegments(ctr[mst[,1],1] ,ctr[mst[,1],2], ctr[mst[,2],1] ,ctr[mst[,2],2],\n         col=\"red\", lwd=mst[,3])\n#mstk&lt;-mst[c(2:5,7:10),]\n#segments(ctr[mstk[,1],1] ,ctr[mstk[,1],2], ctr[mstk[,2],1] ,ctr[mstk[,2],2],\n#         col=\"red\", lwd=1+2*mstk[,3])\n#mf_label(mapdon, var=\"nom\", col=\"black\",cex=0.5,halo = T,bg = \"white\")\nmf_layout(\"Régionalisation par la methode SKATER\", frame=T)\n\n\n\n\n\nCommentaire : Pour un nombre de classe donnée (ici on a choisi arbitrairement 6), la carte permet de voir à quel endroit on a découpé l’arbre couvrant minimum (ex. entre Hérault et Aude, entre Dordogne et Charentes, …). Puis ont peut examiner si une région administrative appartiennent à une seule région homogène (ex. Bourgogne-Franche Comté) ou à plusieurs (ex. Occitanie). On peut aussi trouver des cas ou une région administrative se sépare en deux régions homogènes qui lui sont propres comme dans le cas de l’Ile-de-France.\n\nPar rapport à la classification, on remarque que beaucoup de départements métropolitains sont désormais fusionnés dans des ensembles plus vastes. Ainsi le Haut-Rhin (Strasbourg) se retrouve fusionnée avec la grande classe 1 caractérisée par le vote Bardella alors que son profil serait plutôt différent. Mais il n’y avaut aucune possibilité de regroupement avec des voisins similaires.\nOn oeut évaluer la qualité de la régionalisaiton en comparant la ressemblance moyenne de deux unités situes dans une même région et deux unités situées dans des régions différentes. Les résultats s’affichent comme suit\n\nregio\n\n$Clusters\n [1] 1 1 1 1 1 4 1 1 2 1 2 2 4 3 1 3 3 1 2 1 3 2 2 1 1 1 1 3 4 2 2 3 4 3 1 3 1 1\n[39] 2 1 1 1 3 1 2 2 2 3 3 1 1 3 1 1 3 1 1 1 1 3 1 2 2 2 2 1 1 1 1 1 3 1 1 6 1 5\n[77] 6 3 1 2 2 4 4 3 3 2 1 1 1 5 6 5 5 5\n\n$`Total sum of squares`\n[1] 930\n\n$`Within-cluster sum of squares`\n [1] 30.52610 41.26855 57.77769 70.48488 44.70927 37.88487 33.26559 42.98798\n [9] 63.69268 74.08317\n\n$`Total within-cluster sum of squares`\n[1] 433.3192\n\n$`The ratio of between to total sum of squares`\n[1] 0.4659346\n\n\n\nCommentaire : les résultats nous indiquent que la régionalisation résume environ 47% de la variance totale du tableau de données ce qui est évidemment moins que ce que l’on aurait obtenu avec une classification sans contraintes de contiguïté en 6 classes."
  },
  {
    "objectID": "classifregio_exo.html#profil-de-vote-des-régions-issues-de-skater",
    "href": "classifregio_exo.html#profil-de-vote-des-régions-issues-de-skater",
    "title": "Classification/Régionalisation",
    "section": "Profil de vote des régions issues de SKATER",
    "text": "Profil de vote des régions issues de SKATER\nComme dans une classification, on peut analyser le profil de vote des régions obtenues\n\ntabstd&lt;-as.data.frame(tabstd)\ntabstd$regions&lt;-as.factor(regio$Clusters)\n\ncatdes(tabstd,num.var = 11)\n\n\nLink between the cluster variable and the quantitative variables\n================================================================\n                  Eta2      P-value\nAubry        0.6717624 6.606041e-20\nLassale      0.6423055 2.716194e-18\nHayer        0.5926358 7.380970e-16\nBardella     0.5562521 2.905184e-14\nMarechal     0.5377637 1.667482e-13\nGlucksman    0.5192552 8.921106e-13\nBellamy      0.3787345 4.518475e-08\nToussaint    0.3151325 2.542470e-06\nDeffontaines 0.2420981 1.524734e-04\nAutres       0.2034068 1.076642e-03\n\nDescription of each cluster by quantitative variables\n=====================================================\n$`1`\n             v.test Mean in category  Overall mean sd in category Overall sd\nBardella   4.856376        0.5455056  1.699660e-17      0.7283134  0.9946666\nAutres     2.571012        0.2887959  1.597422e-16      1.0750407  0.9946666\nAubry     -1.995322       -0.2241300 -3.912355e-18      0.4505621  0.9946666\nLassale   -2.071134       -0.2326457 -5.321357e-17      0.5184139  0.9946666\nToussaint -3.061320       -0.3438710  1.998623e-16      0.8940186  0.9946666\nGlucksman -5.634212       -0.6328782 -2.402223e-16      0.6528249  0.9946666\n               p.value\nBardella  1.195536e-06\nAutres    1.014019e-02\nAubry     4.600776e-02\nLassale   3.834629e-02\nToussaint 2.203638e-03\nGlucksman 1.758601e-08\n\n$`2`\n                v.test Mean in category  Overall mean sd in category Overall sd\nLassale       7.154761        1.4661725 -5.321357e-17      0.9969633  0.9946666\nDeffontaines  4.305462        0.8822865 -2.591382e-16      0.9603597  0.9946666\nGlucksman     3.618697        0.7415528 -2.402223e-16      0.6752959  0.9946666\nAutres       -2.060698       -0.4222837  1.597422e-16      0.6296755  0.9946666\nHayer        -2.827635       -0.5794463  1.139935e-16      0.6432678  0.9946666\nBellamy      -3.127869       -0.6409711  2.218785e-16      0.7926806  0.9946666\n                  p.value\nLassale      8.381854e-13\nDeffontaines 1.666377e-05\nGlucksman    2.960904e-04\nAutres       3.933184e-02\nHayer        4.689329e-03\nBellamy      1.760786e-03\n\n$`3`\n             v.test Mean in category  Overall mean sd in category Overall sd\nHayer      6.107688        1.2944446  1.139935e-16      0.8588588  0.9946666\nGlucksman  3.630919        0.7695258 -2.402223e-16      0.7456890  0.9946666\nToussaint  3.464445        0.7342438  1.998623e-16      0.8697713  0.9946666\nBardella  -2.659573       -0.5636617  1.699660e-17      0.5241394  0.9946666\nMarechal  -3.550099       -0.7523970 -4.907791e-16      0.5509129  0.9946666\n               p.value\nHayer     1.010846e-09\nGlucksman 2.824138e-04\nToussaint 5.313271e-04\nBardella  7.823979e-03\nMarechal  3.850864e-04\n\n$`4`\n            v.test Mean in category  Overall mean sd in category Overall sd\nMarechal  6.005817        2.3723232 -4.907791e-16      1.4186611  0.9946666\nHayer    -2.188212       -0.8643529  1.139935e-16      0.3171995  0.9946666\n              p.value\nMarechal 1.903712e-09\nHayer    2.865419e-02\n\n$`5`\n            v.test Mean in category  Overall mean sd in category Overall sd\nAubry     7.204488        3.1350842 -3.912355e-18      1.7868040  0.9946666\nAutres    1.991475        0.8666046  1.597422e-16      0.8657687  0.9946666\nLassale  -2.731904       -1.1888073 -5.321357e-17      0.1327097  0.9946666\nBardella -3.071960       -1.3367852  1.699660e-17      0.8308688  0.9946666\n              p.value\nAubry    5.826231e-13\nAutres   4.642866e-02\nLassale  6.296956e-03\nBardella 2.126582e-03\n\n$`6`\n                v.test Mean in category  Overall mean sd in category Overall sd\nBellamy       4.738760         2.691912  2.218785e-16      0.4723836  0.9946666\nToussaint     3.396640         1.929504  1.998623e-16      1.2960162  0.9946666\nHayer         3.188246         1.811123  1.139935e-16      0.3056362  0.9946666\nAubry         2.648522         1.504526 -3.912355e-18      0.3961354  0.9946666\nGlucksman     2.595190         1.474230 -2.402223e-16      1.2187502  0.9946666\nMarechal      2.133428         1.211920 -4.907791e-16      0.4469218  0.9946666\nAutres       -2.248256        -1.277150  1.597422e-16      1.5834342  0.9946666\nDeffontaines -2.341440        -1.330085 -2.591382e-16      0.1099219  0.9946666\nLassale      -2.358849        -1.339974 -5.321357e-17      0.1345288  0.9946666\nBardella     -4.676753        -2.656688  1.699660e-17      0.6622527  0.9946666\n                  p.value\nBellamy      2.150304e-06\nToussaint    6.821870e-04\nHayer        1.431388e-03\nAubry        8.084470e-03\nGlucksman    9.453863e-03\nMarechal     3.288966e-02\nAutres       2.455986e-02\nDeffontaines 1.920949e-02\nLassale      1.833171e-02\nBardella     2.914534e-06\n\n\n\nCommentaire : La méthode SKATER met en évidence … régions ayant les caractéristiques suivantes\n\nLa région 1 ( …)\nLa région 2 (…) .\nla région 3 (…)\n…"
  },
  {
    "objectID": "classifregio_exo.html#préparation-des-données-2",
    "href": "classifregio_exo.html#préparation-des-données-2",
    "title": "Classification/Régionalisation",
    "section": "Préparation des données",
    "text": "Préparation des données\n\n### Fonds de carte\nmap&lt;-st_read(\"data/elect2024/map_circ.shp\", quiet=T)  %&gt;%\n    filter(nom_reg %in% myreg) %&gt;%\n      select(code=ID,  geometry) %&gt;%\n      st_transform(2154)\n\n### Données\ndon&lt;-readRDS(\"data/elect2024/don_circ.RDS\") %&gt;%\n          filter(nom_reg %in% myreg) %&gt;%\n          select(code=ID, nom=ID, 10:17,19,20)\n\n\n### Jointure\nmapdon&lt;-left_join(map[,1],don)"
  },
  {
    "objectID": "classifregio_exo.html#cartographie-rapide-1",
    "href": "classifregio_exo.html#cartographie-rapide-1",
    "title": "Classification/Régionalisation",
    "section": "Cartographie rapide",
    "text": "Cartographie rapide\nUn coup d’oeil rapide sur la distribution des votes …\n\nplot(mapdon[3:12])"
  },
  {
    "objectID": "classifregio_exo.html#analyse-en-composantes-principales-2",
    "href": "classifregio_exo.html#analyse-en-composantes-principales-2",
    "title": "Classification/Régionalisation",
    "section": "Analyse en composantes principales",
    "text": "Analyse en composantes principales\nOn utilise la même procédure que pour les régions\n\ntab&lt;-mapdon[,3:12] %&gt;% st_drop_geometry()\nrow.names(tab)&lt;- mapdon$code\nacp&lt;-PCA(tab,  scale.unit = T)\n\n\n\n\n\n\nsummary(acp)\n\n\nCall:\nPCA(X = tab, scale.unit = T) \n\n\nEigenvalues\n                       Dim.1   Dim.2   Dim.3   Dim.4   Dim.5   Dim.6   Dim.7\nVariance               4.706   1.975   1.736   0.677   0.419   0.227   0.136\n% of var.             47.063  19.754  17.359   6.772   4.188   2.270   1.356\nCumulative % of var.  47.063  66.817  84.175  90.947  95.135  97.405  98.761\n                       Dim.8   Dim.9  Dim.10\nVariance               0.083   0.041   0.000\n% of var.              0.828   0.410   0.000\nCumulative % of var.  99.590 100.000 100.000\n\nIndividuals (the 10 first)\n                 Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3\n09001        |  3.846 |  0.739  0.237  0.037 |  1.111  1.275  0.083 | -3.428\n09002        |  2.653 | -0.704  0.215  0.070 |  0.763  0.602  0.083 | -2.044\n11001        |  2.528 | -2.092  1.898  0.685 |  0.082  0.007  0.001 | -1.114\n11002        |  2.498 | -2.320  2.334  0.863 | -0.384  0.152  0.024 | -0.118\n11003        |  2.280 | -0.673  0.196  0.087 |  0.158  0.026  0.005 | -1.328\n12001        |  4.743 |  1.128  0.552  0.057 |  1.815  3.403  0.146 |  4.138\n12002        |  2.673 |  0.584  0.148  0.048 |  2.322  5.571  0.755 |  0.683\n12003        |  3.187 |  0.523  0.119  0.027 |  2.549  6.710  0.640 |  1.350\n34006        |  4.357 | -3.758  6.123  0.744 | -1.684  2.930  0.149 |  1.136\n31002        |  3.555 |  3.347  4.859  0.887 | -0.774  0.618  0.047 |  0.731\n                ctr   cos2  \n09001        13.815  0.794 |\n09002         4.912  0.593 |\n11001         1.460  0.194 |\n11002         0.016  0.002 |\n11003         2.072  0.339 |\n12001        20.127  0.761 |\n12002         0.548  0.065 |\n12003         2.143  0.180 |\n34006         1.518  0.068 |\n31002         0.628  0.042 |\n\nVariables\n                Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3    ctr\nAubry        |  0.612  7.951  0.374 | -0.676 23.112  0.457 | -0.213  2.613\nBardella     | -0.977 20.274  0.954 | -0.054  0.147  0.003 | -0.025  0.035\nBellamy      |  0.446  4.222  0.199 |  0.214  2.314  0.046 |  0.798 36.723\nDeffontaines | -0.417  3.687  0.174 |  0.429  9.312  0.184 | -0.489 13.748\nGlucksman    |  0.935 18.593  0.875 |  0.185  1.741  0.034 | -0.156  1.403\nHayer        |  0.650  8.966  0.422 |  0.272  3.743  0.074 |  0.588 19.944\nLassale      | -0.091  0.178  0.008 |  0.924 43.218  0.854 |  0.013  0.010\nMarechal     | -0.699 10.385  0.489 | -0.475 11.405  0.225 |  0.409  9.637\nToussaint    |  0.934 18.531  0.872 | -0.268  3.623  0.072 | -0.110  0.702\nAutres       |  0.583  7.213  0.339 |  0.165  1.385  0.027 | -0.513 15.186\n               cos2  \nAubry         0.045 |\nBardella      0.001 |\nBellamy       0.637 |\nDeffontaines  0.239 |\nGlucksman     0.024 |\nHayer         0.346 |\nLassale       0.000 |\nMarechal      0.167 |\nToussaint     0.012 |\nAutres        0.264 |\n\n\n\nCommentaires : Les axes sont ils différents de ceux vus pour la France entière par départements ?\n\nL’axe 1 résume … % de l’information et oppose les régons … aux régions …\nL’axe 2 résume … % de l’information et oppose les régons … aux régions …\n\n\nQeu montrent les cartes\n\nmapdon$axe1&lt;-acp$ind$coord[,1]\nmapdon$axe2&lt;-acp$ind$coord[,2]\n\npar(mfrow=c(1,2))\nmypal&lt;- brewer.pal(6, \"RdYlBu\")\nmybreaks&lt;-c(-10,-2,-1,0,1,2,10)\n\nmf_map(mapdon, type=\"choro\", var=\"axe1\", pal=mypal, breaks=mybreaks, lwd=0.1, border=\"white\")\nmf_map(mapreg, type=\"base\", col=NA, lwd=1, add=T)\nmf_layout(\"Axe1 (...%): Sigification ?\", frame=T)\n\nmf_map(mapdon, type=\"choro\", var=\"axe2\",pal=mypal, breaks=mybreaks, lwd=0.1, border=\"white\")\nmf_map(mapreg, type=\"base\", col=NA, lwd=1, add=T)\nmf_layout(\"Axe2 (..%) : Signification ?\", frame=T)\n\n\n\n\n\nClassification ascendante hiérarchique\nOn applique ensuite une méthode de classification où vous devrez choisir le bon nombre de classes\n\ncah&lt;-HCPC(acp, nb.clust = 3, graph=F)\nplot(cah,choice = \"tree\")\n\n\n\ncatdes(cah$data.clust,num.var = 11)\n\n\nLink between the cluster variable and the quantitative variables\n================================================================\n                  Eta2      P-value\nBardella     0.7635263 3.953724e-15\nToussaint    0.7559937 8.132471e-15\nGlucksman    0.7279219 9.953003e-14\nLassale      0.7009854 8.728184e-13\nMarechal     0.5105046 7.315055e-08\nAubry        0.5000834 1.187528e-07\nHayer        0.4077475 5.856781e-06\nBellamy      0.2244642 2.889636e-03\nAutres       0.2118850 4.183704e-03\nDeffontaines 0.2068348 4.845779e-03\n\nDescription of each cluster by quantitative variables\n=====================================================\n$`1`\n             v.test Mean in category Overall mean sd in category Overall sd\nBardella   5.165357        40.208105    33.202060      4.1690321  8.1381156\nMarechal   4.947902         6.109378     5.500267      0.5431260  0.7386298\nAutres    -2.688677         6.770671     7.007183      0.5583550  0.5277966\nLassale   -2.819601         2.839666     3.964720      1.2829173  2.3940711\nBellamy   -3.212684         4.861061     5.489652      0.5917467  1.1739557\nToussaint -3.763994         3.989570     5.190898      0.9349410  1.9149785\nHayer     -4.109525        10.927318    12.137259      0.8526189  1.7665413\nGlucksman -5.349656        12.881743    15.607179      1.7289872  3.0567601\n               p.value\nBardella  2.399804e-07\nMarechal  7.501762e-07\nAutres    7.173574e-03\nLassale   4.808336e-03\nBellamy   1.315008e-03\nToussaint 1.672211e-04\nHayer     3.964738e-05\nGlucksman 8.812178e-08\n\n$`2`\n            v.test Mean in category Overall mean sd in category Overall sd\nLassale   5.669423         6.535707     3.964720      1.5700410  2.3940711\nAubry    -2.927163         7.094251     9.218785      1.4671845  3.8317130\nMarechal -3.377848         5.027670     5.500267      0.4389363  0.7386298\n              p.value\nLassale  1.432793e-08\nAubry    3.420701e-03\nMarechal 7.305532e-04\n\n$`3`\n                v.test Mean in category Overall mean sd in category Overall sd\nToussaint     5.877463         8.399128     5.190898      1.4098687  1.9149785\nAubry         4.754040        14.411178     9.218785      4.6440868  3.8317130\nGlucksman     4.605575        19.620066    15.607179      1.5264840  3.0567601\nHayer         3.274420        13.786067    12.137259      1.2626467  1.7665413\nAutres        2.720433         7.416459     7.007183      0.2434638  0.5277966\nBellamy       2.013699         6.163494     5.489652      0.6615278  1.1739557\nMarechal     -2.035031         5.071808     5.500267      0.5850698  0.7386298\nDeffontaines -3.150424         2.066903     2.681996      0.1197292  0.6849521\nLassale      -3.319331         1.699558     3.964720      0.7101750  2.3940711\nBardella     -5.102650        21.365341    33.202060      4.9060553  8.1381156\n                  p.value\nToussaint    4.166028e-09\nAubry        1.993912e-06\nGlucksman    4.113275e-06\nHayer        1.058791e-03\nAutres       6.519649e-03\nBellamy      4.404115e-02\nMarechal     4.184780e-02\nDeffontaines 1.630339e-03\nLassale      9.023326e-04\nBardella     3.349294e-07\n\n\n\nCommentaire : La classification met en évidence combien de types de région?\n\nLa classe 1 ( …)\nLa classe 2 (…) .\nla classe 3 (…)\n…\n\n\nOn peut ensuite cartogaphier les classes correspondantes pour mieux voir la distribution spatiale. Cela suppose que l’on ait donné aux classes des noms suite à l’interprétation\n\nmapdon$cah&lt;-as.factor(cah$data.clust$clust)\nlevels(mapdon$cah)&lt;-c(\"Classe 1 : ????\", \n                      \"Classe 2 = ????\",\n                      \"Classe 3 = ???? \")\n\n\npar(mfrow=c(1,1))\n\nmf_map(mapdon, type=\"typo\", var=\"cah\", lwd=0.1, border=\"white\", leg_title = \"Classes\")\nmf_map(mapreg, type=\"base\", col=NA, lwd=1, add=T)\nmf_layout(\"Typologie en trois classes ...\", frame=T,credits = \"\")\n\n\n\n\n\nCommentaire : …"
  },
  {
    "objectID": "classifregio_exo.html#préparation-des-données-3",
    "href": "classifregio_exo.html#préparation-des-données-3",
    "title": "Classification/Régionalisation",
    "section": "Préparation des données",
    "text": "Préparation des données\nla préparation des données est la même que précédemment\n\n### Fonds de carte région (pour habillage)\nmapdep&lt;-st_read(\"data/elect2024/map_dept.shp\", quiet=T) %&gt;%\n      st_transform(2154)\n\n### Fonds de carte\nmap&lt;-st_read(\"data/elect2024/map_circ.shp\", quiet=T)  %&gt;%\n    filter(nom_reg %in% myreg) %&gt;%\n      select(code=ID,  geometry) %&gt;%\n      st_transform(2154)\n\n### Données\ndon&lt;-readRDS(\"data/elect2024/don_circ.RDS\") %&gt;%\n          filter(nom_reg %in% myreg) %&gt;%\n          select(code=ID, nom=ID, 10:17,19,20)\n\n\n### Jointure\nmapdon&lt;-left_join(map[,1],don)"
  },
  {
    "objectID": "classifregio_exo.html#calcul-du-graphe-de-contiguïté-1",
    "href": "classifregio_exo.html#calcul-du-graphe-de-contiguïté-1",
    "title": "Classification/Régionalisation",
    "section": "Calcul du graphe de contiguïté",
    "text": "Calcul du graphe de contiguïté\nOn utilise la procédure poly2nb() du package spdep :\n\n# Table de voisinage\nmap_nb&lt;-spdep::poly2nb(mapdon,row.names = mapdon$code)\n\n# Table de poids\nmap_nb_w&lt;-nb2listw(map_nb)\nsummary(map_nb_w)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 49 \nNumber of nonzero links: 236 \nPercentage nonzero weights: 9.829238 \nAverage number of links: 4.816327 \nLink number distribution:\n\n 2  3  4  5  6  7  8 \n 1 12  9  9 12  3  3 \n1 least connected region:\n65002 with 2 links\n3 most connected regions:\n31006 34005 81003 with 8 links\n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 49 2401 49 21.72266 200.6484\n\n# Carte de voisinage\ncoo&lt;-st_coordinates(st_centroid(mapdon))\nmf_map(mapdon, type=\"base\",col=\"lightyellow\")\nmf_layout(\"Carte des liens de voisinage\", frame=T)\nplot.nb(map_nb,coords = coo,add = T,col = \"red\",points = F)\nmf_label(mapdon, var=\"code\", col=\"blue\",cex=0.6,halo = T, bg=\"white\",r = 0.1)\n\n\n\n\n\nCommentaire : On vérifie que le graphe est connexe et que chaque département a au moins un voisin. Certains départements situes aux extrémités du pays ont un seul voisin (ex. O6 Alpes Maritime ou 09 Finistère) tandis que d’autres ont jusqu’à 10 voisins (77 : Seine-et-Marne). Leurs possibilités de regroupement en région seront donc plus ou moins contraintes."
  },
  {
    "objectID": "classifregio_exo.html#calcul-de-la-matrice-de-dissimilarité-1",
    "href": "classifregio_exo.html#calcul-de-la-matrice-de-dissimilarité-1",
    "title": "Classification/Régionalisation",
    "section": "Calcul de la matrice de dissimilarité",
    "text": "Calcul de la matrice de dissimilarité\nNous devons calculer la matrice de dissimilarité directement à partir du tableau des variables standardisées.\n\n# choix des variables\ntab&lt;-mapdon[,3:12] %&gt;% st_drop_geometry()\nrow.names(tab)&lt;- mapdon$code\n\n# standardisation\ntabstd &lt;-scale(tab)\n\n# calcul des distances\nmatdis &lt;- as.matrix(dist(tabstd, method=\"euclidean\"))"
  },
  {
    "objectID": "classifregio_exo.html#calcul-de-larbre-couvrant-minimal-minimum-spanning-tree-1",
    "href": "classifregio_exo.html#calcul-de-larbre-couvrant-minimal-minimum-spanning-tree-1",
    "title": "Classification/Régionalisation",
    "section": "Calcul de l’arbre couvrant minimal (minimum spanning tree)",
    "text": "Calcul de l’arbre couvrant minimal (minimum spanning tree)\nOn va ensuite utilise un algorithme pour déterminer l’arbre couvrant minimum, c’est-à-dire le graphe permettant de relier tous les départements les uns en l’autre en empruntant des chemins où les différences sont les plus faibles possibles.\n\nmap_nb&lt;-poly2nb(mapdon)\nlcosts &lt;- nbcosts(map_nb,tabstd,method=\"euclidean\",)\n#summary(lcosts)\nsim &lt;- nb2listw(map_nb,lcosts,style=\"B\")\n#summary(sim)\nmst &lt;- mstree(sim)\nsize&lt;-mst[,3]\nsize&lt;-size/max(size)\nmst[,3]&lt;-0.5+4*size\n\n\ny&lt;-unlist(sim$neighbours)\nw&lt;-unlist(sim$weights)\nx&lt;-as.numeric(lapply(sim$neighbours, length))\nn&lt;-length(x)\nxx&lt;-NULL\nfor (i in 1:n) {\n  z&lt;-rep(i,x[i])\n  xx&lt;-c(xx,z)\n}\n\n\nq&lt;-data.frame(xx,y,w)\n\nctr&lt;-st_coordinates(st_centroid(mapdon))\n\nmf_map(mapdon, type=\"base\",col=\"lightyellow\",lwd=0.2)\nmf_map(mapdep, type=\"base\", col=NA, lwd=1, add=T)\n#segments(ctr[q[,1],1] ,ctr[q[,1],2], ctr[q[,2],1] ,ctr[q[,2],2],\n#         col=\"gray\", lwd=1+2*q$w, lty=2)\nsegments(ctr[mst[,1],1] ,ctr[mst[,1],2], ctr[mst[,2],1] ,ctr[mst[,2],2],\n         col=\"red\", lwd=mst[,3])\n\n#points(x=(ctr[q[,1],1] +ctr[q[,2],1])/2,  y=(ctr[q[,1],2] +ctr[q[,2],2])/2,   pch=22, # bg=\"white\", cex=3, col=\"black\")\n#text(  x=(ctr[q[,1],1] +ctr[q[,2],1])/2,  y=(ctr[q[,1],2] +ctr[q[,2],2])/2, #round(q$w,1), cex=0.7)\nmf_label(mapdon, var=\"code\", col=\"blue\",cex=0.5,halo = T,bg = \"white\")\nmf_layout(\"Arbre couvrant minimum du graphe de dissimilarité\", frame=T)\n\n\n\n\n\nCommentaire : Que remarquez-vous ?"
  },
  {
    "objectID": "classifregio_exo.html#régionalisation-par-la-méthode-skater-1",
    "href": "classifregio_exo.html#régionalisation-par-la-méthode-skater-1",
    "title": "Classification/Régionalisation",
    "section": "Régionalisation par la méthode SKATER",
    "text": "Régionalisation par la méthode SKATER\nA vous de choisir le bon nombre de régions…\n\ncontig_w&lt;-queen_weights(mapdon)\nregio&lt;-skater(6, contig_w, tab, scale_method = \"standardize\")\n\n\nmapdon$regio&lt;-as.factor(regio$Clusters)\ndon$regio&lt;-as.factor(regio$Clusters)\n\nmf_map(mapdon, type=\"typo\",var=\"regio\",leg_title = \"Regionalisation\", lwd=0.4, border=\"white\")\nmf_map(mapdep, type=\"base\", col=NA, lwd=1, add=T)\nsegments(ctr[mst[,1],1] ,ctr[mst[,1],2], ctr[mst[,2],1] ,ctr[mst[,2],2],\n         col=\"red\", lwd=mst[,3])\n#mstk&lt;-mst[c(2:5,7:10),]\n#segments(ctr[mstk[,1],1] ,ctr[mstk[,1],2], ctr[mstk[,2],1] ,ctr[mstk[,2],2],\n#         col=\"red\", lwd=1+2*mstk[,3])\n#mf_label(mapdon, var=\"nom\", col=\"black\",cex=0.5,halo = T,bg = \"white\")\nmf_layout(\"Régionalisation par la methode SKATER\", frame=T)\n\n\n\n\n\nCommentaire : Quelles différences avec la classification ?\n\n\nregio\n\n$Clusters\n [1] 2 2 1 1 2 3 3 3 1 4 4 1 1 4 1 1 6 6 2 4 2 2 4 2 2 1 1 1 3 3 3 2 2 1 1 1 1 4\n[39] 3 2 3 2 2 4 1 5 5 1 1\n\n$`Total sum of squares`\n[1] 480\n\n$`Within-cluster sum of squares`\n [1] 22.05654 12.00617 17.29510 19.21094 12.59450 24.02348 10.53002 22.60925\n [9] 11.66837 34.23028\n\n$`Total within-cluster sum of squares`\n[1] 293.7753\n\n$`The ratio of between to total sum of squares`\n[1] 0.612032\n\n\n\nCommentaire : Quelle est la qualité de la régionalisation ?"
  },
  {
    "objectID": "classifregio_exo.html#profil-de-vote-des-régions-issues-de-skater-1",
    "href": "classifregio_exo.html#profil-de-vote-des-régions-issues-de-skater-1",
    "title": "Classification/Régionalisation",
    "section": "Profil de vote des régions issues de SKATER",
    "text": "Profil de vote des régions issues de SKATER\n\ntabstd&lt;-as.data.frame(tabstd)\ntabstd$regions&lt;-as.factor(regio$Clusters)\n\ncatdes(tabstd,num.var = 11)\n\n\nLink between the cluster variable and the quantitative variables\n================================================================\n                  Eta2      P-value\nLassale      0.7806245 3.927220e-13\nToussaint    0.7569089 3.416904e-12\nBardella     0.7498714 6.228452e-12\nGlucksman    0.7376145 1.702063e-11\nBellamy      0.6396853 1.275197e-08\nDeffontaines 0.5997722 1.115625e-07\nAubry        0.5404888 1.882237e-06\nMarechal     0.5289739 3.110908e-06\nHayer        0.4995109 1.059797e-05\nAutres       0.2868691 1.025983e-02\n\nDescription of each cluster by quantitative variables\n=====================================================\n$`1`\n             v.test Mean in category  Overall mean sd in category Overall sd\nMarechal   4.850801        0.9507492 -1.793138e-16      0.7205390  0.9897433\nBardella   4.218524        0.8268239 -2.492603e-16      0.6010402  0.9897433\nBellamy   -2.493796       -0.4887801  2.987973e-16      0.4755723  0.9897433\nHayer     -2.610644       -0.5116820 -3.089932e-16      0.5400064  0.9897433\nAutres    -2.852440       -0.5590736 -5.048222e-16      1.0658564  0.9897433\nToussaint -2.908375       -0.5700369  8.135499e-17      0.5714399  0.9897433\nLassale   -3.485603       -0.6831725  4.814743e-17      0.3677431  0.9897433\nGlucksman -4.550217       -0.8918352  7.448690e-17      0.5773489  0.9897433\n               p.value\nMarechal  1.229636e-06\nBardella  2.459068e-05\nBellamy   1.263850e-02\nHayer     9.037196e-03\nAutres    4.338504e-03\nToussaint 3.633119e-03\nLassale   4.910296e-04\nGlucksman 5.359054e-06\n\n$`2`\n           v.test Mean in category Overall mean sd in category Overall sd\nLassale  3.469376        0.8247701 4.814743e-17      0.6134112  0.9897433\nAubry   -2.071237       -0.4923924 2.297270e-16      0.4231931  0.9897433\nBellamy -2.218756       -0.5274619 2.987973e-16      0.8023645  0.9897433\n             p.value\nLassale 0.0005216689\nAubry   0.0383366589\nBellamy 0.0265033208\n\n$`3`\n           v.test Mean in category  Overall mean sd in category Overall sd\nBellamy  4.469216        1.4453741  2.987973e-16      0.6311409  0.9897433\nLassale  3.875329        1.2533072  4.814743e-17      0.5744634  0.9897433\nHayer    2.598313        0.8403116 -3.089932e-16      0.9161303  0.9897433\nAubry   -2.021208       -0.6536720  2.297270e-16      0.1781132  0.9897433\n             p.value\nBellamy 7.850671e-06\nLassale 1.064805e-04\nHayer   9.368302e-03\nAubry   4.325826e-02\n\n$`4`\n                v.test Mean in category  Overall mean sd in category Overall sd\nToussaint     5.270502        1.8442915  8.135499e-17     0.67928508  0.9897433\nGlucksman     4.425772        1.5486975  7.448690e-17     0.15470495  0.9897433\nHayer         3.348557        1.1717509 -3.089932e-16     0.55050264  0.9897433\nAubry         3.196516        1.1185476  2.297270e-16     1.01281298  0.9897433\nAutres        2.642443        0.9246623 -5.048222e-16     0.44958990  0.9897433\nBellamy       2.284201        0.7993039  2.987973e-16     0.37556096  0.9897433\nDeffontaines -2.262611       -0.7917489  1.382822e-16     0.09093272  0.9897433\nLassale      -2.403146       -0.8409261  4.814743e-17     0.29332084  0.9897433\nMarechal     -2.403756       -0.8411393 -1.793138e-16     0.36399037  0.9897433\nBardella     -4.519790       -1.5815969 -2.492603e-16     0.50541886  0.9897433\n                  p.value\nToussaint    1.360512e-07\nGlucksman    9.609809e-06\nHayer        8.123351e-04\nAubry        1.390981e-03\nAutres       8.231043e-03\nBellamy      2.235972e-02\nDeffontaines 2.365968e-02\nLassale      1.625468e-02\nMarechal     1.622761e-02\nBardella     6.190109e-06\n\n$`5`\n             v.test Mean in category  Overall mean sd in category Overall sd\nAubry      3.320684         2.299659  2.297270e-16      1.5647360  0.9897433\nToussaint  2.308076         1.598402  8.135499e-17      0.4633838  0.9897433\nBardella  -2.072268        -1.435099 -2.492603e-16      0.5743849  0.9897433\n               p.value\nAubry     0.0008979727\nToussaint 0.0209948920\nBardella  0.0382404927\n\n$`6`\n               v.test Mean in category Overall mean sd in category Overall sd\nDeffontaines 4.719854          3.26862 1.382822e-16      0.2199139  0.9897433\n                  p.value\nDeffontaines 2.360139e-06\n\n\n\nCommentaire : La méthode SKATER met en évidence … régions ayant les caractéristiques suivantes\n\nLa région 1 ( …)\nLa région 2 (…) .\nla région 3 (…)\n…"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Minimum théorique",
    "section": "",
    "text": "L’objet de ce petit site web est de développer les aspects théoriques de la régionalisation d’un monde abstrait."
  },
  {
    "objectID": "index.html#géométries",
    "href": "index.html#géométries",
    "title": "Minimum théorique",
    "section": "Géométries",
    "text": "Géométries\nCe chapitre s’intéresse aux différentes formes de géométrie du monde que l’on veut régionaliser. Cela revient à en définir la topologie et le type de distance que l’on peut mesurer entre des individus localisés en différentes positions de ce monde. Le nombre de position est supposé fini et forme l’oekoumène. A partir d’une distribution d’invidus localisé dans ce monde, on peut proposer des régionalisations fondées sur des potentiels d’accessibilité à condition de définir à la fois une distance et une fonction de décroissance des interactions avec cette distance"
  }
]